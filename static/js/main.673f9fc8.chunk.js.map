{"version":3,"sources":["images/logo.png","images/darkLogo.png","images/graphic.png","util/FileIdAndTypeUtils.js","util/FetchWithTimeout.js","reducers/BackendModeSignedInStatus.js","components/LandingPage.js","lib/TagFiltersGrammar.js","util/ConvertStrValueOrDefault.js","reducers/CurrentOpenFileState.js","reducers/SetTagsInView.js","store.js","editor_extension/plugins/SelectNode.js","editor_extension/plugins/TagFiltering.js","editor_extension/plugins/CancelLineBreaks.js","editor_extension/BlockTagging.js","components/TagMenu.js","backend/LocalFileStorageSystemClient.js","backend/HostedFileStorageSystemClient.js","backend/FileStorageSystemClient.js","components/Editor.js","components/SourceEditorWithTagFiltersInput.js","components/Navigator.js","components/CardView/Card.js","components/ViewComponents/DragDropColumn.js","components/ViewComponents/TagEditor.js","components/CardView/CardDeck.js","components/TextView/TextView.js","components/ViewEditor.js","components/EditorManager.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","FILE_TYPE","SOURCE","TEXT_VIEW","CARD_VIEW","EMPTY","NO_OPEN_FILE_ID","sourceId","viewId","viewType","validateFileIdObj","fileId","hasOwnProperty","validateHasFileIdObj","state","checkNoOpenFileId","checkSourceFileId","checkViewFileId","getFileIdKeyStr","fetchWithTimeout","uri","options","a","time","controller","AbortController","setTimeout","abort","fetch","signal","then","response","ok","console","log","SERVER_BASE_URL","BACKEND_MODE_SIGNED_IN_STATUS","USER_SIGNED_IN","USER_SIGNED_OUT","LOCAL_STORAGE","getUserSignedInStatus","token","Cookies","get","headers","Headers","setBackendModeSignedInStatusAction","status","type","CLIENT_ID","LandingPage","handleLoginSuccess","profileObj","name","email","tokenObj","id_token","expiry","expiresAt","axios","post","method","body","JSON","stringify","withCredentials","set","expires","Date","props","dispatchSetBackendModeSignedInStatusAction","render","style","display","flexFlow","height","overflow","className","flexGrow","AppBar","position","class","Toolbar","src","require","width","marginRight","backgroundColor","flex","Grid","container","spacing","alignItems","item","xs","marginLeft","Typography","variant","fontFamily","color","text","speed","clientId","buttonText","onSuccess","onFailure","cookiePolicy","responseType","float","Button","onClick","React","Component","connect","backendModeSignedInStatus","dispatch","mode","id","x","Grammar","Lexer","undefined","ParserRules","symbols","postprocess","literal","pos","d","join","concat","trim","ParserStart","parse","inputText","outputParsedExpr","parser","nearley","Parser","fromCompiled","feed","results","length","ex","convertStrValueOrDefault","valueStr","defaultValue","failureMessage","convertFromString","value","e","convertStrValueOrDefaultIfFalsy","storedInitialFileId","localStorage","getItem","initialFileId","setSelectNodeAction","selectNode","setTagsInViewAction","tagsInView","configureStore","reducer","combineReducers","currentOpenFileId","action","saveDirtyFlag","setItem","removeItem","SelectNodePluginKey","PluginKey","Plugin","key","init","apply","tr","_value","oldState","head","selection","newState","doc","nodesBetween","node","attrs","eq","store","decorations","selectDecorations","getState","push","Decoration","nodeSize","DecorationSet","create","TagFilteringPluginKey","evaluateTagFilters","tagFilters","parentTags","match","taggable","nodeTags","matchTagFilters","tags","Array","isArray","match1","isTextblock","cumulativeChildSize","i","childCount","child","childMatch","v","val","getMeta","filterDecorations","CancelLineBreaksPluginKey","filterTransaction","steps","every","step","toJSON","stepType","slice","content","some","isLeaf","checkInsertLineBreakReplaceStep","from","to","fromNode","nodeAt","toNode","checkRemoveLineBreakReplaceStep","CancelLineBreaksPlugin","SelectNodePlugin","TagFilteringPlugin","Extension","TAG_VALUE_REGEX","INVALID_TAG_VALUE_REGEX","TagMenu","selectNodeAttrs","modifying","handleAddTag","tag","document","getElementById","test","alert","newSelectNodeAttrs","uuidv4","BlockTaggingEditorExtension","editor","view","setNodeMarkup","setState","dispatchSetSaveDirtyFlagAction","handleDeleteTag","handleModifyTagValue","oldTagValue","newTagValue","handleCancelModifyTagValue","input","setSelectionRange","handleStartModifyingTagValue","defer","focus","componentDidUpdate","prevProps","title","placeholder","disabled","onKeyPress","event","target","preventDefault","onKeyDown","Object","keys","map","onBlur","blur","hidden","doSetLocalStorageSourceViews","sourceViews","doGetLocalStorageSourceViews","doSetLocalStorageSourceIdNames","sourceIdNames","calculateLocalStorageNextNewId","existingIdsDict","candidate","toString","calculateLocalStorageNextNewFileIds","filesList","source","nextNewViewIdsForSourceIds","fromEntries","entries","views","doGetFilesList","sourceName","doSaveViewSpec","tagsList","createNew","viewSpecLocalStorageKey","doGetView","doGetSourceTaggedBlocks","sourceContentDocStr","sourceContentDoc","sourceTaggedBlocks","nodes","shift","tagId","doSaveSourceContent","saveValue","sourceContentLocalStorageKey","doGetSourceContent","doSetSourceSavedTagFilters","sourceSavedTagFilters","sourceSavedTagFiltersLocalStorageKey","doGetSourceSavedTagFilters","doDeleteView","doDeleteSource","localStorageSourceViewIds","doRenameView","doRenameSource","EMPTY_SOURCE_CONTENT","json","viewID","viewResponse","tagResponse","view_json","tags_json","filters","k","getFileStorageSystemClient","LocalFileStorageSystemClient","HostedFileStorageSystemClient","clientInterface","Error","reduce","partial","fileStorageSystemClient","handleSaveCurrentFileEditorContent","FileStorageSystemClient","success","Editor","noOpenFileIdCheck","handleSetCurrentOpenFileId","minWidth","children","extensions","fileIdKeyStr","fileContent","jsonStrValue","setSelection","TextSelection","onChange","DEFAULT_STATE","modifyingTagFilters","currentTagFiltersStr","currentParsedTagFiltersStr","SourceEditorWithTagFiltersInput","handleCancelModifyingTagFilters","handleStartModifyingTagFilters","handleUnpersistCurrentTagFilters","newSourceSavedTagFilters","handlePersistNewSavedTagFilters","handleApplyTagFilters","tagFiltersStr","parseTagFilters","parsedTagFiltersStr","oldParsedTagFiltersStr","setMeta","Selection","atStart","scrollIntoView","dom","changeFile","focusAtStart","componentDidMount","initialTagFiltersStr","sourceFileIdCheck","currentTagFiltersSaved","list","window","confirm","batch","setCurrentOpenFileIdAction","convertFilesListStateToFileIdNamesList","filesListState","countNumFiles","count","RENAME_INPUT_TYPES","getRenameInputIdFunctions","NO_RENAMING_STATE","inputType","searching","renaming","nextNewFileIds","selectedFileId","selectedViewId","selectedFileOpen","editMenuAnchorElement","renameSelected","newViewAnchorElement","FileListItem","Paper","selected","component","elevation","IconButton","InputBase","fileName","Divider","orientation","handleEditMenuClick","fontSize","border","childViewsExist","open","Navigator","resetState","getSourceName","getViewName","getFileName","getRenameInputValueFunctions","handleSwitchBackendModeSignedInStatus","handleCancelRenaming","handleClearSearchingInput","handleChangeSearchingInput","handleDoFileNamesSearch","filter","includes","handleCreateNewFile","fileType","sourceFileType","localStorageNextNewFileId","newFilePromise","newFile","updatedSourceId","newFilesList","parseInt","handleDeleteFile","deleteFilePromise","newSourceViews","newNextNewViewIdsForSourceIds","handleRenameFile","newName","renameFilePromise","prevState","filesListValue","renameInput","remainingProps","inputId","fileListItem","classes","makeStyles","theme","root","padding","viewRoot","iconButton","divider","margin","useStyles","handleFileListClick","handleViewListClick","currentTarget","handleEditMenuClose","handleDeleteMenuClick","handleRenameMenuClick","renamePopoverElement","handleRenamePopoverClose","handleViewMenuOpen","handleViewMenuClose","numFiles","filteredFilesList","numFilteredFiles","endIcon","disableElevation","Input","startAdornment","InputAdornment","debounce","List","aria-labelledby","subheader","ListSubheader","ListItem","button","disableGutters","Collapse","in","timeout","unmountOnExit","disablePadding","Menu","anchorEl","keepMounted","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","MenuItem","ListItemIcon","ListItemText","primary","Popover","endAdornment","disableUnderline","fullWidth","remove","Card","front","back","isFlipped","flipDirection","createBootstrapCard","handleClick","bind","this","readOnly","Tag","Container","styled","div","isDragging","TagId","h5","Content","draggableId","index","provided","snapshot","ref","innerRef","draggableProps","dragHandleProps","tagInfo","preview","InnerTagList","nextProps","nextState","nextContext","tagData","DragDropColumn","isDraggingOver","Title","h3","DroppableRegion","TagList","droppableId","column","droppableProps","tagListRef","createRef","current","scrollHeight","scrollTop","TagEditor","onDragEnd","result","destination","columns","newTagIds","tagIds","splice","newColumn","start","finish","startTagIds","newStart","finishTagIds","newFinish","setTagsInView","tags_in_view","Row","columnOrder","columnId","tagDataInColumn","Col","md","lg","Set","availableTags","allTagsData","t","has","forEach","getPreview","contentNode","recurseResponse","substring","tags_available","assign","CardDeck","keydownHandler","navigator","platform","metaKey","ctrlKey","keyCode","catch","constructDoc","constructCard","cardContent","addEventListener","componentWillUnmount","removeEventListener","cards","xl","data","TextView","constructTextView","ViewEditor","EditorManager","App","mounted","Fragment","top","right","role","aria-label","location","hostname","StrictMode","rel","href","serviceWorker","ready","registration","unregister","error","message"],"mappings":"yLAAAA,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,sC,oBCA3CD,EAAOC,QAAU,IAA0B,qC,iPCA9BC,G,OAAY,CACvBC,OAAQ,SACRC,UAAW,YACXC,UAAW,YACXC,MAAO,iBAGIC,EAAkB,CAAEC,SAAU,EAAGC,OAAQ,EAAGC,SAAUR,EAAUI,OAEhEK,EAAoB,SAAAC,GAAM,OAAIA,EAAOC,eAAe,aAAeD,EAAOC,eAAe,WACzFC,EAAuB,SAAAC,GAAK,OAAIA,EAAMF,eAAe,WAAaF,EAAkBI,EAAMH,SAE1FI,EAAoB,SAAAJ,GAAM,OAAID,EAAkBC,KAAYA,EAAOJ,WAAaI,EAAOH,QACvFQ,EAAoB,SAAAL,GAAM,OAAID,EAAkBC,IAAWA,EAAOJ,WAAaI,EAAOH,QACtFS,EAAkB,SAAAN,GAAM,OAAID,EAAkBC,IAAWA,EAAOJ,UAAYI,EAAOH,QAEnFU,EAAkB,SAAAP,GAAM,OAAID,EAAkBC,GACtDA,EAAOJ,UAAYI,EAAOH,OAAS,IAAMG,EAAOH,OAAS,IAAO,I,gDCjBxDW,EAAgB,uCAAG,WAAOC,EAAKC,GAAZ,6BAAAC,EAAA,6DAAqBC,EAArB,+BAA4B,KACpDC,EAAa,IAAIC,gBACvBC,YAAW,WAAQF,EAAWG,UAAYJ,GAFZ,SAGjBK,MAAMR,EAAD,YAAC,eAAUC,GAAX,IAAoBQ,OAAQL,EAAWK,UAAUC,MAAK,SAACC,GAEvE,OADKA,EAASC,IAAMC,QAAQC,IAAIH,GACzBA,KALqB,mFAAH,wDCGhBI,EACkB,kCAElBC,EAAgC,CAC3CC,eAAgB,iBAChBC,gBAAiB,kBACjBC,cAAe,iBAKJC,EAAqB,uCAAG,8BAAAlB,EAAA,2DAC7BmB,EAAQC,IAAQC,IAHe,iBAEF,0CAIVxB,EACnBgB,EAAe,OACf,CAAES,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OANnB,sBAIvBT,GAJuB,yCAQdI,EAA8BC,gBARhB,yDASnBJ,QAAQC,IAAR,MATmB,iCAW5BE,EAA8BE,iBAXF,0DAAH,qDAiBrBQ,EACX,SAAAC,GAAM,MAAK,CAAEC,KAFuC,gCAEcD,W,yFCd9DE,EAAY,2EAEZC,E,4MAEJC,mB,uCAAqB,yCAAA7B,EAAA,iEAAS8B,WAAcC,EAAvB,EAAuBA,KAAMC,EAA7B,EAA6BA,MAA7B,IAAsCC,SAAsBd,EAA5D,EAAkDe,SAA4BC,EAA9E,EAAmEC,UAClF3B,EAAW,KADI,kBAGA4B,IAAMC,KACrBzB,EAAkB,gBAClB,CACE0B,OAAQ,OACRC,KAAMC,KAAKC,UAAU,CAAEX,OAAMC,QAAOb,UACpCG,QAAS,CAAE,eAAgB,mBAAoB,aAAa,SAAb,OAAuBH,KAExE,CAAEwB,iBAAiB,IAVJ,OAGjBlC,EAHiB,uDAYNE,QAAQC,IAAR,MAZM,QAafH,GAAgC,MAApBA,EAASgB,SACvBL,IAAQwB,IDxByB,eCwBIzB,EAAO,CAAE0B,QAAS,IAAIC,KAAKX,KAChE,EAAKY,MAAMC,2CAA2ClC,EAA8BC,iBAfnE,yD,wDAmBrBkC,OAAS,kBACP,yBAAKC,MAAO,CAACC,QAAQ,OAAQC,SAAU,SAAUC,OAAQ,QAASC,SAAU,WAC1E,yBAAKC,UAAW,eAAgBL,MAAO,CAACM,SAAU,aAClD,kBAACC,EAAA,EAAD,CAAQC,SAAS,SAASC,MAAM,iBAC9B,kBAACC,EAAA,EAAD,KACE,yBAAKL,UAAW,aAAcM,IAAKC,EAAQ,KAAuBZ,MAAO,CAACa,MAAO,OAAQC,YAAa,WAK5G,yBAAKd,MAAO,CAACe,gBAAiB,UAAWC,KAAM,aAC/C,kBAACC,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAGC,WAAW,SAASpB,MAAO,CAACG,OAAQ,SAC5D,kBAACc,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,IACf,kBAACL,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,EAAGF,WAAW,UAC3B,kBAACH,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAGC,WAAW,UACrC,kBAACH,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,GACb,yBAAKX,IAAKC,EAAQ,KAA2BZ,MAAO,CAACa,MAAO,MAAOU,WAAY,UAEjF,kBAACN,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,GACb,kBAACE,EAAA,EAAD,CAAYC,QAAQ,KAAKpB,UAAW,QAASL,MAAO,CAAC0B,WAAW,SAAUC,MAAM,YAAhF,OAEA,kBAAC,IAAD,CACEC,KAAO,GACP5B,MAAO,CAAC0B,WAAW,WACnBG,MAAS,OAGX,kBAACL,EAAA,EAAD,CAAYC,QAAQ,KAAKpB,UAAW,QAASL,MAAO,CAAC0B,WAAW,UAAWC,MAAM,YAAjF,0BAKJ,6BACA,yBAAK3B,MAAO,CAACuB,WAAY,OACrB,kBAAC,cAAD,CACIO,SAAUrD,EACVsD,WAAW,sBACXC,UAAW,SAAAzE,GAAc,EAAKoB,mBAAmBpB,IACjD0E,UAAW,SAAA1E,GAAcE,QAAQC,IAAIH,IACrC2E,aAAa,qBACbC,aAAa,aACbnC,MAAO,CAACoC,MAAO,UAEjB,kBAACC,EAAA,EAAD,CACEZ,QAAQ,WACRzB,MAAO,CAAC,OAAW,OAAQuB,WAAY,MACvCe,QAAS,WACP,EAAKzC,MAAMC,2CAA2ClC,EAA8BG,iBAJxF,uBAUR,kBAACkD,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,GACZ,yBAAKX,IAAKC,EAAQ,KAA0BZ,MAAO,CAACa,MAAO,MAAOU,WAAY,c,YA3E/DgB,IAAMC,WAkFjBC,eACb,SAAAnG,GAAK,MAAK,CAAEoG,0BAA2BpG,EAAMoG,8BAC7C,SAAAC,GAAQ,MAAK,CACX7C,2CAA4C,SAAA8C,GAAI,OAAID,EAASrE,EAAmCsE,QAHrFH,CAKb/D,G,4EC5FF,SAASmE,EAAGC,GACV,OAAOA,EAAE,GAEX,I,EAAMC,EAAU,CACdC,WAAOC,EACPC,YAAa,CACX,CAAErE,KAAM,OAAQsE,QAAS,CAAC,cAAeC,YAAaP,GACtD,CAAEhE,KAAM,aAAcsE,QAAS,CAAC,eAAgBC,YAAaP,GAC7D,CAAEhE,KAAM,aAAcsE,QAAS,CAAC,UAAWC,YAAaP,GACxD,CACEhE,KAAM,cACNsE,QAAS,CAAC,SAAU,IAAK,CAAEE,QAAS,IAAKC,IAAK,IAAM,IAAK,cACzDF,YAAa,SAASG,GACpB,MAAO,CAACA,EAAE,GAAIA,EAAE,GAAIA,EAAE,MAG1B,CAAE1E,KAAM,SAAUsE,QAAS,CAAC,WAAYC,YAAaP,GACrD,CAAEhE,KAAM,SAAUsE,QAAS,CAAC,QAASC,YAAaP,GAClD,CACEhE,KAAM,UACNsE,QAAS,CAAC,OAAQ,IAAK,CAAEE,QAAS,IAAKC,IAAK,IAAM,IAAK,UACvDF,YAAa,SAASG,GACpB,MAAO,CAACA,EAAE,GAAIA,EAAE,GAAIA,EAAE,MAG1B,CAAE1E,KAAM,OAAQsE,QAAS,CAAC,OAAQC,YAAaP,GAC/C,CAAEhE,KAAM,OAAQsE,QAAS,CAAC,UAAWC,YAAaP,GAClD,CAAEhE,KAAM,OAAQsE,QAAS,CAAC,OAAQC,YAAaP,GAC/C,CAAEhE,KAAM,sBAAuBsE,QAAS,CAAC,UAAWC,YAAaP,GACjE,CAAEhE,KAAM,sBAAuBsE,QAAS,CAAC,OAAQC,YAAaP,GAC9D,CACEhE,KAAM,MACNsE,QAAS,CAAC,CAAEE,QAAS,IAAKC,IAAK,IAAM,wBAEvC,CACEzE,KAAM,SACNsE,QAAS,CACP,CAAEE,QAAS,IAAKC,IAAK,KACrB,IACA,aACA,IACA,CAAED,QAAS,IAAKC,IAAK,MAEvBF,YAAa,SAASG,GACpB,OAAOA,EAAE,KAGb,CACE1E,KAAM,eACNsE,QAAS,CAAC,CAAEE,QAAS,KAAO,CAAEA,QAAS,MACvCD,YAAa,SAAgBG,GAC3B,OAAOA,EAAEC,KAAK,MAGlB,CAAE3E,KAAM,aAAcsE,QAAS,CAAC,UAChC,CACEtE,KAAM,aACNsE,QAAS,CAAC,QAAS,cACnBC,YAAa,SAAmBG,GAC9B,MAAO,CAACA,EAAE,IAAIE,OAAOF,EAAE,MAG3B,CACE1E,KAAM,MACNsE,QAAS,CAAC,eAAgB,aAAc,CAAEE,QAAS,IAAKC,IAAK,MAC7DF,YAAa,SAASG,GACpB,OAAOA,EAAE,GAAGC,KAAK,IAAIE,SAGzB,CAAE7E,KAAM,WAAYsE,QAAS,IAC7B,CACEtE,KAAM,WACNsE,QAAS,CAAC,CAAEE,QAAS,IAAKC,IAAK,KAAO,YACtCF,YAAa,SAAmBG,GAC9B,MAAO,CAACA,EAAE,IAAIE,OAAOF,EAAE,MAG3B,CACE1E,KAAM,IACNsE,QAAS,CAAC,YACVC,YAAa,SAASG,GACpB,OAAO,QAIbI,YAAa,QAEFC,EAAQ,SAACC,GAAmC,IACnDC,EAAmB,KACvB,GAAID,EAAW,CACb,IAAME,EAAS,IAAIC,IAAQC,OAAOD,IAAQjB,QAAQmB,aAAanB,IAC/D,IACEgB,EAAOI,KAAKN,EAAUH,QAClBK,EAAOK,QAAQC,OAAS,IAC1BP,EAAmBC,EAAOK,SAE5B,MAAOE,KAEX,OAAOR,G,QCjHIS,GACX,SAACC,EAAUC,EAAcC,GAA0E,IAA1DC,EAAyD,uDAArC,SAAAH,GAAQ,OAAIjF,KAAKqE,MAAMY,IAC9EI,EAAQH,EACZ,GAAID,EACF,IAAMI,EAAQD,EAAkBH,GAChC,MAAOK,GACDH,GAAkBjH,QAAQC,IAAIgH,GAClCjH,QAAQC,IAAImH,GAGhB,OAAOD,GAGEE,GACX,SAACN,EAAUC,EAAcC,GAA0E,IAA1DC,EAAyD,uDAArC,SAAAH,GAAQ,OAAIjF,KAAKqE,MAAMY,IAClF,IAAKA,EAAY,OAAOC,EACxB,IAAIG,EAAQ,KACZ,IAAMA,EAAQD,EAAkBH,GAChC,MAAOK,GACDH,GAAkBjH,QAAQC,IAAIgH,GAClCjH,QAAQC,IAAImH,GAEd,OAAOD,GCjBLG,GAAsBR,GAC1BS,aAAaC,QAHkC,iBAI/C,GACA,yBAEIC,GAAgB,CACpBnJ,SAAUgJ,GAAoB3I,eAAe,YACzC2I,GAAoBhJ,SAAWD,EAAgBC,SACnDC,OAAQ+I,GAAoB3I,eAAe,UAAY2I,GAAoB/I,OAASF,EAAgBE,OACpGC,SAAU8I,GAAoB3I,eAAe,YAAc2I,GAAoB9I,SAAWH,EAAgBE,QAgB/FmJ,GAAsB,SAAAC,GAAU,MAAK,CAAE5G,KADhB,iBACmD4G,e,mBC7B1EC,GAAsB,SAAAC,GAAU,MAAK,CAAE9G,KADR,iBAC4C8G,eCKzEC,gBAAe,CAC5BC,QAASC,aAAgB,CACvBC,kBFWoC,eAACpJ,EAAD,uDAAS4I,GAAeS,EAAxB,6CAFK,0BAG3CA,EAAOnH,MAAkDnC,EAAqBsJ,GAClEA,EAAOxJ,OAAfG,GEZFsJ,cFgBgC,eAACtJ,EAAD,wDAAgBqJ,EAAhB,6CAFW,sBAG7CA,EAAOnH,MAFwC,wBAEImH,EAAOnH,KACtDlC,EAJyC,sBAIjCqJ,EAAOnH,MEjBjB4G,WFqB6B,eAAC9I,EAAD,uDAAS,KAAMqJ,EAAf,6CAFG,mBAGlCA,EAAOnH,OAAwCmH,EAAOvJ,eAAe,eACnEuJ,EAAOP,aAAcO,EAAOP,WAAWhJ,eAAe,OAJtB,mBAKTuJ,EAAOnH,KAAuC,KAAOlC,EAA1EqJ,EAAOP,YEvBT1C,0BNsB4C,WAI1C,IAHJpG,EAGG,uDAHK0I,aAAaC,QAN6C,kCAO9DrH,EAA8BG,cAAgBH,EAA8BE,gBAChF6H,EACG,uCACH,MARoD,kCASlDA,EAAOnH,MAA2DmH,EAAOvJ,eAAe,WACvFwB,EAA8BxB,eAAeuJ,EAAOpH,SAEnDoH,EAAOpH,SAAWX,EAA8BG,cAClDiH,aAAaa,QAfmD,kCAeW,GACpEb,aAAac,WAhB4C,kCAiB3DH,EAAOpH,QAJHjC,GM7BTgJ,WDVgC,eAAChJ,EAAD,uDAAS,KAAMqJ,EAAf,6CAFQ,mBAG3CA,EAAOnH,MAA0CmH,EAAOvJ,eAAe,cAC5DuJ,EAAOL,WAAfhJ,OEESyJ,GAAsB,IAAIC,YADP,eAGjB,OAAIC,SAAO,CACxBC,IAAKH,GACLzJ,MAAO,CACL6J,KAAM,kBAAM,MACZC,MAAO,SAACC,EAAIC,EAAQC,GAClB,IAAIC,EAAOH,EAAGI,UAAUD,KACpBE,EAAW,KAQf,OAPAL,EAAGM,IAAIC,aAAaJ,EAAMA,GAAM,SAACK,EAAMvD,GACjCuD,EAAKzK,eAAe,UAAYyK,EAAKC,MAAL,OAAsBJ,EAAW,CAAEG,OAAMvD,aAG3EiD,GAAYG,GAAcH,IAAaG,GACxCH,GAAYG,IAAaA,EAASpD,MAAQiD,EAASjD,MAAQoD,EAASG,KAAKE,GAAGR,EAASM,SACpFG,GAAMrE,SAASwC,GAAoBuB,EAAW,CAAEpD,IAAKoD,EAASpD,KAAQ,OACnEoD,IAGX7G,MAAO,CACLoH,YAAa,SAAA3K,GACX,IAAM4K,EAAoB,GACpB9B,EAAaW,GAAoBoB,SAAS7K,GAQhD,OAPI8I,GACF8B,EAAkBE,KAAKC,aAAWR,KAChCzB,EAAW9B,IACX8B,EAAW9B,IAAM8B,EAAWyB,KAAKS,SACjC,CAAEtH,MAAO,sDAGNuH,gBAAcC,OAAOlL,EAAMqK,IAAKO,OC/BhCO,GAAwB,IAAIzB,YADP,iBAqB5B0B,GAAqB,SAArBA,EAAsBT,EAAaU,EAAYvC,EAAYyB,EAAMe,EAAYtE,GACjF,IAAIuE,GAAQ,EACNC,EAAWjB,EAAKzK,eAAe,UAAYyK,EAAKC,MAAL,KAC3CiB,EAAQ,2BAAQH,GAAgBE,EAAWjB,EAAKC,MAAL,KAAqB,MAEtE,GADIgB,IAAYD,EAtBM,SAAlBG,EAAmBC,EAAMN,GAC7B,IAAKA,EAAc,OAAO,EAC1B,IAAKO,MAAMC,QAAQR,GAAe,OAAOM,EAAK7L,eAAeuL,GAG7D,GAA0B,IAAtBA,EAAWtD,OAAgB,OAAQ2D,EAAgBC,EAAMN,EAAW,IACxE,IAAMS,EAASJ,EAAgBC,EAAMN,EAAW,IAChD,OAA0B,IAAtBA,EAAWtD,QAEiB,MAAlBsD,EAAW,KAEXS,EAJwBA,EAQ/BJ,EAAgBC,EAAMN,EAAW,IAOhBK,CAAgBD,EAAUJ,KAC7Cd,EAAKwB,YAER,IADA,IAAIC,EAAsB,EACjBC,EAAI,EAAGA,EAAI1B,EAAK2B,aAAcD,EAAG,CACxC,IAAME,EAAQ5B,EAAK4B,MAAMF,GAEnBG,EAAahB,EAAmBT,EAAaU,EAAYvC,EAAYqD,EAAOV,EADjEzE,EAAMgF,GAEvBT,EAAQA,GAASa,EACjBJ,GAAuBG,EAAMnB,SAMjC,OAHY,IAARhE,GAAcuE,GAChBZ,EAAYG,KAAKC,aAAWR,KAAKvD,EAAM,EAAGA,EAAM,EAAIuD,EAAKS,SAAU,CAAEtH,MAAO,oBAEvE6H,GAGM,OAAI5B,SAAO,CACxBC,IAAKuB,GACLnL,MAAO,CACL6J,KAAM,kBAAM,MACZC,MAAO,SAACC,EAAIsC,GACV,IAAMC,EAAMvC,EAAGwC,QAAQpB,IACvB,YAAexE,IAAR2F,EAAoBD,EAAIC,IAGnC/I,MAAO,CACLoH,YAAa,SAAA3K,GACX,IAAMwM,EAAoB,GACpBnB,EAAaF,GAAsBN,SAAS7K,GAC5C8I,EAAaW,GAAoBoB,SAAS7K,GAEhD,OADIqL,GAAcD,GAAmBoB,EAAmBnB,EAAYvC,EAAY9I,EAAMqK,IAAK,GAAI,GACxFY,gBAAcC,OAAOlL,EAAMqK,IAAKmC,O,gDCvDhCC,GAA4B,IAAI/C,YADN,sBAaxB,OAAIC,SAAO,CACxBC,IAAK6C,GACLC,kBAAmB,SAAC3C,EAAI/J,GAAL,OAChBE,EAAkBwK,GAAMG,WAAWzB,qBAAuB+B,GAAsBN,SAAS7K,IAC1F+J,EAAG4C,MAAMC,OACP,SAAAC,GAAI,MAA+B,YAA3BA,EAAKC,SAASC,WAfY,SAAAF,GAAI,OAAIA,EAAKG,MAAMC,QAAQA,QAAQC,MAAK,SAAA3C,GAAI,OAAKA,EAAK4C,UAgBpFC,CAAgCP,KAdF,SAACA,EAAMxC,GAC7C,GAAIwC,EAAKQ,OAASR,EAAKS,GAAM,OAAO,EACpC,IAAMC,EAAWlD,EAAImD,OAAOX,EAAKQ,MAC3BI,EAASpD,EAAImD,OAAOX,EAAKS,IAC/B,OAAIG,GAAkBF,GAAaA,IAAaA,EAAS9C,GAAGgD,IACpDF,IAAalD,EAAImD,OAAOX,EAAKS,GAAK,GAAG7C,GAAG8C,GASEG,CAAgCb,EAAM7M,EAAMqK,WCdjF,O,oKAJA,MAAO,sB,8BACJ,MAAO,CAACsD,GAAwBC,GAAkBC,Q,GAFzCC,eCUrBC,GAAkB,QAClBC,GAA0B,OAE1BC,G,4MAEJjO,MAAQ,CAAEkO,gBAAiB,GAAIC,UAAW,I,EAE1CC,aAAe,WACb,IAAMC,EAAMC,SAASC,eAZA,iBAYiCjG,MAAMlB,OAC5D,IAAKiH,GAAOL,GAAwBQ,KAAKH,KAAS,EAAK9K,MAAMuF,WAAc,OAAO,EAClF,GAAI,EAAK9I,MAAMkO,gBAAgBpO,eAAe,SAAW,EAAKE,MAAMkO,gBAAgBvC,KAAK7L,eAAeuO,GAEtG,OADAI,MAAM,cAAgBJ,EAAM,qBACrB,EAET,IAAMK,EAAkB,2BAAQ,EAAK1O,MAAMkO,iBAAnB,IAAoCvC,KAAK,eAAK,EAAK3L,MAAMkO,gBAAgBvC,QAWjG,OAVA+C,EAAmB/C,KAAK0C,GAAOM,eAC/BC,GAA4BC,OAAOC,KAAKzI,SACtCuI,GAA4BC,OAAOC,KAAK9O,MAAM+J,GAAGgF,cAC/C,EAAKxL,MAAMuF,WAAW9B,IACtB,KACA0H,IAGJ,EAAKM,SAAS,CAAEd,gBAAiBQ,IACjC,EAAKnL,MAAM0L,kCACJ,G,EAGTC,gBAAkB,SAAAb,GAChB,IACG,EAAK9K,MAAMuF,aAAe,EAAK9I,MAAMkO,gBAAgBpO,eAAe,UACpE,EAAKE,MAAMkO,gBAAgBvC,KAAK7L,eAAeuO,GAC9C,OAAO,EACX,IAAMK,EAAkB,2BAAQ,EAAK1O,MAAMkO,iBAAnB,IAAoCvC,KAAK,eAAK,EAAK3L,MAAMkO,gBAAgBvC,QAWjG,cAVO+C,EAAmB/C,KAAK0C,GAC/BO,GAA4BC,OAAOC,KAAKzI,SACtCuI,GAA4BC,OAAOC,KAAK9O,MAAM+J,GAAGgF,cAC/C,EAAKxL,MAAMuF,WAAW9B,IACtB,KACA0H,IAGJ,EAAKM,SAAS,CAAEd,gBAAiBQ,IACjC,EAAKnL,MAAM0L,kCACJ,G,EAGTE,qBAAuB,SAAAC,GACrB,IAAMC,EAAcf,SAASC,eAlDE,oBAkD0Ca,GAAa9G,MAAMlB,OAC5F,IACGiI,GAAerB,GAAwBQ,KAAKa,KAAiB,EAAK9L,MAAMuF,aACxE,EAAK9I,MAAMkO,gBAAgBpO,eAAe,UAC1C,EAAKE,MAAMkO,gBAAgBvC,KAAK7L,eAAesP,GAC9C,OAAO,EACX,GAAIC,IAAgBD,EAAe,OAAO,EAC1C,GAAI,EAAKpP,MAAMkO,gBAAgBvC,KAAK7L,eAAeuP,GAEjD,OADAZ,MAAM,cAAgBY,EAAc,qBAC7B,EAET,IAAMX,EAAkB,2BAAQ,EAAK1O,MAAMkO,iBAAnB,IAAoCvC,KAAK,eAAK,EAAK3L,MAAMkO,gBAAgBvC,QAYjG,OAXA+C,EAAmB/C,KAAK0D,GAAeX,EAAmB/C,KAAKyD,UACxDV,EAAmB/C,KAAKyD,GAC/BR,GAA4BC,OAAOC,KAAKzI,SACtCuI,GAA4BC,OAAOC,KAAK9O,MAAM+J,GAAGgF,cAC/C,EAAKxL,MAAMuF,WAAW9B,IACtB,KACA0H,IAGJ,EAAKM,SAAS,CAAEd,gBAAiBQ,IACjC,EAAKnL,MAAM0L,kCACJ,G,EAGTK,2BAA6B,SAAAjB,GAC3B,IAAMkB,EA7EyB,oBA6EYlB,EAC3CkB,EAAMjH,MAAQ+F,EACdkB,EAAMC,kBAAkB,EAAG,GACvB,EAAKxP,MAAMmO,YAAcE,GAAO,EAAKW,SAAS,CAAEb,UAAW,M,EAGjEsB,6BAA+B,SAACpB,GAC9B,EAAKW,SAAS,CAAEb,UAAWE,IAC3BqB,iBAAM,WACJ,IAAMH,EAAQjB,SAASC,eAtFM,oBAsFsCF,GACnEkB,EAAMI,QACNJ,EAAMC,kBAAkB,EAAGD,EAAMjH,MAAMP,Y,EAI3C6H,mBAAqB,SAAAC,IAEjBA,EAAUzG,kBAAkB3J,WAAa,EAAK8D,MAAM6F,kBAAkB3J,UACtEoQ,EAAUzG,kBAAkB1J,SAAW,EAAK6D,MAAM6F,kBAAkB1J,SAClEmQ,EAAU/G,YAAc,EAAKvF,MAAMuF,YAAgB+G,EAAU/G,aAAe,EAAKvF,MAAMuF,YACxF+G,EAAU/G,YAAc,EAAKvF,MAAMuF,YAAc+G,EAAU/G,WAAW9B,MAAQ,EAAKzD,MAAMuF,WAAW9B,OAErGsH,SAASC,eArGU,iBAqGuBjG,MAAQ,GAClDoH,iBAAM,WACJ,GAAI,EAAKnM,MAAMuF,WAAY,CACzB,IAAMyB,EAAOqE,GAA4BC,OAAOC,KAAK9O,MAAMqK,IAAImD,OAAO,EAAKjK,MAAMuF,WAAW9B,KAC5F,EAAKgI,SAAS,CAAEd,gBAAgB,eAAM3D,GAAQA,EAAKzK,eAAe,SAAWyK,EAAKC,MAAQ,aACnF,EAAKwE,SAAS,CAAEd,gBAAiB,U,EAKhDzK,OAAS,kBACP,yBAAKM,UAAU,cACb,yBAAKwC,GAAG,oBACN,yBAAKxC,UAAU,WAAWwC,GAAG,qBAC3B,2BACEA,GApHa,gBAqHbuJ,MAAM,UACNC,YAAY,UACZC,UAAW,EAAKzM,MAAMuF,WACtBmH,WAAY,SAAAC,GACQ,UAAdA,EAAMtG,KAAmB,EAAKwE,iBAAkB8B,EAAMC,OAAO7H,MAAQ,IACpEyF,GAAgBS,KAAK0B,EAAMtG,MAAQsG,EAAME,kBAEhDC,UAAW,SAAAH,GACS,WAAdA,EAAMtG,MACRsG,EAAMC,OAAO7H,MAAQ,GACrBsG,GAA4BC,OAAOC,KAAKa,YAI9C,4BACE5L,UAAU,sBACV+L,MAAM,MACNE,UAAW,EAAKzM,MAAMuF,WACtB9C,QAAS,EAAKoI,cACb,MAGL,yBAAK7H,GAAG,2BAEJ,EAAKhD,MAAMuF,YAAc,EAAK9I,MAAMkO,gBAAgBpO,eAAe,SACnEwQ,OAAOC,KAAK,EAAKvQ,MAAMkO,gBAAgBvC,MAAM5D,OAAS,EAClD,wBAAIxB,GAjJY,wBAmJZ+J,OAAOC,KAAK,EAAKvQ,MAAMkO,gBAAgBvC,MAAM6E,KAAI,SAAAnC,GAAG,OAClD,wBAAIzE,IAAKyE,GACP,yBAAKtK,UAAU,aAEX,EAAK/D,MAAMmO,YAAcE,EACrB,4BAAQ2B,UAAQ,GAAE3B,GACjB,2BACC9H,GAtJC,oBAsJgC8H,EACjClG,aAAckG,EACd0B,YAAa1B,EACb2B,SAAU,EAAKhQ,MAAMmO,YAAcE,EACnCoC,OAAQ,SAAAP,GACN,EAAKf,qBAAqBd,GACtB,EAAKrO,MAAMmO,YAAcE,GAAO,EAAKW,SAAS,CAAEb,UAAW,MAEjEkC,UAAW,SAAAH,GACS,WAAdA,EAAMtG,KAAoB,EAAK0F,2BAA2BjB,IAEhE4B,WAAY,SAAAC,GACQ,UAAdA,EAAMtG,KAAmBsG,EAAMC,OAAOO,OACrC3C,GAAgBS,KAAK0B,EAAMtG,MAAQsG,EAAME,oBAIxD,4BACErM,UAAU,sBACV+L,MAAM,SACNa,OAAQ,EAAK3Q,MAAMmO,YAAcE,EACjCrI,QAAS,WAAQ,EAAKyJ,6BAA6BpB,KAClD,KAEH,4BACEtK,UAAU,sBACV+L,MAAM,SACN9J,QAAS,WAAQ,EAAKkJ,gBAAgBb,KACrC,WAOb,yBAAKtK,UAAU,yBAAyBwC,GAAG,uBACxC,OAAU,EAAKhD,MAAMuF,WAAgC,aAAnB,uB,YArL/B7C,IAAMC,WA6LbC,gBACb,SAAAnG,GAAK,MAAK,CACR8I,WAAY9I,EAAM8I,WAClBQ,cAAetJ,EAAMsJ,cACrBF,kBAAmBpJ,EAAMoJ,sBAE3B,SAAA/C,GAAQ,MAAK,CAAE4I,+BAAgC,kBAAM5I,EAAS,CAAEnE,KP9LnB,0BOwLhCiE,CAOb8H,I,mBChNW2C,GAA+B,SAACnR,EAAUoR,GAAX,OAC1CnI,aAAaa,QAJ+B,eAIiB9J,EAAUwD,KAAKC,UAAU2N,KAElFC,GAA+B,SAAArR,GAAQ,OAAI+I,GAC/CE,aAAaC,QAP+B,eAOiBlJ,GAC7D,GACA,wBAMWsR,GAAiC,SAAAC,GAAa,OACzDtI,aAAaa,QAJ2B,gBAIgBtG,KAAKC,UAAU8N,KAQ5DC,GAAiC,SAACC,EAAiBC,GAC9D,MAAQA,GAAaD,EAAgBpR,eAAeqR,EAAUC,aAAeD,GAAa,EAC1F,OAAOA,EAAUC,YAGNC,GAAsC,SAAAC,GAAS,MAAK,CAC/DC,OAAQN,GAA+BK,EAAW,GAClDE,2BAA4BlB,OAAOmB,YAAYnB,OAAOoB,QAAQJ,GAAWd,KACvE,mCAAE/Q,EAAF,KAAckS,EAAd,KAAcA,MAAd,MAA2B,CAAClS,EAAUwR,GAA+BU,EAAO,UAajE,IACbC,eAAe,WAAD,4BAAE,0CAAApR,EAAA,yDACRwQ,EA7BmCxI,GAC3CE,aAAaC,QAP2B,iBAQxC,GACA,yBAyBgB,yCAEe,MAFf,OAGR2I,EAAY,GAHJ,MAIuBhB,OAAOoB,QAAQV,GAJtC,kEAIFvR,EAJE,KAIQoS,EAJR,KAKNhB,EAAcC,GAA6BrR,GALrC,0CAMe,MANf,QAOZ6R,EAAU7R,GAAY,CAAE8C,KAAMsP,EAAYF,MAAOd,GAPrC,4DASPS,GATO,4CAAF,kDAAC,GAWfQ,eAAe,WAAD,4BAAE,WAAOC,EAAUtS,EAAUC,EAAQwC,EAAM8P,GAAzC,eAAAxR,EAAA,6DACRyR,EAjBiC,YAiB8B7R,EAAgBX,GACjFsS,EAAShK,OAAS,EAAKW,aAAaa,QAAQ0I,EAAyBhP,KAAKC,UAAU6O,IACjFrJ,aAAac,WAAWyI,GAHjB,+BAIL1L,GAAI7G,EAAQD,YAAcuS,EAAY,CAAEzP,KAzB3B,eAyBoDL,QAAS,OAJrE,2CAAF,2DAAC,GAMfgQ,UAAU,WAAD,4BAAE,WAAOrS,GAAP,SAAAW,EAAA,+EAAkBgI,GAC3BE,aAAaC,QAvB0B,YAuBmBvI,EAAgBP,EAAOJ,SAAUI,EAAOH,SAClG,GACA,qBAHS,2CAAF,mDAAC,GAKVyS,wBAAwB,WAAD,4BAAE,WAAM1S,GAAN,iCAAAe,EAAA,yDACjB4R,EAAsB1J,aAAaC,QA1BG,iBA0B+ClJ,GADpE,yCAEY,IAFZ,UAGjB4S,EAAmBpK,GAAyBmK,EAAqB,KAAM,yBAHtD,yCAIS,MAJT,OAMvB,GADME,EAAqB,GACvBD,EAEF,IADME,EAAQ,CAACF,GACRE,EAAMxK,OAAS,GAEpB,IADMwC,EAAOgI,EAAMC,SACV1S,eAAe,UAAYyK,EAAKC,MAAM1K,eAAe,QAC5D,UAA2BwQ,OAAOoB,QAAQnH,EAAKC,MAAMmB,MAArD,eAA6D,EAAD,oBAAhD0C,EAAgD,KAA3CoE,EAA2C,KAAEH,EAAmBG,GAAS,CAAEpE,MAAK9D,aACxFA,EAAKzK,eAAe,YAAcyS,EAAMzH,KAAN,MAAAyH,EAAK,aAAShI,EAAK0C,UAZ7C,yBAehBqF,GAfgB,2CAAF,mDAAC,GAiBxBI,oBAAoB,WAAD,4BAAE,WAAOpK,EAAO7I,EAAUuS,GAAxB,iBAAAxR,EAAA,yDAUD,QATZmS,EAAYnK,GAChBF,EACA,GACA,+BACA,SAAAJ,GAEE,OADAjF,KAAKqE,MAAMY,GACJA,MAPQ,yCAUc,MAVd,cAWb0K,EArDsC,iBAqDmCnT,EAC3EkT,EAAajK,aAAaa,QAAQqJ,EAA8BD,GAC7DjK,aAAac,WAAWoJ,GAbZ,+BAcVrM,GAAI9G,GAAcuS,EAAY,CAAEzP,KA9DjB,kBA8D+C,OAdpD,2CAAF,uDAAC,GAgBpBsQ,mBAAmB,WAAD,4BAAE,WAAMpT,GAAN,SAAAe,EAAA,+EAAkBgI,GACpCE,aAAaC,QA3D+B,iBA2DmBlJ,GAC/D,GACA,yBACA,SAAAyI,GAEE,OADAjF,KAAKqE,MAAMY,GACJA,MANS,2CAAF,mDAAC,GAUnB4K,2BAA2B,WAAD,4BAAE,WAAOrT,EAAUsT,GAAjB,eAAAvS,EAAA,6DACpBwS,EAzEgD,yBAyE2CvT,EAC7F6Q,OAAOC,KAAKwC,GAAuBhL,OAAS,EAC9CW,aAAaa,QAAQyJ,EAAsC/P,KAAKC,UAAU6P,IACnErK,aAAac,WAAWwJ,GAJP,mBAKnB,GALmB,2CAAF,qDAAC,GAO3BC,2BAA2B,WAAD,4BAAE,WAAMxT,GAAN,SAAAe,EAAA,+EAAkBgI,GAC5CE,aAAaC,QAhFyC,yBAgFmBlJ,GACzE,GACA,kCAH0B,2CAAF,mDAAC,GAK3ByT,aAAa,WAAD,4BAAE,WAAOzT,EAAUC,GAAjB,SAAAc,EAAA,6DACZkI,aAAac,WAnF0B,YAmFsBpJ,EAAgBX,IADjE,mBAEL,GAFK,2CAAF,qDAAC,GAIb0T,eAAe,WAAD,4BAAE,WAAO1T,EAAU2T,GAAjB,iBAAA5S,EAAA,sDACdkI,aAAac,WAzFyC,yBAyFsB/J,GAC5EiJ,aAAac,WAtF+B,iBAsFsB/J,GAFpD,eAGO2T,GAHP,IAGd,2BAAgD,QAC9C1K,aAAac,WA1FwB,YA0FwBpJ,EAAgBX,IAJjE,qCAMdiJ,aAAac,WArI6B,eAqIsB/J,GANlD,mBAOP,GAPO,2CAAF,qDAAC,GASf4T,aAAa,WAAD,4BAAE,sBAAA7S,EAAA,gFAAY,GAAZ,2CAAF,kDAAC,GACb8S,eAAe,WAAD,4BAAE,sBAAA9S,EAAA,gFAAY,GAAZ,2CAAF,kDAAC,ICtIX+S,GAAuB,CAAErR,KAAM,MAAO+K,QAAS,CAAC,CAAE/K,KAAM,YAAasI,MAAO,CAAEmB,KAAM,OAE3E,IACbiG,eAAe,WAAD,4BAAE,8BAAApR,EAAA,6DACRmB,EAAQC,IAAQC,IbEa,gBaHrB,kBAGWxB,EACrBgB,EAAe,YACf,CAAES,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OALtC,YAGNV,EAHM,QAOCC,GAPD,gCAOoBD,EAASuS,OAP7B,iGAQArS,QAAQC,IAAR,MARA,iCASP,MATO,0DAAF,kDAAC,GAWf0Q,eAAe,WAAD,4BAAE,WAAOC,EAAUtS,EAAUC,EAAQwC,EAAM8P,GAAzC,qBAAAxR,EAAA,6DACRmB,EAAQC,IAAQC,IbTa,gBaQrB,kBAGWxB,EACrBgB,EAAe,qBAAiB5B,EAAjB,qBAAsCyC,IAAW8P,EAAkC,GAAnC,kBAAwBtS,IACvF,CACEqD,OAAQ,MACRC,KAAMC,KAAKC,UAAU,CAAEyI,KAAMoG,IAC7BjQ,QAAS,IAAIC,QAAQ,CAAE,eAAgB,mBAAoB,aAAa,SAAb,OAAuBJ,OAR1E,YAGNV,EAHM,QAWCC,GAXD,iCAYeD,EAASuS,OAZxB,uBAYFC,EAZE,EAYFA,OAZE,+BAaDlN,GAAIkN,EAAQhU,SAAUA,GAAcuS,EAAY,CAAEzP,KAAK,WAAYL,QAAS,OAb3E,0DAeAf,QAAQC,IAAR,MAfA,iCAgBP,MAhBO,0DAAF,2DAAC,GAkBf8Q,UAAU,WAAD,4BAAE,WAAOrS,GAAP,uBAAAW,EAAA,6DACHmB,EAAQC,IAAQC,Ib3Ba,gBa0B1B,kBAGoBxB,EACzBgB,EAAe,qBAAiBxB,EAAOJ,SAAxB,mBAA2CI,EAAOH,QACjE,CAAEqD,OAAQ,MAAOjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OAL1D,cAGD+R,EAHC,gBAOmBrT,EACtBgB,EAAe,qBAAiBxB,EAAOJ,UACvC,CAAEsD,OAAQ,MAAOjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OAT5D,UAODgS,EAPC,OAWFD,EAAaxS,IAAOyS,EAAYzS,GAX9B,0CAW2C,MAX3C,yBAYiBwS,EAAaF,OAZ9B,eAYDI,EAZC,iBAaiBD,EAAYH,OAb7B,eAaDK,EAbC,yBAcA,CAAC,KAAQD,EAAW,KAAQC,EAAW,KAAQhU,EAAOF,WAdtD,kCAeKwB,QAAQC,IAAR,MAfL,iCAgBF,MAhBE,0DAAF,mDAAC,GAkBV+Q,wBAAwB,WAAD,4BAAE,WAAM1S,GAAN,iBAAAe,EAAA,6DACjBmB,EAAQC,IAAQC,Ib7Ca,gBa4CZ,kBAGExB,EACrBgB,EAAe,qBAAiB5B,GAChC,CAAEsD,OAAQ,MAAOjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OAL5C,YAGfV,EAHe,QAORC,GAPQ,gCAOWD,EAASuS,OAPpB,iGAQTrS,QAAQC,IAAR,MARS,iCAShB,MATgB,0DAAF,mDAAC,GAWxBsR,oBAAoB,WAAD,4BAAE,WAAOpK,EAAO7I,EAAUuS,GAAxB,yBAAAxR,EAAA,yDACbmS,EAAYnK,GAChBF,EACArF,KAAKC,UAAUqQ,IACf,+BACA,SAAArL,GAEE,OADAjF,KAAKqE,MAAMY,GACJA,KAPQ,yCAUM,MAVN,cAWbvG,EAAQC,IAAQC,IblEa,gBauDhB,kBAaMxB,EACrBgB,EAAkB,YAAe2Q,EAAmC,GAApC,iBAAuBvS,IACvD,CACEsD,OAAQ,MACRC,KAAM2P,EACN7Q,QAAS,IAAIC,QAAQ,CAAE,eAAgB,mBAAoB,aAAa,SAAb,OAAuBJ,OAlBrE,YAaXV,EAbW,QAqBJC,GArBI,kCAsBYD,EAASuS,OAtBrB,wBAsBPjN,EAtBO,EAsBPA,GAAIhE,EAtBG,EAsBHA,KAtBG,+BAuBNgE,GAAIA,GAAQyL,EAAY,CAAEzP,QAAS,OAvB7B,0DAyBLpB,QAAQC,IAAR,MAzBK,iCA0BZ,MA1BY,0DAAF,uDAAC,GA4BpByR,mBAAmB,WAAD,4BAAE,WAAMpT,GAAN,iBAAAe,EAAA,6DACZmB,EAAQC,IAAQC,IbpFa,gBamFjB,kBAGOxB,EACrBgB,EAAe,yBAAqB5B,GACpC,CAAEqC,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OALlC,YAGVV,EAHU,QAOHC,GAPG,gCAOgBD,EAASqE,OAPzB,iGAQJnE,QAAQC,IAAR,MARI,iCASX,MATW,0DAAF,mDAAC,GAWnB0R,2BAA2B,WAAD,4BAAE,WAAOrT,EAAUsT,GAAjB,iBAAAvS,EAAA,6DACpBmB,EAAQC,IAAQC,Ib/Fa,gBagG7BiS,EAAUxD,OAAOC,KAAKwC,GAAuBvC,KAAI,SAAAuD,GAAC,OAAIhB,EAAsBgB,MAFxD,kBAID1T,EACrBgB,EAAe,iBACf,CACE0B,OAAQ,OACRC,KAAMC,KAAKC,UAAU,CAAEF,KAAM,CAAC,MAASvD,EAAU,QAAWqU,KAC5DhS,QAAS,IAAIC,QAAQ,CAAE,eAAgB,mBAAoB,aAAa,SAAb,OAAuBJ,OAT9D,kBAYXT,GAZW,0CAaf,GAbe,yDAeZC,QAAQC,IAAR,MAfY,iCAgBnB,MAhBmB,0DAAF,qDAAC,GAkB3B6R,2BAA2B,WAAD,4BAAE,WAAMxT,GAAN,iBAAAe,EAAA,6DACpBmB,EAAQC,IAAQC,IbjHa,gBagHT,kBAGDxB,EACrBgB,EAAe,wBAAoB5B,GACnC,CAAEqC,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OAL1B,YAGlBV,EAHkB,QAOXC,GAPW,gCAOQD,EAASuS,OAPjB,iGAQZrS,QAAQC,IAAR,MARY,iCASnB,MATmB,0DAAF,mDAAC,GAW3B+R,eAAe,WAAD,4BAAE,WAAM1T,GAAN,mBAAAe,EAAA,6DACRmB,EAAQC,IAAQC,Ib5Ha,gBa2HrB,kBAGSxB,EACnBgB,EAAe,yBAAqB5B,GACpC,CAAEsD,OAAQ,SAAUjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OALxD,uBAGJT,EAHI,EAGJA,GAHI,kBAOLA,GAPK,gCAQAC,QAAQC,IAAR,MARA,kCASP,GATO,yDAAF,mDAAC,GAWf8R,aAAa,WAAD,4BAAE,WAAOzT,EAAUC,GAAjB,mBAAAc,EAAA,6DACNmB,EAAQC,IAAQC,IbvIa,gBasIvB,kBAGWxB,EACnBgB,EAAe,qBAAiB5B,EAAjB,mBAAoCC,GACnD,CAAEqD,OAAQ,SAAUjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OAL1D,uBAGFT,EAHE,EAGFA,GAHE,kBAOHA,GAPG,gCAQEC,QAAQC,IAAR,MARF,kCASL,GATK,yDAAF,qDAAC,GAWbkS,eAAe,WAAD,4BAAE,WAAO7T,EAAU8C,GAAjB,mBAAA/B,EAAA,6DACRmB,EAAQC,IAAQC,IblJa,gBaiJrB,kBAGSxB,EACnBgB,EAAe,yBAAqB5B,EAArB,iBAAsC8C,GACrD,CAAEQ,OAAQ,QAASjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OALvD,uBAGJT,EAHI,EAGJA,GAHI,kBAOLA,GAPK,gCAQAC,QAAQC,IAAR,MARA,kCASP,GATO,yDAAF,qDAAC,GAWfiS,aAAa,WAAD,4BAAE,WAAO5T,EAAUC,EAAQ6C,GAAzB,mBAAA/B,EAAA,6DACNmB,EAAQC,IAAQC,Ib7Ja,gBa4JvB,kBAGWxB,EACnBgB,EAAe,qBAAiB5B,EAAjB,mBAAoCC,EAApC,iBAAmD6C,GAClE,CAAEQ,OAAQ,QAASjB,QAAS,IAAIC,QAAQ,CAAE,aAAa,SAAb,OAAuBJ,OALzD,uBAGFT,EAHE,EAGFA,GAHE,kBAOHA,GAPG,gCAQEC,QAAQC,IAAR,MARF,kCASL,GATK,yDAAF,uDAAC,ICnKT4S,GAA6B,kBACjCtJ,GAAMG,WAAWzE,4BAA8B9E,EAA8BG,cACzEwS,GAA+BC,IAE/BC,GAAkB,CACtBvC,eAAgB,WAAQ,MAAM,IAAIwC,MAAM,oBACxCtC,eAAgB,WAAQ,MAAM,IAAIsC,MAAM,oBACxClC,UAAW,WAAQ,MAAM,IAAIkC,MAAM,oBACnCjC,wBAAyB,WAAQ,MAAM,IAAIiC,MAAM,oBACjD1B,oBAAqB,WAAQ,MAAM,IAAI0B,MAAM,oBAC7CvB,mBAAoB,WAAQ,MAAM,IAAIuB,MAAM,oBAC5CtB,2BAA4B,WAAQ,MAAM,IAAIsB,MAAM,oBACpDnB,2BAA4B,WAAQ,MAAM,IAAImB,MAAM,oBACpDlB,aAAc,WAAQ,MAAM,IAAIkB,MAAM,oBACtCjB,eAAgB,WAAQ,MAAM,IAAIiB,MAAM,oBACxCf,aAAc,WAAQ,MAAM,IAAIe,MAAM,oBACtCd,eAAgB,WAAQ,MAAM,IAAIc,MAAM,qBAG3B9D,UAAOC,KAAK4D,IAAiBE,QAC1C,SAACC,EAAS1K,GAUR,OATA0K,EAAQ1K,GAAR,sBAAe,wCAAApJ,EAAA,2DACP+T,EAA0BP,MACDlU,eAAe8J,GAFjC,oBAIPc,GAAMG,WAAWzE,4BAA8B9E,EAA8BE,gBAJtE,gCAKG+S,EAAwB3K,GAAxB,MAAA2K,EAAuB,GAL1B,8CAK2C,KAL3C,8CAOTJ,GAAgBvK,KAPP,mFASR0K,IAET,ICpBWE,GAAqC,WAChD,IAAMpL,EAAoBsB,GAAMG,WAAWzB,kBACvClJ,EAAkBwK,GAAMG,WAAWzB,oBAAsBsB,GAAMG,WAAWvB,eAC5EmL,GAAwB/B,oBACtB9D,GAA4BC,OAAOvG,OAAM,GACzCc,EAAkB3J,UAClBuB,MAAK,SAAA0T,GACDA,EAAWhK,GAAMrE,SAAS,CAAEnE,KXAW,wBWCpCuM,MAAM,qCAKbkG,G,4MAEJlR,OAAS,WACP,IAAMmR,EAAoB3U,EAAkB,EAAKsD,MAAM6F,mBACvD,OACE,yBAAKrF,UAAU,YACb,yBAAKwC,GAAG,oBACN,yBAAKxC,UAAU,WAAWwC,GAAG,8BAC3B,4BACExC,UAAU,sBACV+L,MAAM,QACNE,SAAU4E,EACV5O,QAAS,WAAQ6O,GAA2BrV,KAC3C,UAEH,4BACEuE,UAAU,sBACV+L,MAAM,OACNE,SAAU4E,IAAsB,EAAKrR,MAAM+F,cAC3CtD,QAASwO,IACR,KAEH,yBAAK9Q,MAAO,CAAEoR,SAAU,SACvB,EAAKvR,MAAMwR,UAEd,yBAAKxO,GAAG,SAASoK,OAAQiE,GACvB,kBAAC,KAAD,CACEI,WAAY,CAACpG,IACbhF,IAAK,EAAKrG,MAAM0R,aAChB9M,aAAc,EAAK5E,MAAM2R,YACzBC,eAAiB,EAAK5R,MAAM2R,YAC5B7E,UAAW,SAAAH,GACS,WAAdA,EAAMtG,MACRgF,GAA4BC,OAAOC,KAAKzI,SACtCuI,GAA4BC,OAAOC,KAAK9O,MAAM+J,GAC3CqL,aAAaC,gBAAcnK,OAAO0D,GAA4BC,OAAOC,KAAK9O,MAAMqK,IAAK,EAAG,KAE7F6F,EAAMC,OAAOO,SAGjB4E,SAAU,WAAa,EAAK/R,MAAM+F,eAAiB,EAAK/F,MAAM0L,qCAGlE,yBACElL,UAAU,yBACVwC,GAAG,6BACHoK,QAASiE,GACT,yBAAKlR,MAAO,CAAEM,SAAU,KACxB,yBAAKN,MAAO,CAAEC,QAAS,SACrB,yBAAKD,MAAO,CAAEM,SAAU,KAD1B,uDAGE,yBAAKN,MAAO,CAAEM,SAAU,MAE1B,yBAAKN,MAAO,CAAEM,SAAU,OAG5B,kBAAC,GAAD,Q,YAxDaiC,IAAMC,WA8DZC,gBACb,SAAAnG,GAAK,MAAK,CAAEoJ,kBAAmBpJ,EAAMoJ,kBAAmBE,cAAetJ,EAAMsJ,kBAC7E,SAAAjD,GAAQ,MAAK,CAAE4I,+BAAgC,kBAAM5I,EAAS,CAAEnE,KXvEnB,0BWqEhCiE,CAGbwO,IC5EIY,GAAgB,CACpBN,aAAc7U,EAAgBZ,GAC9B0V,YAAa,GACbM,qBAAqB,EACrBC,qBAAsB,GACtBC,2BAA4B,GAC5B3C,sBAAuB,IAGnB4C,G,4MAEJ3V,MAAQuV,G,EAERK,gCAAkC,WAClBtH,SAASC,eAjBE,qBAkBnBjG,MAAQ,EAAKtI,MAAMyV,qBACzB,EAAKzG,SAAS,CAAEwG,qBAAqB,K,EAGvCK,+BAAiC,WAC/B,EAAK7G,SAAS,CAAEwG,qBAAqB,IACrC9F,iBAAM,WACJ,IAAMH,EAAQjB,SAASC,eAzBA,qBA0BvBgB,EAAMI,QACNJ,EAAMC,kBAAkBD,EAAMjH,MAAMP,OAAQwH,EAAMjH,MAAMP,Y,EAK5D+N,iCAAmC,WACjC,IACG,EAAK9V,MAAMyV,uBACX,EAAKzV,MAAM+S,sBAAsBjT,eAAe,EAAKE,MAAM0V,4BAC1D,OAAO,EACX,IAAMK,EAAwB,eAAO,EAAK/V,MAAM+S,8BACzCgD,EAAyB,EAAK/V,MAAM0V,4BAC3CjB,GAAwB3B,2BACtB,EAAKvP,MAAM6F,kBAAkB3J,SAC7BsW,GACA/U,MAAK,SAAA0T,GACAA,EACE,EAAK1F,SAAS,CAAE+D,sBAAuBgD,IAD9BtH,MAAM,8C,EAK1BuH,gCAAkC,WAChC,IACG,EAAKhW,MAAMyV,sBACZ,EAAKzV,MAAM+S,sBAAsBjT,eAAe,EAAKE,MAAM0V,4BACzD,OAAO,EACX,IAAMK,EAAwB,eAAO,EAAK/V,MAAM+S,uBAChDgD,EAAyB,EAAK/V,MAAM0V,4BAA8B,EAAK1V,MAAMyV,qBAC7EhB,GAAwB3B,2BACtB,EAAKvP,MAAM6F,kBAAkB3J,SAC7BsW,GACA/U,MAAK,SAAA0T,GACAA,EACE,EAAK1F,SAAS,CAAE+D,sBAAuBgD,IAD9BtH,MAAM,8C,EAK1BwH,sBAAwB,WACtB,IAAI5K,EAAa,KACX6K,EAAgB5H,SAASC,eAlEN,qBAkE2CjG,MAAMlB,OAC1E,GAAI8O,KACF7K,EAAa8K,EAAgBD,IAG3B,OADAzH,MAAM,wBACC,EAGXH,SAASC,eA1EgB,qBA0EqBjG,MAAQ4N,EAClD7K,EAAc3C,aAAaa,QA7EkB,oBA6E6B2M,GACvExN,aAAac,WA9E6B,qBA+EjD,IAAM4M,EAAsBnT,KAAKC,UAAUmI,GACrCgL,EAAyB,EAAKrW,MAAM0V,2BAE1C,OADA,EAAK1G,SAAS,CAAEyG,qBAAsBS,EAAeR,2BAA4BU,IAC7EA,IAAwBC,IAC5BzH,GAA4BC,OAAOC,KAAKzI,SACtCuI,GAA4BC,OAAOC,KAAK9O,MAAM+J,GAAGuM,QAAQnL,GAAuBE,GAC7E+J,aACC/J,EACIgK,gBAAcnK,OAAO0D,GAA4BC,OAAOC,KAAK9O,MAAMqK,IAAK,EAAG,GAC3EkM,YAAUC,QAAQ5H,GAA4BC,OAAOC,KAAK9O,MAAMqK,MACpEoM,kBAEN/G,iBAAM,WACArE,EAAcuD,GAA4BC,OAAOC,KAAK4H,IAAIhG,OACvD9B,GAA4BC,OAAOC,KAAKa,aAXY,G,EAgB/DgH,W,sBAAa,4BAAAnW,EAAA,sDACXW,QAAQC,IAAI,eACPnB,EAAkB,EAAKsD,MAAM6F,oBAChCsG,iBAAM,WACJd,GAA4BC,OAAO+H,kBAGjC3B,EAAe7U,EAAgB,EAAKmD,MAAM6F,mBAChDjI,QAAQC,IAAI,EAAKmC,MAAM6F,mBACnBlJ,EAAkB,EAAKqD,MAAM6F,mBAC/BqL,GAAwB5B,mBAAmB,EAAKtP,MAAM6F,kBAAkB3J,UAAUuB,MAAK,SAAAsH,GACvE,OAAVA,GACFmG,MAAM,qCACNoG,GAA2BrV,KAE3B,EAAKwP,SAAS,CAACiG,eAAcC,YAAW,OAAE5M,QAAF,IAAEA,IAAS,KACnDmM,GAAwBxB,2BAA2B,EAAK1P,MAAM6F,kBAAkB3J,UAC3EuB,MAAK,SAAA+R,GACCA,EAGH,EAAK/D,SAAS,CAAC+D,0BAFftE,MAAM,sDAQlB,EAAKO,SAAS,CAACiG,eAAcC,YAAa,KA3BjC,2C,EA+Bb2B,kBAAoB,WAClB,EAAKF,aAAa3V,MAAK,WACrB,GAAId,EAAkB,EAAKqD,MAAM6F,mBAAoB,CACnD,IAAM0N,EAAuBpO,aAAaC,QApIG,qBAqIzCmO,IACFxI,SAASC,eApIU,qBAoI2BjG,MAAQwO,EACtD,EAAKb,8B,EAMbrG,mBAAqB,SAAAC,GAEjBA,EAAUzG,kBAAkB3J,WAAa,EAAK8D,MAAM6F,kBAAkB3J,UACtEoQ,EAAUzG,kBAAkB1J,SAAW,EAAK6D,MAAM6F,kBAAkB1J,SAEpE4O,SAASC,eAhJc,qBAgJuBjG,MAAQ,GACtD,EAAK2N,wBACL,EAAKjH,SAAS,CAAE+D,sBAAuB,KACvC,EAAK4D,e,EAITlT,OAAS,WACP,IAAMsT,EAAoB7W,EAAkB,EAAKqD,MAAM6F,mBACjD4N,EACJ,EAAKhX,MAAM+S,sBAAsBjT,eAAe,EAAKE,MAAM0V,4BAC7D,OACE,kBAAC,GAAD,CAAQT,aAAc,EAAKjV,MAAMiV,aAAcC,YAAa,EAAKlV,MAAMkV,aACrE,yBAAKnR,UAAU,YACb,4BACEA,UAAU,sBACV+L,OAAQkH,EAAyB,MAAQ,IAAM,UAC/ChH,UAAW+G,IAAsB,EAAK/W,MAAMyV,sBAAwB,EAAKzV,MAAMwV,oBAC/ExP,QACEgR,EAAyB,EAAKlB,iCAAmC,EAAKE,iCAEvEgB,EAAyB,IAAM,KAElC,4BACEjT,UAAU,sBACV+L,MAAM,SACNE,UAAW+G,GAAqB,EAAK/W,MAAMwV,oBAC3CxP,QAAS,EAAK6P,gCACb,KAEH,2BACEtP,GA/KiB,oBAgLjB4B,aAAc,EAAKnI,MAAMyV,qBACzB1F,YAAY,cACZD,MAAM,qEACNmH,KAlL0B,6BAmL1BjH,UAAW+G,IAAsB,EAAK/W,MAAMwV,oBAC5C/E,OAAQ,SAAAP,GACN,GAAI,EAAK+F,wBAA2B,EAAKjH,SAAS,CAAEwG,qBAAqB,QACpE,CACH,IAAMjG,EAAQW,EAAMC,OACpBT,iBAAM,WAAQH,EAAMI,aAGxBU,UAAW,SAAAH,GAA6B,WAAdA,EAAMtG,KAAoB,EAAKgM,mCACzD3F,WAAY,SAAAC,GAA6B,UAAdA,EAAMtG,KAAmBsG,EAAMC,OAAOO,UAEnE,8BAAUnK,GA9LkB,8BAgMxB+J,OAAOoB,QAAQ,EAAK1R,MAAM+S,uBACvBvC,KAAI,mCAAwB0F,GAAxB,kBAA2C,4BAAQtM,IAAKsM,EAAe5N,MAAO4N,QAGzF,4BACEnS,UAAU,sBACV+L,MAAM,QACNE,UAAW+G,IAAsB,EAAK/W,MAAMyV,sBAAwB,EAAKzV,MAAMwV,oBAC/ExP,QAAS,WACPsI,SAASC,eA1MM,qBA0M+BjG,MAAQ,GACtD,EAAK2N,0BAEN,a,YAjMiChQ,IAAMC,WAyMrCC,gBAAQ,SAAAnG,GAAK,MAAK,CAAEoJ,kBAAmBpJ,EAAMoJ,qBAA7CjD,CAAmEwP,I,2ZClKrEd,GAA6B,SAAAhV,GAExC,GADAsB,QAAQC,IAAIvB,IACPD,EAAkBC,GAAW,OAAO,EACzC,IAAMuJ,EAAoBsB,GAAMG,WAAWzB,kBAC3C,OAAIvJ,EAAOJ,WAAa2J,EAAkB3J,UAAYI,EAAOH,SAAW0J,EAAkB1J,UACrFgL,GAAMG,WAAWvB,gBAAiB4N,OAAOC,QAAQ,sCACpDC,aAAM,WACJ1M,GAAMrE,SbxD8B,SAAAxG,GAAM,MAAK,CAAEqC,KADV,wBACsDrC,UawD9EwX,CAA2BxX,IAC1C6K,GAAMrE,SAAS,CAAEnE,KbnD0B,wBaoD3CwI,GAAMrE,SAASwC,GAAoB,UAErCH,aAAaa,Qb3EgC,gBa2EWtG,KAAKC,UAAUrD,IACvE6I,aAAac,WDjEoC,sBCkE1C,IAKL8N,GAAyC,SAAAC,GAAc,OAAIjH,OAAOmB,YACtEnB,OAAOoB,QAAQ6F,GAAgB/G,KAAI,yCAAoB,CAApB,UAAQjO,WAGvCiV,GAAgB,SAAAlG,GAAS,OAAIhB,OAAOoB,QAAQJ,GAC/C+C,QAAO,SAACoD,EAAD,0BAAsB9F,GAAtB,UAAsBA,OAAtB,OAAmC8F,EAAQ,EAAInH,OAAOC,KAAKoB,GAAO5J,SAAQ,IAY9E2P,GACY,iBADZA,GAEU,eAFVA,GAGc,mBAHdA,GAIY,iBAGZC,IAAyB,mBAC5BD,IAAoC,iBAdF,+BAaN,cAE5BA,IAAkC,iBAdF,6BAYJ,cAG5BA,IAAsC,SAAA7X,GAAM,MAbC,iCAa6CA,EAAOJ,YAHrE,cAI5BiY,IAAoC,SAAA7X,GAAM,MAbC,+BAa2CO,EAAgBP,MAJ1E,GAOzB+X,GAAoB,CAAEC,UAAW,KAAMhY,OAAQL,GAE/C+V,GAAgB,CACpBuC,UAAW,GACXC,SAAUH,GACVtG,UAAW,GACX0G,eAAgB,KAChBC,eAAgB,KAChBC,eAAgB,KAChBC,kBAAkB,EAClBC,sBAAuB,KACvBC,gBAAgB,EAChBC,qBAAsB,MAGlBC,G,4MACJ9U,OAAS,WACP,GAAgC,IAA7B,EAAKF,MAAM1D,OAAOH,OAAa,CAChC,IAAMC,EAAW,EAAK4D,MAAM5D,SAC5B,OACE,kBAAC6Y,GAAA,EAAD,CAAOzU,UAAW,oBAAqBL,MAAQ,EAAKH,MAAMkV,SAAY,CAAChU,gBAAiB,uBAAyB,GAAKiU,UAAU,OAAOC,UAAW,GAChJ,kBAACC,GAAA,EAAD,KAEKjZ,IAAaR,EAAUG,UACxB,kBAAC,KAAD,MACCK,IAAaR,EAAUE,UACzB,kBAAC,KAAD,MACC,MAGJ,kBAACwZ,GAAA,EAAD,CACEvQ,MAAO,EAAK/E,MAAMuV,SAClB/U,UAAU,kBACViM,WAAY,EAAKzM,MAAMkV,UAAY,EAAKlV,MAAM8U,kBAEhD,kBAACU,GAAA,EAAD,CAAShV,UAAW,mBAAoBiV,YAAY,aACpD,kBAACJ,GAAA,EAAD,CAAY7U,UAAW,sBAAuBiC,QAAS,EAAKzC,MAAM0V,qBAChE,kBAAC,KAAD,CAAcC,SAAS,QAAQ7T,MAAM,eAK3C,OACE,kBAACmT,GAAA,EAAD,CAAOzU,UAAW,oBAAqBL,MAAQ,EAAKH,MAAMkV,SAAY,CAAChU,gBAAiB,UAAW0U,OAAO,sBAAwB,GAAKT,UAAU,OAAOC,UAAW,GACjK,kBAACE,GAAA,EAAD,CACEvQ,MAAO,EAAK/E,MAAMuV,SAClB/U,UAAU,kBACViM,WAAY,EAAKzM,MAAMkV,UAAY,EAAKlV,MAAM8U,kBAE/C,EAAK9U,MAAM6V,gBAAmB,EAAK7V,MAAM8V,KAAO,kBAAC,KAAD,MAAiB,kBAAC,KAAD,MAAkB,KACpF,kBAACN,GAAA,EAAD,CAAShV,UAAW,mBAAoBiV,YAAY,aACpD,kBAACJ,GAAA,EAAD,CAAY7U,UAAW,sBAAuBiC,QAAS,EAAKzC,MAAM0V,qBAChE,kBAAC,KAAD,CAAcC,SAAS,QAAQ7T,MAAM,gB,YArCtBY,IAAMC,WA6C3BoT,G,8MAEJtZ,MAAQuV,G,EAERgE,WAAa,WAAQ,EAAKvK,SAASuG,K,EAEnCiE,cAAgB,SAAA3Z,GAAM,OAAID,EAAkBC,IAAW,EAAKG,MAAMsR,UAAUxR,eAAeD,EAAOJ,UAC5F,EAAKO,MAAMsR,UAAUzR,EAAOJ,UAAU8C,KAAO,I,EAEnDkX,YAAc,SAAA5Z,GAAM,OAAIM,EAAgBN,IAAW,EAAKG,MAAMsR,UAAUxR,eAAeD,EAAOJ,WAC5F,EAAKO,MAAMsR,UAAUzR,EAAOJ,UAAUkS,MAAM7R,eAAeD,EAAOH,QAC9D,EAAKM,MAAMsR,UAAUzR,EAAOJ,UAAUkS,MAAM9R,EAAOH,QAAQ6C,KAAO,I,EAExEmX,YAAc,SAAA7Z,GAAM,OAAIM,EAAgBN,GAAU,EAAK4Z,YAAY5Z,GAAU,EAAK2Z,cAAc3Z,I,EAEhG8Z,8B,mBACGjC,GAAoC,EAAK8B,e,cACzC9B,GAAkC,EAAK+B,a,cACvC/B,GAAsC,EAAKgC,a,cAC3ChC,GAAoC,EAAKgC,a,KAG5CE,sCAAwC,SAAA3X,GACtC,OAAIA,IAAW,EAAKsB,MAAM6C,6BACtByO,GAA2BrV,KAC7B,EAAK+Z,aACL,EAAKhW,MAAMC,2CAA2CvB,IAC/C,I,EAKX4X,qBAAuB,SAAChC,EAAWhY,GACjC,IAAM0P,EAAQjB,SAASC,eAAeoJ,GAA0BE,GAAWhY,IAC3E0P,EAAMjH,MAAQ,EAAKqR,6BAA6B9B,GAAWhY,GAC3D0P,EAAMC,kBAAkB,EAAG,GAC3B,EAAKR,SAAS,CAAE+I,SAAUH,M,EAG5BkC,0BAA4B,WAC1BxL,SAASC,eA1HsB,2BA0HqBjG,MAAQ,GAC5D,EAAK0G,SAAS,CAAE8I,UAAW,M,EAG7BiC,2BAA6B,WAC3B,EAAK/K,SAAS,CAAE8I,UAAWxJ,SAASC,eA/HL,2BA+HgDjG,MAAMlB,U,EAGvF4S,wBAA0B,kBAAM1J,OAAOmB,YACrCnB,OAAOoB,QAAQ,EAAK1R,MAAMsR,WAAWd,KAAI,mCAAE/Q,EAAF,YAAoBoS,EAApB,EAActP,KAAkBoP,EAAhC,EAAgCA,MAAhC,MAA6C,CACpFlS,EACA,CACE8C,KAAMsP,EACNF,MAAO,EAAK3R,MAAM8X,UACdxH,OAAOmB,YAAYnB,OAAOoB,QAAQC,GAAOsI,QACvC,oDAAa1X,KAA+B2X,SAAS,EAAKla,MAAM8X,eAElEnG,OAELsI,QACD,iDAAqBpI,EAArB,EAAetP,KAAkBoP,EAAjC,EAAiCA,MAAjC,OAA+C,EAAK3R,MAAM8X,WACxDxH,OAAOC,KAAKoB,GAAO5J,OAAS,GAAK8J,EAAWqI,SAAS,EAAKla,MAAM8X,gB,EAItEqC,oB,uCAAsB,WAAMC,GAAN,2BAAA5Z,EAAA,yDACfrB,EAAUW,eAAesa,GADV,oDAEdC,EAAiBD,IAAajb,EAAUC,UACxCwV,EAAoB3U,EAAkB,EAAKsD,MAAM6F,qBAE9BiR,KACrBzF,GAAsBC,GAA2BrV,IANjC,wDAQd8a,EACJ,EAAK/W,MAAM6C,4BAA8B9E,EAA8BG,cAEjE4Y,EACI,EAAKra,MAAMgY,eAAezG,OAC1B,EAAKvR,MAAMgY,eAAexG,2BAA2B,EAAKjO,MAAM6F,kBAAkB3J,UAExF,KACA8a,EAAiBF,EACnB5F,GAAwB/B,oBAAoB,KAAM4H,GAA2B,GAC7E7F,GAAwB3C,eACtB,GACA,EAAKvO,MAAM6F,kBAAkB3J,SAC7B6a,EACAF,GACA,GAvBc,UAyBEG,EAzBF,WAyBdC,EAzBc,+BA2BlB/L,MAAM,6BA3BY,2BA8BdgM,EAAkBJ,EAAiBG,EAAQjU,GAAK,EAAKvG,MAAMiY,eAC3DyC,EA/Bc,2BAgCf,EAAK1a,MAAMsR,WAhCI,kBAiCjBmJ,EAAkB,CACjBlY,KAAM8X,EAAiBG,EAAQjY,KAAO,EAAKvC,MAAMsR,UAAUmJ,GAAiBlY,KAC5EoP,MAAM,eAED0I,EAKG,KALJ,2BAES,EAAKra,MAAMsR,UAAUmJ,GAAiB9I,OAF/C,kBAGO6I,EAAQjU,GAAK,CAAEhE,KAAMiY,EAAQjY,KAAML,KAAMsY,EAAQtY,YAOhE,EAAK8M,SAAS,CAAEsC,UAAWoJ,IAC3BhL,iBAAM,WACJ,IAAM7P,EAAS,CAAEJ,SAAUgb,EAAiB/a,OAAS2a,EAA8B,EAAbG,EAAQjU,IAC9EsO,GAA2BhV,MAEzB,EAAK0D,MAAM6C,4BAA8B9E,EAA8BG,gBACrE4Y,EAAkBtJ,GAA+BuG,GAAuCoD,IACrF9J,GAA6B6J,EAAiBC,EAAaD,GAAiB9I,OACnF,EAAK3C,SAAS,CACZgJ,eAAgB,CACdzG,OAAQ8I,EACJpJ,GAA+ByJ,EAAcC,SAASF,IACtD,EAAKza,MAAMgY,eAAezG,OAC9BC,2BAA2B,2BACtB,EAAKxR,MAAMgY,eAAexG,4BAE1B6I,EAKG,KALJ,eAEOI,EACCxJ,GAA+ByJ,EAAaD,GAAiB9I,MAAOgJ,SAASH,EAAQjU,WAlEnF,4C,wDA4EtBqU,iB,uCAAmB,WAAM/a,GAAN,uBAAAW,EAAA,0DACbP,EAAkBJ,GADL,oDAGfA,EAAOJ,WAAa,EAAK8D,MAAM6F,kBAAkB3J,UACjDI,EAAOH,SAAW,EAAK6D,MAAM6F,kBAAkB1J,QAC9CmV,GAA2BrV,GALb,wDAOXuX,EAAoB7W,EAAkBL,GACtCgb,EAAoB9D,EACtBtC,GAAwBtB,eACtBtT,EAAOJ,SACP6Q,OAAOC,KAAK,EAAKvQ,MAAMsR,UAAUzR,EAAOJ,UAAUkS,QAEpD8C,GAAwBvB,aAAarT,EAAOJ,SAAUI,EAAOH,QAbhD,SAcKmb,EAdL,yCAgBfpM,MAAM,yBAhBS,2BAmBXiM,EAnBW,eAmBQ,EAAK1a,MAAMsR,WAChCyF,SAA4B2D,EAAa7a,EAAOJ,kBAE5Cqb,EADH,eACwBJ,EAAa7a,EAAOJ,UAAUkS,QACnC9R,EAAOH,QAC7Bgb,EAAa7a,EAAOJ,UAAY,CAAE8C,KAAMmY,EAAa7a,EAAOJ,UAAU8C,KAAMoP,MAAOmJ,IAErF,EAAK9L,SAAS,CAAEsC,UAAWoJ,IACvB,EAAKnX,MAAM6C,4BAA8B9E,EAA8BG,gBACrEsV,GACFhG,GAA+BuG,GAAuCoD,WAChEK,EAFe,eAEqB,EAAK/a,MAAMgY,eAAexG,6BAC/B3R,EAAOJ,UAC5C,EAAKuP,SAAS,CACZgJ,eAAgB,CACdzG,OAAQ,EAAKvR,MAAMgY,eAAezG,OAClCC,2BAA4BuJ,MAGzBnK,GAA6B/Q,EAAOJ,SAAUib,EAAa7a,EAAOJ,UAAUkS,QAtCtE,4C,wDA0CnBqJ,iB,uCAAmB,WAAOnb,GAAP,yBAAAW,EAAA,0DACbP,EAAkBJ,GADL,oDAEX0P,EAAQjB,SAASC,eAAe,gBAFrB,qDAIX0M,EAAU1L,EAAMjH,MAAMlB,SACZ6T,IAAY,EAAKvB,YAAY7Z,GAL5B,wDAMXkX,EAAoB7W,EAAkBL,GACtCqb,EAAoBnE,EACtBtC,GAAwBnB,eAAezT,EAAOJ,SAAUwb,GACxDxG,GAAwBpB,aAAaxT,EAAOJ,SAAUI,EAAOH,OAAQub,GATxD,UAUKC,EAVL,0CAYfzM,MAAM,yBAZS,2BAeXiM,EAfW,eAeQ,EAAK1a,MAAMsR,WAChCyF,EACF2D,EAAa7a,EAAOJ,UAAY,CAAE8C,KAAM0Y,EAAStJ,MAAO+I,EAAa7a,EAAOJ,UAAUkS,QAEhFmJ,EADD,2BAEAJ,EAAa7a,EAAOJ,UAAUkS,OAF9B,kBAGF9R,EAAOH,OAHL,2BAGmBgb,EAAa7a,EAAOJ,UAAUkS,MAAM9R,EAAOH,SAH9D,IAGuE6C,KAAM0Y,MAElFP,EAAa7a,EAAOJ,UAAY,CAAE8C,KAAMmY,EAAa7a,EAAOJ,UAAU8C,KAAMoP,MAAOmJ,IAErF,EAAK9L,SAAS,CAAEsC,UAAWoJ,IACvB,EAAKnX,MAAM6C,4BAA8B9E,EAA8BG,gBACrEsV,EAAqBhG,GAA+BuG,GAAuCoD,IACxF9J,GAA6B/Q,EAAOJ,SAAUib,EAAa7a,EAAOJ,UAAUkS,QA5BpE,4C,wDAgCnBkF,kBAAoB,WAClBpC,GAAwB7C,iBAAiB5Q,MAAK,SAAAsQ,GACvCA,EACE,EAAKtC,SAAS,CAAEsC,cADL7C,MAAM,iCAEpB,EAAKlL,MAAM6C,4BAA8B9E,EAA8BG,eACzE,EAAKuN,SAAS,CAAEgJ,eAAgB3G,GAAoC,EAAKrR,MAAMsR,iB,EAKrF1B,mBAAqB,SAACC,EAAWsL,GAC3BtL,EAAUzJ,4BAA8B,EAAK7C,MAAM6C,2BACrDqO,GAAwB7C,iBAAiB5Q,MAAK,SAAAoa,GAAc,cAAIA,QAAJ,IAAIA,IAAkB,MAAIpa,MAAK,SAAAsQ,GACzF,EAAKtC,SAAL,2BACKuG,IADL,IAEEjE,YACA0G,eAAgB,EAAKzU,MAAM6C,4BAA8B9E,EAA8BG,cACnF4P,GAAoCC,GAAa,Y,EAM7D+J,YAAc,YAA+C,IAA5CxD,EAA2C,EAA3CA,UAAWhY,EAAgC,EAAhCA,OAAWyb,EAAqB,sCACpDC,EAAU5D,GAA0BE,GAAWhY,GAC/CyI,EAAQ,EAAKqR,6BAA6B9B,GAAWhY,GAC3D,OACE,yCACE0G,GAAIgV,EACJpT,aAAcG,EACdyH,YAAazH,EACb0H,SACE/P,EAAkBJ,IAAW,EAAKG,MAAM+X,SAASF,YAAcA,GAC/D,EAAK7X,MAAM+X,SAASlY,OAAOJ,WAAaI,EAAOJ,UAC/C,EAAKO,MAAM+X,SAASlY,OAAOH,SAAWG,EAAOH,OAE/C+Q,OAAQ,WACN,EAAKuK,iBAAiBnD,EAAWhY,GAAQmB,MAAK,WAE1C,EAAKhB,MAAM+X,SAASF,YAAcA,GAAa,EAAK7X,MAAM+X,SAASlY,OAAOJ,WAAaI,EAAOJ,UAC9F,EAAKO,MAAM+X,SAASlY,OAAOH,SAAWG,EAAOH,QAC3C,EAAKma,qBAAqBhC,EAAWhY,OAG7CwQ,UAAW,SAAAH,GAA6B,WAAdA,EAAMtG,KAAoB,EAAKiQ,qBAAqBhC,EAAWhY,IACzFoQ,WAAY,SAAAC,GAA6B,UAAdA,EAAMtG,KAAmBsG,EAAMC,OAAOO,SAC7D4K,K,EAKVE,aAAe,YAAuE,IAApE3b,EAAmE,EAAnEA,OAAQ4Y,EAA2D,EAA3DA,SAAUY,EAAiD,EAAjDA,KAAMJ,EAA2C,EAA3CA,oBAAqBG,EAAsB,EAAtBA,gBA0BvDqC,EAzBYC,cAAW,SAACC,GAAD,MAAY,CACvCC,KAAM,CACJC,QAAS,UACTlY,QAAS,OACTmB,WAAY,SACZP,MAAO,KAETuX,SAAU,CACRD,QAAS,UACTlY,QAAS,OACTmB,WAAY,SACZP,MAAO,KAETgL,MAAO,CACLtK,WAAY0W,EAAM9W,QAAQ,GAC1BH,KAAM,GAERqX,WAAY,CACVF,QAAS,GAEXG,QAAS,CACPnY,OAAQ,GACRoY,OAAQ,MAGIC,GACVpD,EAAW,EAAKY,YAAY7Z,GAClC,GAAqB,IAAlBA,EAAOH,OAAa,CACrB,IAAMC,EAAW,EAAKK,MAAMsR,UAAUzR,EAAOJ,UAAUkS,MAAM9R,EAAOH,QAAQwC,KAC5E,OACE,kBAACsW,GAAA,EAAD,CAAOzU,UAAW0X,EAAQK,SAAUpY,MAAQ+U,EAAY,CAAChU,gBAAiB,uBAAyB,GAAKiU,UAAU,OAAOC,UAAW,GAClI,kBAACC,GAAA,EAAD,KAEKjZ,IAAaR,EAAUG,UACxB,kBAAC,KAAD,MACCK,IAAaR,EAAUE,UACzB,kBAAC,KAAD,MACC,MAGJ,kBAACwZ,GAAA,EAAD,CACEvQ,MAAOwQ,EACP/U,UAAU,kBACViM,WAAYyI,GAAY,EAAKzY,MAAMqY,kBAErC,kBAACU,GAAA,EAAD,CAAShV,UAAW0X,EAAQO,QAAShD,YAAY,aACjD,kBAACJ,GAAA,EAAD,CAAY7U,UAAW0X,EAAQM,WAAY/V,QAASiT,GAClD,kBAAC,KAAD,CAAcC,SAAS,QAAQ7T,MAAM,eAK3C,OACE,kBAACmT,GAAA,EAAD,CAAOzU,UAAW0X,EAAQG,KAAMlY,MAAQ+U,EAAY,CAAChU,gBAAiB,UAAW0U,OAAO,sBAAwB,GAAKT,UAAU,OAAOC,UAAW,GAC/I,kBAACE,GAAA,EAAD,CACEvQ,MAAOwQ,EACP/U,UAAU,kBACViM,WAAYyI,GAAY,EAAKzY,MAAMqY,kBAEpCe,EAAmBC,EAAO,kBAAC,KAAD,MAAiB,kBAAC,KAAD,MAAkB,KAC9D,kBAACN,GAAA,EAAD,CAAShV,UAAW0X,EAAQO,QAAShD,YAAY,aACjD,kBAACJ,GAAA,EAAD,CAAY7U,UAAW0X,EAAQM,WAAY/V,QAASiT,GAClD,kBAAC,KAAD,CAAcC,SAAS,QAAQ7T,MAAM,gB,EAO/C8W,oBAAsB,SAACtc,GACjBA,IAAW,EAAKG,MAAMiY,eACxB,EAAKjJ,SAAS,CACZkJ,eAAgB,KAChBC,kBAAoB,EAAKnY,MAAMmY,mBAG9BtD,GAA2B,CAAEpV,SAASI,EAAQH,OAAQ,KACvD,EAAKsP,SAAS,CACZiJ,eAAgBpY,EAChBqY,eAAgB,KAChBC,kBAAkB,K,EAO1BiE,oBAAsB,SAACvc,GACrBgV,GAA2BhV,GAC3B,EAAKmP,SAAS,CACZkJ,eAAgBrY,EAAOH,U,EAI3BuZ,oBAAsB,SAAC/I,GACrB,EAAKlB,SAAS,CACZoJ,sBAAuBlI,EAAMmM,iB,EAIjCC,oBAAsB,WACpB,EAAKtN,SAAS,CACZoJ,sBAAuB,Q,EAI3BmE,sBAAwB,WACtB,EAAKD,sBACL,IAAMzc,EAAS,CAAEJ,SAAU,EAAKO,MAAMiY,eAAgBvY,OAAuC,OAA9B,EAAKM,MAAMkY,eAA2B,EAAI,EAAKlY,MAAMkY,gBACpH,EAAK0C,iBAAiB/a,GAAQmB,MAAK,SAAA0T,GACX,IAAlB7U,EAAOH,OACT,EAAKsP,SAAS,CACZkJ,eAAgB,OAGlB,EAAKlJ,SAAS,CACZiJ,eAAgB,KAChBC,eAAgB,KAChBC,kBAAkB,Q,EAM1BqE,sBAAwB,SAACtM,GACvB,EAAKlB,SAAS,CACZyN,qBAAsB,EAAKzc,MAAMoY,sBACjCA,sBAAuB,Q,EAI3BsE,yBAA2B,WACzB,EAAK1N,SAAS,CACZyN,qBAAsB,Q,EAI1BE,mBAAqB,SAACzM,GACpB,EAAKlB,SAAS,CACZsJ,qBAAuB,EAAKtY,MAAMoY,yB,EAItCwE,oBAAsB,WACpB,EAAK5N,SAAS,CACZsJ,qBAAuB,KACvBF,sBAAuB,Q,EAI3B3U,OAAS,WACmBxD,EAAkB,EAAKsD,MAAM6F,mBAGjC,EAAK7F,MAAM6F,kBAAkB3J,SAIzC,EAAK8D,MAAM6F,kBAPrB,IASMyT,EAAWrF,GAAc,EAAKxX,MAAMsR,WACpCwL,EAAoB,EAAK9c,MAAM8X,UAAY,EAAKkC,0BAA4B,EAAKha,MAAMsR,UACvFyL,EAAmBvF,GAAcsF,GACvC,OACE,yBAAK/Y,UAAU,YACoB,OAA9B,EAAK/D,MAAMiY,eAA2B,KACnC,6BACE,yBAAK1R,GAAG,0BACN,kBAAC5B,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAGC,WAAW,UACrC,kBAACH,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,GACf,kBAAC4T,GAAA,EAAD,KACA,kBAAC,KAAD,QAGA,kBAACjU,EAAA,EAAD,CAAMI,MAAI,EAACC,GAAI,GACb,kBAACE,EAAA,EAAD,CAAYC,QAAQ,KAAKE,MAAM,UAAUkB,GA1gB1B,6BA2gBV,EAAKmT,YAAY,CAACja,SAAU,EAAKO,MAAMiY,eAAgBvY,OAAQ,QAK1E,kBAACqZ,GAAA,EAAD,CAAS5T,QAAQ,YAGzB,yBAAKoB,GAAG,uBACJ,kBAACR,EAAA,EAAD,CACEZ,QAAQ,WACRE,MAAM,UACN2X,QAAS,kBAAC,KAAD,MACTC,kBAAgB,EAChB1W,GAAG,sBACHP,QAAS,WAAQ,EAAKmU,oBAAoBhb,EAAUC,UANtD,gBAUF,yBAAK2E,UAAU,WAAWwC,GAAG,+BAC3B,kBAAC2W,GAAA,EAAD,CACE/X,QAAQ,WACRoB,GAniBqB,0BAoiBrB4W,eACE,kBAACC,GAAA,EAAD,CAAgBlZ,SAAS,SACvB,kBAAC,KAAD,OAGJR,MAAO,CAAC,MAAQ,QAChBoM,MAAM,oBACNC,YAAY,oBACZuF,SAAU+H,mBAAS,EAAKtD,2BAA4B,KACpD9J,WAAY,SAAAC,GAA6B,UAAdA,EAAMtG,KAAmBsG,EAAMC,OAAOO,QACjEL,UAAW,SAAAH,GAA6B,WAAdA,EAAMtG,KAAoBsG,EAAMC,OAAOO,WAInEJ,OAAOC,KAAKuM,GAAmB/U,OAAS,EACnC,kBAACuV,GAAA,EAAD,CACG5E,UAAU,MACV6E,kBAAgB,wBAChBC,UACE,kBAACC,GAAA,EAAD,CAAe/E,UAAU,MAAMnS,GAAG,yBAAlC,gBAIFA,GA7jBC,YA8jBD7C,MAAO,CAAC,SAAa,IAAK,MAAU,SAGpC4M,OAAOoB,QAAQoL,GAAmBtM,KAAI,mCAAE/Q,EAAF,KAAckS,EAAd,KAAcA,MAAd,OACtC,6BACE,kBAAC+L,GAAA,EAAD,CAAUC,QAAM,EAChB/T,IAAKnK,EACLme,gBAAgB,EAChB5B,SAAS,EACTvD,UAAU,EACV/U,MAAO,CAAC,QAAU,OAClBsC,QAAS,WAAO,EAAKmW,oBAAoB1c,KAEvC,kBAAC,GAAD,aACEI,OAAQ,CAAEJ,WAAUC,OAAQ,GAC5B+Y,SAAUhZ,IAAa,EAAKO,MAAMiY,eAClCoB,KAAM5Z,IAAa,EAAKO,MAAMiY,gBAAkB,EAAKjY,MAAMmY,iBAC3Dc,oBAAqB,EAAKA,oBAC1BG,gBAAiB9I,OAAOC,KAAKoB,GAAO5J,OAAS,EAC7C+Q,SAAU,EAAKY,YAAY,CAAEja,WAAUC,OAAQ,IAC/C2Y,eAAgB,EAAKrY,MAAMqY,gBAP7B,sBAQuB,EAAKY,uBAI1B3I,OAAOC,KAAKoB,GAAO5J,OAAS,EACxB,kBAAC8V,GAAA,EAAD,CAAUC,GAAIre,IAAa,EAAKO,MAAMiY,gBAAkB,EAAKjY,MAAMmY,iBAAkB4F,QAAQ,OAAOC,eAAa,GAC/G,kBAACV,GAAA,EAAD,CAAM5E,UAAU,MAAMuF,gBAAc,EAACva,MAAO,CAAC,YAAe,yBAA0B,YAAe,UAAW,YAAe,OAAQ,aAAgB,QAErJ4M,OAAOC,KAAKoB,GAAOnB,KAAI,SAAA9Q,GACrB,IAAMG,EAAS,CAAEJ,WAAUC,SAAQ,SAAYiS,EAAMjS,GAAQwC,MAC7D,OACE,kBAACwb,GAAA,EAAD,CAAUC,QAAM,EAChB/T,IAAKxJ,EAAgBP,GACrB+d,gBAAgB,EAChB5B,SAAS,EACTvD,UAAU,EACV/U,MAAO,CAAE,WAAc,MAAO,cAAiB,MAAO,gBAAmB,eACzEsC,QAAS,WAAO,EAAKoW,oBAAoBvc,KAEzC,kBAAC,GAAD,aACIA,OAAQA,EACRwZ,KAAM3Z,IAAW,EAAKM,MAAMkY,eAC5Be,oBAAqB,EAAKA,oBAC1BH,SAAU,EAAKY,YAAY7Z,GAC3BF,SAAUgS,EAAMjS,GAAQwC,KACxBmW,eAAgB,EAAKrY,MAAMqY,eAC3BI,SAAU/Y,IAAW,EAAKM,MAAMkY,gBAPpC,sBAQyB,EAAKe,4BAQtC,UAMd,yBAAKlV,UAAU,yBAAyBwC,GAAG,wBAA3C,YAIN,kBAAC2X,GAAA,EAAD,CACE3X,GAAG,YACH4X,SAAU,EAAKne,MAAMoY,sBACrBgG,aAAW,EACX/E,KAAMgF,QAAQ,EAAKre,MAAMoY,uBACzBkG,QAAS,kBAAM,EAAKhC,uBACpBiC,aAAc,CACZC,SAAU,SACVC,WAAY,UAEdC,gBAAiB,CACfF,SAAU,MACVC,WAAY,UAImB,OAA9B,EAAKze,MAAMkY,eACZ,kBAACyG,GAAA,EAAD,CAAU3Y,QAAS,kBAAM,EAAK2W,uBAC5B,kBAACiC,GAAA,EAAD,KACE,kBAAC,KAAD,CAAS1F,SAAS,WAEpB,kBAAC2F,GAAA,EAAD,CAAcC,QAAQ,cAEtB,KAEF,kBAACH,GAAA,EAAD,CAAU3Y,QAAS,kBAAM,EAAKwW,0BAC5B,kBAACoC,GAAA,EAAD,KACE,kBAAC,KAAD,CAAU1F,SAAS,WAErB,kBAAC2F,GAAA,EAAD,CAAcC,QAAQ,YAExB,kBAACH,GAAA,EAAD,CAAU3Y,QAAS,kBAAM,EAAKuW,0BAC5B,kBAACqC,GAAA,EAAD,KACE,kBAAC,KAAD,CAAY1F,SAAS,WAEvB,kBAAC2F,GAAA,EAAD,CAAcC,QAAQ,aAG5B,kBAACZ,GAAA,EAAD,CACE3X,GAAG,WACH4X,SAAU,EAAKne,MAAMsY,qBACrB8F,aAAW,EACX/E,KAAMgF,QAAQ,EAAKre,MAAMsY,sBACzBgG,QAAS,kBAAM,EAAK1B,uBACpB2B,aAAc,CACZC,SAAU,SACVC,WAAY,UAEdC,gBAAiB,CACfF,SAAU,MACVC,WAAY,SAGZ,kBAACE,GAAA,EAAD,CACI3Y,QAAS,WACP,EAAK4W,sBACL,EAAKzC,oBAAoBhb,EAAUE,aAEvC,kBAACuf,GAAA,EAAD,KACE,kBAAC,KAAD,CAAgB1F,SAAS,WAE3B,kBAAC2F,GAAA,EAAD,CAAcC,QAAQ,eAExB,kBAACH,GAAA,EAAD,CACA3Y,QAAS,WACP,EAAK4W,sBACL,EAAKzC,oBAAoBhb,EAAUG,aAEnC,kBAACsf,GAAA,EAAD,KACE,kBAAC,KAAD,CAAgB1F,SAAS,WAE3B,kBAAC2F,GAAA,EAAD,CAAcC,QAAQ,gBAG5B,kBAACC,GAAA,EAAD,CACE1F,KAAMgF,QAAQ,EAAKre,MAAMyc,sBACzB0B,SAAU,EAAKne,MAAMyc,qBACrB8B,aAAc,CACZC,SAAS,MACTC,WAAY,SAEdC,gBAAiB,CACfF,SAAS,MACTC,WAAY,SAEdlY,GAAG,kBAEH,kBAAC2W,GAAA,EAAD,CACE3W,GAAG,eACH4B,aAAc,EAAKuR,YAAY,CAACja,SAAU,EAAKO,MAAMiY,eAAgBvY,OAAsC,MAA7B,EAAKM,MAAMkY,eAA0B,EAAI,EAAKlY,MAAMkY,iBAClIjI,WAAY,SAAAC,GACO,UAAdA,EAAMtG,MACL,EAAKoR,iBAAiB,CAACvb,SAAU,EAAKO,MAAMiY,eAAgBvY,OAAsC,MAA7B,EAAKM,MAAMkY,eAA0B,EAAI,EAAKlY,MAAMkY,iBACzH,EAAKwE,6BAGXrM,UAAW,SAAAH,GACQ,WAAdA,EAAMtG,KACL,EAAK8S,4BAGXsC,aACE,kBAAC5B,GAAA,EAAD,CAAgBlZ,SAAS,OACvB,kBAAC0U,GAAA,EAAD,CACE5S,QAAU,WACR,EAAKgV,iBAAiB,CAACvb,SAAU,EAAKO,MAAMiY,eAAgBvY,OAAsC,MAA7B,EAAKM,MAAMkY,eAA0B,EAAI,EAAKlY,MAAMkY,iBACzH,EAAKwE,6BAGL,kBAAC,KAAD,QAIRuC,kBAAkB,EAClBC,WAAW,EACXxb,MAAO,CAACG,OAAO,OAAQ,YAAe,WAG1C,yBACEE,UAAU,yBACVwC,GAAG,6BACHoK,QAAS,EAAK3Q,MAAM8X,WAClB+E,EAAWE,EAAoB,OAAUF,EAAY,4BAG3D,yBAAKtW,GAAG,2BAEJ,EAAKhD,MAAM6C,4BAA8B9E,EAA8BC,eACnE,kBAACwE,EAAA,EAAD,CACEZ,QAAQ,WACRa,QAAS,WAEL,EAAKzC,MAAMC,2CACTlC,EAA8BE,kBAE9BI,IAAQud,OjBv1BO,kBiBg1BvB,YAWA,KAEN,kBAACpZ,EAAA,EAAD,CACEZ,QAAQ,WACRa,QAAS,WACH,EAAKzC,MAAM6C,4BAA8B9E,EAA8BG,cACzEC,IAAwBV,MAAK,SAAAoF,GAC3B,EAAKwT,sCAAsCxT,MAEtC,EAAKwT,sCAAsCtY,EAA8BG,iBAGlF,cAEE,EAAK8B,MAAM6C,4BAA8B9E,EAA8BG,cACnE,QAAU,SACZ,e,YAvsBMwE,IAAMC,WAgtBfC,gBACb,SAAAnG,GAAK,MAAK,CACRoJ,kBAAmBpJ,EAAMoJ,kBACzBhD,0BAA2BpG,EAAMoG,8BAEnC,SAAAC,GAAQ,MAAK,CACX7C,2CAA4C,SAAA8C,GAAI,OAAID,EAASrE,EAAmCsE,QANrFH,CAQbmT,I,0FC10Ba8F,G,kDAxDd,WAAY7b,GAAQ,IAAD,8BAClB,cAAMA,IAuCPE,OAAS,WACR,IAAMwJ,EAAU,EAAK1J,MAAM0J,QAC3B,QAAgBtG,IAAZsG,EAAuB,CAC1B,IAAMrD,EAAMqD,EAAO,MACboS,EAAQpS,EAAO,MACfqS,EAAOrS,EAAO,KACpB,OACC,kBAAC,KAAD,CAAesS,UAAW,EAAKvf,MAAMuf,UAAWC,cAAc,YAC5D,EAAKC,oBAAoB7V,EAAKyV,GAC9B,EAAKI,oBAAoB7V,EAAK0V,IAGzB,OAAO,MAlDhBne,QAAQC,IAAI,EAAKmC,MAAM0J,SACvB,EAAKjN,MAAQ,CACZuf,WAAW,EACX3V,IAAK,EAAKrG,MAAM0J,QAAX,MACLoS,MAAO,EAAK9b,MAAM0J,QAAX,MACPqS,KAAM,EAAK/b,MAAM0J,QAAX,MAEP,EAAKyS,YAAc,EAAKA,YAAYC,KAAjB,iBACnB,EAAKF,oBAAsB,EAAKA,oBAAoBE,KAAzB,iBAVT,E,yDAaPpX,GACXA,EAAE6H,iBACFwP,KAAK5Q,UAAS,SAAAmM,GAAS,MAAK,CAAEoE,WAAYpE,EAAUoE,gB,0CAGjC3V,EAAK4J,GACxB,OACC,kBAAC,KAAD,CACC5J,IAAKA,EACLtE,KAAK,QACLvB,UAAU,gBACViC,QAAS4Z,KAAKF,aAGblM,GACA,kBAAC,KAAD,CACCzP,UAAU,OACV8b,UAAU,EACVjW,IAAG,cAASA,GACZzB,aAAclF,KAAKC,UAAUsQ,GAC7B2B,cAAc,S,GAlCDlP,IAAMC,W,2iCCDnB4Z,G,4MACLrc,OAAS,WACR,IAAMsc,EAAYC,WAAOC,IAAV,MAKM,SAAA1c,GAAK,OAAKA,EAAM2c,WAAa,aAAe,WAE3DC,EAAQH,WAAOI,GAAV,MACLC,EAAUL,WAAOC,IAAV,MACb,OACC,kBAAC,KAAD,CAAWK,YAAa,EAAK/c,MAAMkP,MAAO8N,MAAO,EAAKhd,MAAMgd,QAC1D,SAACC,EAAUC,GAAX,OACA,kBAACV,EAAD,eACCW,IAAKF,EAASG,UACVH,EAASI,eACTJ,EAASK,gBAHd,CAICX,WAAYO,EAASP,aAErB,kBAACC,EAAD,KAAQ,EAAK5c,MAAMud,QAAX,UACR,kBAACT,EAAD,KAAU,EAAK9c,MAAMud,QAAQC,c,YArBjB9a,IAAMC,WA6BlB8a,G,qLAEiBC,EAAWC,EAAWC,GAC3C,OAAOF,EAAUG,UAAYxB,KAAKrc,MAAM6d,U,+BAG/B,IAAD,OACR,OAAO9Q,OAAOC,KAAKqP,KAAKrc,MAAM6d,SAAS5Q,KAAI,SAACiC,EAAO8N,GAAR,OAC1C,kBAAC,GAAD,CAAK3W,IAAK6I,EAAOA,MAAOA,EAAO8N,MAAOA,EAAOO,QAAS,EAAKvd,MAAM6d,QAAQ3O,Y,GARjDxM,IAAMC,WA8ElBmb,G,kDAhEd,WAAY9d,GAAQ,IAAD,8BAClB,cAAMA,IAiBPE,OAAS,WACR,IAAMsc,EAAYC,WAAOC,IAAV,MAOM,SAAA1c,GAAK,OAAKA,EAAM+d,eAAkB,UAAY,WAE7DC,EAAQvB,WAAOwB,GAAV,MAGLC,EAAkBzB,WAAOC,IAAV,MAGfyB,EAAU1B,WAAOC,IAAV,MAOb,OACC,kBAAC,KAAD,CAAW0B,YAAa,EAAKpe,MAAMqe,OAAOrb,KACxC,SAACia,EAAUC,GACX,OACC,kBAACV,EAAD,CAAWuB,eAAgBb,EAASa,gBACnC,kBAACC,EAAD,KAAQ,EAAKhe,MAAMqe,OAAO9R,OACzB,kBAAC2R,EAAD,eACCf,IAAKF,EAASG,UACVH,EAASqB,gBAEb,kBAACH,EAAD,CAAShB,IAAK,EAAKoB,YAClB,kBAAC,GAAD,CAAcV,QAAS,EAAK7d,MAAM6d,UACjCZ,EAASzQ,mBAlDlB,EAAK+R,WAAa7b,IAAM8b,YAHN,E,qEAMKlS,EAAWsL,GAClC,IAAMlE,EAAO2I,KAAKkC,WAAWE,QAC7B,OAAO/K,EAAKgL,aAAehL,EAAKiL,Y,yCAGdrS,EAAWsL,EAAWsF,GACxC,GAAiB,OAAbA,EAAmB,CACtB,IAAMxJ,EAAO2I,KAAKkC,WAAWE,QAC7B/K,EAAKiL,UAAYjL,EAAKgL,aAAexB,O,GAfXxa,IAAMC,WCrC7Bic,G,kDACL,WAAY5e,GAAQ,IAAD,uBAClB,cAAMA,IA8CP6e,UAAY,SAAAC,GAAW,IACdC,EAAqCD,EAArCC,YAAa/Q,EAAwB8Q,EAAxB9Q,OAAQ+O,EAAgB+B,EAAhB/B,YAC7B,GAAKgC,IACDA,EAAYX,cAAgBpQ,EAAOoQ,aAAeW,EAAY/B,QAAUhP,EAAOgP,OAAnF,CAEA,IAAInW,EAAW,GACf,GAAIkY,EAAYX,cAAgBpQ,EAAOoQ,YAAa,CACnD,IAAMC,EAAS,EAAK5hB,MAAMuiB,QAAQhR,EAAOoQ,aACnCa,EAAY5W,MAAMyB,KAAKuU,EAAOa,QACpCD,EAAUE,OAAOnR,EAAOgP,MAAO,GAC/BiC,EAAUE,OAAOJ,EAAY/B,MAAO,EAAGD,GAEvC,IAAMqC,EAAS,2BACXf,GADW,IAEda,OAAQD,IAGTpY,EAAQ,2BACJ,EAAKpK,OADD,IAEPuiB,QAAQ,2BACJ,EAAKviB,MAAMuiB,SADR,kBAELI,EAAUpc,GAAKoc,UAGZ,CAAC,IAAD,EACAC,EAAQ,EAAK5iB,MAAMuiB,QAAQhR,EAAOoQ,aAClCkB,EAAS,EAAK7iB,MAAMuiB,QAAQD,EAAYX,aACxCmB,EAAclX,MAAMyB,KAAKuV,EAAMH,QACrCK,EAAYJ,OAAOnR,EAAOgP,MAAO,GACjC,IAAMwC,EAAQ,2BACVH,GADU,IAEbH,OAAQK,IAGHE,EAAepX,MAAMyB,KAAKwV,EAAOJ,QACvCO,EAAaN,OAAOJ,EAAY/B,MAAO,EAAGD,GAC1C,IAAM2C,EAAS,2BACXJ,GADW,IAEdJ,OAAQO,IAGT5Y,EAAQ,2BACJ,EAAKpK,OADD,IAEPuiB,QAAQ,2BACJ,EAAKviB,MAAMuiB,SADR,uBAELQ,EAASxc,GAAKwc,GAFT,cAGLE,EAAU1c,GAAK0c,GAHV,MAOT,EAAK1f,MAAM2f,cAAc9Y,EAASmY,QAAQY,aAAaV,QACvD,EAAKzT,SAAS5E,KAlGI,EAgHnB3G,OAAS,WACR,OACC,kBAAC,KAAD,CAAiB2e,UAAW,EAAKA,WAChC,kBAAC,KAAD,KACC,kBAACgB,GAAA,EAAD,CAAKrf,UAAU,6BACb,EAAK/D,MAAMqjB,YAAY7S,KAAI,SAAA8S,GAC3B,IADuC,EACjC1B,EAAS,EAAK5hB,MAAMuiB,QAAQe,GAE9BC,EAAkB,GAHiB,eAInB3B,EAAOa,QAJY,IAIvC,2BAAmC,CAAC,IAAzBhQ,EAAwB,QAClC8Q,EAAgB9Q,GAAS,EAAKzS,MAAMohB,QAAQ3O,IALN,8BAOvC,OACC,kBAAC+Q,GAAA,EAAD,CAAK5Z,IAAKgY,EAAOrb,GAAIkd,GAAG,KAAKC,GAAG,KAC/B,kBAAC,GAAD,CAAgB9Z,IAAKgY,EAAOrb,GAAIqb,OAAQA,EAAQR,QAASmC,YA5HhE,IAAMva,EAAa,IAAI2a,IAAI,EAAKpgB,MAAMyF,YAChC4a,EAAgBtT,OAAOC,KAAK,EAAKhN,MAAMsgB,aAAa5J,QAAO,SAAA6J,GAAC,OAAK9a,EAAW+a,IAAID,MAgBtF,IAAM1C,EAAU,EAAK7d,MAAMsgB,YAnBT,OAoBlBvT,OAAOC,KAAK6Q,GAAS4C,SAAQ,SAAAvR,GAC5B,IAAMsO,EAfP,SAASkD,EAAW1Z,GACnB,IAAK,IAAI0B,EAAI,EAAGA,EAAI1B,EAAK0C,QAAQlF,SAAUkE,EAAG,CAC7C,IAAMiY,EAAc3Z,EAAK0C,QAAQhB,GACjC,GAAyB,SAArBiY,EAAYhiB,KACf,OAAOgiB,EAAY5e,KACb,GAAI4e,EAAa,CACvB,IAAMC,EAAkBF,EAAWC,GACnC,GAAwB,KAApBC,EAAwB,OAAOA,GAGrC,MAAO,GAKSF,CAAW7C,EAAQ3O,GAAOxF,SAE1CmU,EAAQ3O,GAAR,QAA4BsO,EAAQqD,UAAU,EADrB,IAErBrD,EAAQhZ,OAFa,KAGxBqZ,EAAQ3O,GAAR,SAA6B,aAI/B,EAAKzS,MAAQ,CACZohB,QAASA,EACTmB,QAAS,CACRY,aAAc,CACb5c,GAAI,eACJuJ,MAAO,eACP2S,OAAQ,EAAKlf,MAAMyF,YAEpBqb,eAAgB,CACf9d,GAAI,iBACJuJ,MAAO,iBACP2S,OAAQmB,IAGVP,YAAa,CAAC,eAAgB,mBA3Cb,E,gEAqGAxT,EAAWsL,EAAWsF,GACxC,GAAI5Q,EAAU7G,aAAe4W,KAAKrc,MAAMyF,WAAY,CACnD,IAAMA,EAAa,IAAI2a,IAAI/D,KAAKrc,MAAMyF,YAChC4a,EAAgBtT,OAAOC,KAAKqP,KAAKrc,MAAMsgB,aAAa5J,QAAO,SAAA6J,GAAC,OAAK9a,EAAW+a,IAAID,MAChF1Z,EAAWkG,OAAOgU,OAAO,GAAI1E,KAAK5f,OACxCoK,EAASmY,QAAQY,aAAaV,OAASzZ,EACvCoB,EAASmY,QAAQ8B,eAAe5B,OAASmB,EACzChE,KAAK5Q,SAAS5E,Q,GA7GOnE,IAAMC,WA0IfC,gBACd,SAAAnG,GAAK,MAAK,CAAEgJ,WAAYhJ,EAAMgJ,eAC9B,SAAA3C,GAAQ,MAAK,CAAE6c,cAAe,SAAAla,GAAU,OAAI3C,EAAS0C,GAAoBC,QAF3D7C,CAGbgc,ICxIIoC,G,kDAEL,WAAYhhB,GAAQ,IAAD,8BAClB,cAAMA,IAOPihB,eAAiB,SAACtU,IACZgH,OAAOuN,UAAUC,SAASnZ,MAAM,OAAS2E,EAAMyU,QAAUzU,EAAM0U,UAA+B,KAAlB1U,EAAM2U,UACtF3U,EAAME,iBACNqE,GAAwB3C,eACvB,EAAKvO,MAAMyF,WACX,EAAKzF,MAAM6F,kBAAkB3J,SAC7B,EAAK8D,MAAM6F,kBAAkB1J,OAC7BP,EAAUG,WACV,GAEC0B,MAAK,kBAAMyN,MAAM,sBACjBqW,OAAM,kBAAMrW,MAAM,iCAnBH,EAuBnBsW,aAAe,SAACtS,GAEf,MAAO,CACN,KAAQ,MACR,QAAW,CAHC,EAAKzS,MAAM6jB,YAAYpR,GAAvB,WAxBK,EA+BnBuS,cAAgB,SAACzE,GAChB,IAAM0E,EAAc,CAAE,MAAS1E,GAK/B,OAJA0E,EAAW,MAAY,EAAKF,aAAa,EAAKxhB,MAAMyF,WAAWuX,IAC3DA,EAAQ,EAAI,EAAKhd,MAAMyF,WAAWjB,OACrCkd,EAAW,KAAW,EAAKF,aAAa,EAAKxhB,MAAMyF,WAAWuX,EAAM,IAC5D0E,EAAW,KAAW,KACxB,kBAAC,GAAD,CAAMhY,QAASgY,KArCJ,EAwCnBpO,kBAAoB,WACnBvI,SAAS4W,iBAAiB,UAAU,EAAKV,iBAzCvB,EA2CnB5U,mBAAqB,SAAAC,GAChBA,EAAU7G,aAAe,EAAKzF,MAAMyF,YACvC,EAAKzF,MAAM2f,cAAc,EAAK3f,MAAMyF,aA7CnB,EAgDnBmc,qBAAuB,WAAQ7W,SAAS8W,oBAAoB,UAAU,EAAKZ,iBAhDxD,EAkDnB/gB,OAAS,WACR,GAAK,EAAKzD,MAAM6jB,aAAwC,MAAzB,EAAKtgB,MAAMyF,WAMnC,CAEN,IADA,IAAMqc,EAAQ,GACLpZ,EAAI,EAAGA,EAAI,EAAK1I,MAAMyF,WAAWjB,OAAQkE,GAAG,EACpDoZ,EAAMva,KACL,kBAACsY,GAAA,EAAD,CAAKxZ,IAAG,cAASqC,EAAE,GAAKlI,UAAU,6BACjC,kBAACyf,GAAA,EAAD,CAAKE,GAAG,KAAK4B,GAAG,KACd,EAAKN,cAAc/Y,IAErB,kBAACuX,GAAA,EAAD,CAAKE,GAAG,KAAK4B,GAAG,KACbrZ,EAAI,EAAI,EAAK1I,MAAMyF,WAAWjB,QAAW,EAAKid,cAAc/Y,EAAI,MAKtE,OACC,kBAAC,KAAD,CAAWlI,UAAU,iBACpB,kBAAC,GAAD,CAAW8f,YAAa,EAAK7jB,MAAM6jB,YAAa7a,WAAY,EAAKzF,MAAMyF,aACtEqc,GAtBH,OACC,kBAAC,KAAD,CAAWthB,UAAU,iBACpB,uDApDH,EAAK/D,MAAQ,CACZ6jB,YAAatgB,EAAMgiB,KAAK1B,aAEzB,EAAKtgB,MAAM2f,cAAc3f,EAAMgiB,KAAKvc,YALlB,E,UAFG/C,IAAMC,WAmFdC,gBACd,SAAAnG,GAAK,MAAK,CAAEgJ,WAAYhJ,EAAMgJ,WAAYI,kBAAmBpJ,EAAMoJ,sBACnE,SAAA/C,GAAQ,MAAK,CAAE6c,cAAe,SAAAla,GAAU,OAAI3C,EAAS0C,GAAoBC,QAF3D7C,CAGboe,ICxFIiB,I,yDAEL,WAAYjiB,GAAQ,IAAD,8BAClB,cAAMA,IAOPihB,eAAiB,SAACtU,IACZgH,OAAOuN,UAAUC,SAASnZ,MAAM,OAAS2E,EAAMyU,QAAUzU,EAAM0U,UAA+B,KAAlB1U,EAAM2U,UACtF3U,EAAME,iBACNqE,GAAwB3C,eACvB,EAAKvO,MAAMyF,WACX,EAAKzF,MAAM6F,kBAAkB3J,SAC7B,EAAK8D,MAAM6F,kBAAkB1J,OAC7BP,EAAUE,WACV,GAEC2B,MAAK,kBAAMyN,MAAM,sBACjBqW,OAAM,kBAAMrW,MAAM,iCAnBH,EAuBnBgX,kBAAoB,WACnB,MAAO,CACN,KAAQ,MACR,QAAW,EAAKliB,MAAMyF,WAAWwH,KAAI,SAAAsT,GAAC,OAAI,EAAK9jB,MAAM6jB,YAAYC,GAAvB,aA1BzB,EA8BnBjN,kBAAoB,WACnBvI,SAAS4W,iBAAiB,UAAU,EAAKV,iBA/BvB,EAiCnB5U,mBAAqB,SAAAC,GAChBA,EAAU7G,aAAe,EAAKzF,MAAMyF,YACvC,EAAKzF,MAAM2f,cAAc,EAAK3f,MAAMyF,aAnCnB,EAsCnBmc,qBAAuB,WAAQ7W,SAAS8W,oBAAoB,UAAU,EAAKZ,iBAtCxD,EAwCnB/gB,OAAS,WACR,OAAK,EAAKzD,MAAM6jB,aAAwC,MAAzB,EAAKtgB,MAAMyF,WAQxC,kBAAC,KAAD,CAAWjF,UAAU,iBACpB,kBAAC,GAAD,CAAW8f,YAAa,EAAK7jB,MAAM6jB,YAAa7a,WAAY,EAAKzF,MAAMyF,aAEtE,EAAKzF,MAAMyF,WAAWjB,OAAS,GAC/B,kBAAC,KAAD,CACChE,UAAU,iBACV8b,UAAU,EACVjW,IAAK,YACLzB,aAAclF,KAAKC,UAAU,EAAKuiB,qBAClCtQ,cAAc,KAfjB,kBAAC,KAAD,CAAWpR,UAAU,iBACpB,uDA1CH,EAAK/D,MAAQ,CACZ6jB,YAAatgB,EAAMgiB,KAAK1B,aAEzB,EAAKtgB,MAAM2f,cAAc3f,EAAMgiB,KAAKvc,YALlB,E,UAFG/C,IAAMC,YAqEdC,gBACd,SAAAnG,GAAK,MAAK,CAAEgJ,WAAYhJ,EAAMgJ,WAAYI,kBAAmBpJ,EAAMoJ,sBACnE,SAAA/C,GAAQ,MAAK,CAAE6c,cAAe,SAAAla,GAAU,OAAI3C,EAAS0C,GAAoBC,QAF3D7C,CAGbqf,ICxEIjQ,GAAgB,CACrB9V,SAAU,EACVC,OAAQ,EACR6lB,KAAM,KACNnL,SAAUjb,EAAUI,OAGfmmB,G,4MAEL1lB,MAAQuV,G,EAERoB,W,sBAAa,sBAAAnW,EAAA,sDACZiU,GAAwBvC,UAAU,EAAK3O,MAAM6F,mBAAmBpI,MAAK,SAAAsH,GACtD,OAAVA,GACHmG,MAAM,2BACNoG,GAA2BrV,IAE3B,EAAKwP,SAAS,CACbvP,SAAU,EAAK8D,MAAM6F,kBAAkB3J,SACvCC,OAAQ,EAAK6D,MAAM6F,kBAAkB1J,OACrC6lB,KAAM,CACLvc,WAAYV,EAAK,KAAL,MACZub,YAAavb,EAAK,KAAL,OAEd8R,SAAU,EAAK7W,MAAM6F,kBAAkBzJ,cAb9B,2C,EAmBbkX,kBAAoB,WACnB,EAAKF,aAAa3V,MAAK,kBAAMG,QAAQC,IAAI,yB,EAE1CwO,mBAAqB,SAAAC,GAEnBA,EAAUzG,kBAAkB3J,WAAa,EAAK8D,MAAM6F,kBAAkB3J,UACtEoQ,EAAUzG,kBAAkB1J,SAAW,EAAK6D,MAAM6F,kBAAkB1J,QAEpE,EAAKiX,aAAa3V,MAAK,kBAAMG,QAAQC,IAAI,yB,EAI3CqC,OAAS,WACR,OAAI,EAAKzD,MAAMoa,WAAajb,EAAUG,UAC9B,kBAAC,GAAD,CAAUimB,KAAM,EAAKvlB,MAAMulB,OACxB,EAAKvlB,MAAMoa,WAAajb,EAAUE,UACrC,kBAAC,GAAD,CAAUkmB,KAAM,EAAKvlB,MAAMulB,OAE5B,M,YAzCgBtf,IAAMC,WA6ChBC,gBAAQ,SAAAnG,GAAK,MAAK,CAAEoJ,kBAAmBpJ,EAAMoJ,qBAA7CjD,CAAmEuf,ICpD5EnQ,GAAgB,CACrB6E,SAAUjb,EAAUI,OAGfomB,G,4MAEL3lB,MAAQuV,G,EAERoB,WAAa,WACRzW,EAAkB,EAAKqD,MAAM6F,mBAChC,EAAK4F,SAAS,CAACoL,SAAUjb,EAAUC,SACzBe,EAAgB,EAAKoD,MAAM6F,mBACrC,EAAK4F,SAAS,CAACoL,SAAUjb,EAAUG,YAEnC,EAAK0P,SAAS,CAACoL,SAAUjb,EAAUI,S,EAKrCsX,kBAAoB,WACnB,EAAKF,c,EAGN/G,mBAAqB,SAAAC,GAEnBA,EAAUzG,kBAAkB3J,WAAa,EAAK8D,MAAM6F,kBAAkB3J,UACtEoQ,EAAUzG,kBAAkB1J,SAAW,EAAK6D,MAAM6F,kBAAkB1J,QAEpE,EAAKiX,c,EAIPlT,OAAS,WACR,OAAI,EAAKzD,MAAMoa,WAAajb,EAAUI,MAEpC,kBAAC,KAAD,CAAWwE,UAAU,iBACpB,yDAIC,EAAK/D,MAAMoa,WAAajb,EAAUC,OAC9B,kBAAC,GAAD,MAED,kBAAC,GAAD,O,YAvCmB6G,IAAMC,WA2CnBC,gBAAQ,SAAAnG,GAAK,MAAK,CAAEoJ,kBAAmBpJ,EAAMoJ,qBAA7CjD,CAAmEwf,IC5C5EC,I,mNAEJ5lB,MAAQ,CAAE6lB,SAAS,G,EAEnBrB,eAAiB,SAAAtU,IACVgH,OAAOuN,UAAUC,SAASnZ,MAAM,OAAS2E,EAAMyU,QAAUzU,EAAM0U,UAA8B,KAAlB1U,EAAM2U,UACpF3U,EAAME,iBACF,EAAK7M,MAAM6C,4BAA8B9E,EAA8BE,iBACrEtB,EAAkB,EAAKqD,MAAM6F,oBAAsBoL,O,EAK7D2Q,qBAAuB,WAAQ7W,SAAS8W,oBAAoB,UAAW,EAAKZ,iB,EAE5E3N,kBAAoB,WAClBvI,SAAS4W,iBAAiB,UAAU,EAAKV,gBACrC,EAAKjhB,MAAM6C,4BAA8B9E,EAA8BG,cACzEC,IAAwBV,MAAK,SAAAoF,GAC3B,EAAK7C,MAAMC,2CAA2C4C,GACtD,EAAK4I,SAAS,CAAE6W,SAAS,OAEpB,EAAK7W,SAAS,CAAE6W,SAAS,K,EAGpCpiB,OAAS,kBACP,kBAAC,IAAMqiB,SAAP,KAEI,EAAK9lB,MAAM6lB,QAEL,EAAKtiB,MAAM6C,4BAA8B9E,EAA8BE,gBACnE,yBAAKuC,UAAU,OACb,yBAAKL,MAAO,CAAEQ,SAAU,WAAY6hB,IAAK,MAAOC,MAAO,OAAQ9M,SAAU,UACvE,0BAAM+M,KAAK,MAAMC,aAAW,wBAA5B,qBACY,gCADZ,MACuB,gCADvB,UACsC,gCADtC,OACkD,gCADlD,OAIF,kBAAC,GAAD,MACA,kBAAC,GAAD,OAEF,kBAAC,EAAD,MAEN,O,YA1CMjgB,IAAMC,YAkDTC,gBACb,SAAAnG,GAAK,MAAK,CACRoG,0BAA2BpG,EAAMoG,0BACjCgD,kBAAmBpJ,EAAMoJ,sBAE3B,SAAA/C,GAAQ,MAAK,CACX7C,2CAA4C,SAAA8C,GAAI,OAAID,EAASrE,EAAmCsE,QANrFH,CAQbyf,IC7DkBvH,QACW,cAA7BnH,OAAOiP,SAASC,UAEa,UAA7BlP,OAAOiP,SAASC,UAEhBlP,OAAOiP,SAASC,SAAS7a,MACvB,2DCVJ9H,iBACE,kBAAC,IAAM4iB,WAAP,KACE,0BAAMC,IAAI,aAAaC,KAAK,gFAC5B,0BAAMD,IAAI,aAAaC,KAAK,4DAC5B,0BAAMD,IAAI,aAAaC,KAAK,8BAC5B,0BAAMA,KAAK,+DAA+DD,IAAI,eAC9E,0BAAMC,KAAK,yEAAyED,IAAI,eACxF,kBAAC,IAAD,CAAU5b,MAAOA,IACf,kBAAC,GAAD,QAGJ4D,SAASC,eAAe,SDgHpB,kBAAmBkW,WACrBA,UAAU+B,cAAcC,MACrBzlB,MAAK,SAAA0lB,GACJA,EAAaC,gBAEd7B,OAAM,SAAA8B,GACLzlB,QAAQylB,MAAMA,EAAMC,c","file":"static/js/main.673f9fc8.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.e9d28ab1.png\";","module.exports = __webpack_public_path__ + \"static/media/darkLogo.eccc7628.png\";","module.exports = __webpack_public_path__ + \"static/media/graphic.2ab501e2.png\";","export const FILE_TYPE = {\n  SOURCE: 'SOURCE',\n  TEXT_VIEW: 'TEXT_VIEW',\n  CARD_VIEW: 'CARD_VIEW',\n  EMPTY: 'NON_EXISTENT',\n};\n\nexport const NO_OPEN_FILE_ID = { sourceId: 0, viewId: 0, viewType: FILE_TYPE.EMPTY };\n\nexport const validateFileIdObj = fileId => fileId.hasOwnProperty('sourceId') && fileId.hasOwnProperty('viewId');\nexport const validateHasFileIdObj = state => state.hasOwnProperty('fileId') && validateFileIdObj(state.fileId);\n\nexport const checkNoOpenFileId = fileId => validateFileIdObj(fileId) && !fileId.sourceId && !fileId.viewId;\nexport const checkSourceFileId = fileId => validateFileIdObj(fileId) && fileId.sourceId && !fileId.viewId;\nexport const checkViewFileId = fileId => validateFileIdObj(fileId) && fileId.sourceId && fileId.viewId;\n\nexport const getFileIdKeyStr = fileId => validateFileIdObj(fileId)\n  ? (fileId.sourceId + (fileId.viewId ? '#' + fileId.viewId : '')) : '';\n","export const fetchWithTimeout = async (uri, options, time = 7500) => {\n  const controller = new AbortController();\n  setTimeout(() => { controller.abort(); }, time);\n  return await fetch(uri, { ...options, signal: controller.signal }).then((response) => {\n    if (!response.ok) { console.log(response); }\n    return response\n  });\n};\n","import Cookies from 'js-cookie';\nimport {fetchWithTimeout} from '../util/FetchWithTimeout';\n\nexport const SERVER_BASE_URL = process.env.NODE_ENV === 'development'\n  ? \"http://localhost:5000/\" : \"https://yaas.azurewebsites.net/\";\n\nexport const BACKEND_MODE_SIGNED_IN_STATUS = {\n  USER_SIGNED_IN: 'USER_SIGNED_IN',\n  USER_SIGNED_OUT: 'USER_SIGNED_OUT',\n  LOCAL_STORAGE: 'LOCAL_STORAGE',\n}\n\nexport const ACCESS_TOKEN_COOKIE_KEY = 'access_token';\n\nexport const getUserSignedInStatus = async () => {\n  const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n  if (token) {\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `auth`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (ok) { return BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN; }\n    } catch (e) { console.log(e); }\n  }\n  return BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT;\n};\n\nexport const INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY = 'initialLocalStorageBackendMode';\n\nconst SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE = 'backendModeSignedInStatus/set';\nexport const setBackendModeSignedInStatusAction =\n  status => ({ type: SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE, status });\nexport const backendModeSignedInStatusReducer = (\n  state = localStorage.getItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY)\n    ? BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE : BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT,\n  action,\n) => {\n  if (\n    action.type !== SET_BACKEND_MODE_SIGNED_IN_STATUS_ACTION_TYPE || !action.hasOwnProperty('status') ||\n    !BACKEND_MODE_SIGNED_IN_STATUS.hasOwnProperty(action.status)\n  ) { return state; }\n  if (action.status === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n    localStorage.setItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY, true);\n  } else { localStorage.removeItem(INITIAL_LOCAL_STORAGE_BACKEND_MODE_LOCAL_STORAGE_KEY); }\n  return action.status;\n};\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {GoogleLogin} from 'react-google-login';\nimport axios from 'axios';\nimport Cookies from 'js-cookie'\nimport {\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  SERVER_BASE_URL,\n  ACCESS_TOKEN_COOKIE_KEY,\n  setBackendModeSignedInStatusAction,\n} from '../reducers/BackendModeSignedInStatus';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport Button from '@material-ui/core/Button';\nimport ReactTypingEffect from 'react-typing-effect';\n\nconst CLIENT_ID = '709358329925-gic89ini15sgaenfrta1gshej1ik72jg.apps.googleusercontent.com';\n\nclass LandingPage extends React.Component {\n\n  handleLoginSuccess = async ({ profileObj: { name, email }, tokenObj: { id_token: token, expiresAt: expiry } }) => {\n    let response = null;\n    try {\n      response = await axios.post(\n        SERVER_BASE_URL + 'register_user',\n        {\n          method: 'POST',\n          body: JSON.stringify({ name, email, token }),\n          headers: { 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` },\n        },\n        { withCredentials: true },\n      );\n    } catch(e) { console.log(e); }\n    if (response && response.status === 201) {\n      Cookies.set(ACCESS_TOKEN_COOKIE_KEY, token, { expires: new Date(expiry) });\n      this.props.dispatchSetBackendModeSignedInStatusAction(BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN);\n    }\n  };\n\n  render = () =>\n    <div style={{display:\"flex\", flexFlow: \"column\", height: \"100vh\", overflow: \"hidden\"}}>\n      <div className={\"landing-root\"} style={{flexGrow: \"0 1 auto\"}}>\n      <AppBar position=\"static\" class=\"custom-navbar\">\n        <Toolbar>\n          <img className={\"menuButton\"} src={require('../images/logo.png')} style={{width: \"50px\", marginRight: \"1%\"}}/>\n        </Toolbar>\n      </AppBar>\n\n    </div>\n    <div style={{backgroundColor: \"#F5F0E1\", flex: \"1 1 auto\"}}>\n    <Grid container spacing={3} alignItems=\"center\" style={{height: \"100%\"}}>\n        <Grid item xs={1}></Grid>\n        <Grid item xs={5} alignItems=\"center\">\n          <Grid container spacing={3} alignItems=\"center\">\n            <Grid item xs={3}>\n              <img src={require('../images/darkLogo.png')} style={{width: \"90%\", marginLeft: \"20%\"}}/>\n            </Grid>\n            <Grid item xs={9}>\n              <Typography variant=\"h1\" className={\"title\"} style={{fontFamily:\"Bungee\", color:\"#1E3D59\"}}>\n              YADA\n              <ReactTypingEffect\n                text = \"\"\n                style={{fontFamily:\"Signika\"}}\n                speed = {10000}\n              />\n              </Typography>\n              <Typography variant=\"h3\" className={\"title\"} style={{fontFamily:\"Signika\", color:\"#1E3D59\"}}>\n               Yet Another Docs App\n              </Typography>\n             </Grid>\n          </Grid>\n          <br />\n          <div style={{marginLeft: \"8%\"}}>\n              <GoogleLogin\n                  clientId={CLIENT_ID}\n                  buttonText=\"Sign in With Google\"\n                  onSuccess={response => { this.handleLoginSuccess(response); }}\n                  onFailure={response => { console.log(response); }}\n                  cookiePolicy=\"single_host_origin\"\n                  responseType=\"code,token\"\n                  style={{float: \"left\"}}\n                />\n                <Button \n                  variant=\"outlined\"\n                  style={{\"height\" : \"250%\", marginLeft: \"3%\"}}\n                  onClick={() => {\n                    this.props.dispatchSetBackendModeSignedInStatusAction(BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE);\n                  }}>\n                  Use local storage\n                </Button>\n          </div>\n        </Grid>\n        <Grid item xs={6}>\n           <img src={require('../images/graphic.png')} style={{width: \"70%\", marginLeft: \"10%\"}}/>\n        </Grid>\n    </Grid>\n    </div>\n  </div>\n}\n\nexport default connect(\n  state => ({ backendModeSignedInStatus: state.backendModeSignedInStatus }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n  }),\n)(LandingPage);\n","import nearley from 'nearley';\n// Generated automatically by nearley, version undefined\n// http://github.com/Hardmath123/nearley\n/*\nMain -> Expression {% id %}\nExpression -> Expression_ {% id %} | Factor {% id %}\nExpression_ -> Factor _ \"|\" _ Expression {% function(d) { return [d[0], d[2], d[4]] } %}\nFactor -> Factor_ {% id %} | Term {% id %}\nFactor_ -> Term _ \"&\" _ Factor {% function(d) { return [d[0], d[2], d[4]] } %}\nTerm -> Not {% id %} | Nested {% id %} | Tag {% id %}\nNot -> \"!\" (Nested {% id %} | Tag {% id %})\nNested -> \"(\" _ Expression _ \")\" {% function(d) { return d[2] } %}\nTag -> \"#{\" [^{}]:+ \"}\" {% function(d) { return [d[0], d[1].join(\"\"), d[2]].join(\"\") } %}\n_ -> \" \":* {% function(d) { return null } %}\n*/\nfunction id(x) {\n  return x[0];\n}\nconst Grammar = {\n  Lexer: undefined,\n  ParserRules: [\n    { name: \"Main\", symbols: [\"Expression\"], postprocess: id },\n    { name: \"Expression\", symbols: [\"Expression_\"], postprocess: id },\n    { name: \"Expression\", symbols: [\"Factor\"], postprocess: id },\n    {\n      name: \"Expression_\",\n      symbols: [\"Factor\", \"_\", { literal: \"|\", pos: 30 }, \"_\", \"Expression\"],\n      postprocess: function(d) {\n        return [d[0], d[2], d[4]];\n      },\n    },\n    { name: \"Factor\", symbols: [\"Factor_\"], postprocess: id },\n    { name: \"Factor\", symbols: [\"Term\"], postprocess: id },\n    {\n      name: \"Factor_\",\n      symbols: [\"Term\", \"_\", { literal: \"&\", pos: 60 }, \"_\", \"Factor\"],\n      postprocess: function(d) {\n        return [d[0], d[2], d[4]];\n      },\n    },\n    { name: \"Term\", symbols: [\"Not\"], postprocess: id },\n    { name: \"Term\", symbols: [\"Nested\"], postprocess: id },\n    { name: \"Term\", symbols: [\"Tag\"], postprocess: id },\n    { name: \"Not$subexpression$1\", symbols: [\"Nested\"], postprocess: id },\n    { name: \"Not$subexpression$1\", symbols: [\"Tag\"], postprocess: id },\n    {\n      name: \"Not\",\n      symbols: [{ literal: \"!\", pos: 92 }, \"Not$subexpression$1\"],\n    },\n    {\n      name: \"Nested\",\n      symbols: [\n        { literal: \"(\", pos: 110 },\n        \"_\",\n        \"Expression\",\n        \"_\",\n        { literal: \")\", pos: 118 },\n      ],\n      postprocess: function(d) {\n        return d[2];\n      },\n    },\n    {\n      name: \"Tag$string$1\",\n      symbols: [{ literal: \"#\" }, { literal: \"{\" }],\n      postprocess: function joiner(d) {\n        return d.join(\"\");\n      },\n    },\n    { name: \"Tag$ebnf$1\", symbols: [/[^{}]/] },\n    {\n      name: \"Tag$ebnf$1\",\n      symbols: [/[^{}]/, \"Tag$ebnf$1\"],\n      postprocess: function arrconcat(d) {\n        return [d[0]].concat(d[1]);\n      },\n    },\n    {\n      name: \"Tag\",\n      symbols: [\"Tag$string$1\", \"Tag$ebnf$1\", { literal: \"}\", pos: 131 }],\n      postprocess: function(d) {\n        return d[1].join(\"\").trim();\n      },\n    },\n    { name: \"_$ebnf$1\", symbols: [] },\n    {\n      name: \"_$ebnf$1\",\n      symbols: [{ literal: \" \", pos: 139 }, \"_$ebnf$1\"],\n      postprocess: function arrconcat(d) {\n        return [d[0]].concat(d[1]);\n      },\n    },\n    {\n      name: \"_\",\n      symbols: [\"_$ebnf$1\"],\n      postprocess: function(d) {\n        return null;\n      },\n    },\n  ],\n  ParserStart: \"Main\",\n};\nexport const parse = (inputText, throwErrors = true) => {\n  let outputParsedExpr = null;\n  if (inputText) {\n    const parser = new nearley.Parser(nearley.Grammar.fromCompiled(Grammar));\n    try {\n      parser.feed(inputText.trim());\n      if (parser.results.length > 0) {\n        outputParsedExpr = parser.results;\n      }\n    } catch (ex) {}\n  }\n  return outputParsedExpr;\n};\n","export const convertStrValueOrDefault =\n  (valueStr, defaultValue, failureMessage, convertFromString = valueStr => JSON.parse(valueStr)) => {\n    let value = defaultValue;\n    if (valueStr) {\n      try { value = convertFromString(valueStr); }\n      catch (e) {\n        if (failureMessage) { console.log(failureMessage); }\n        console.log(e);\n      }\n    }\n    return value;\n  };\n\nexport const convertStrValueOrDefaultIfFalsy =\n  (valueStr, defaultValue, failureMessage, convertFromString = valueStr => JSON.parse(valueStr)) => {\n    if (!valueStr) { return defaultValue; }\n    let value = null;\n    try { value = convertFromString(valueStr); }\n    catch (e) {\n      if (failureMessage) { console.log(failureMessage); }\n      console.log(e);\n    }\n    return value;\n  };\n","import {convertStrValueOrDefault} from '../util/ConvertStrValueOrDefault';\nimport {NO_OPEN_FILE_ID, validateHasFileIdObj} from '../util/FileIdAndTypeUtils';\n\nexport const INITIAL_FILE_ID_LOCAL_STORAGE_KEY = 'initialFileId';\n\nconst storedInitialFileId = convertStrValueOrDefault(\n  localStorage.getItem(INITIAL_FILE_ID_LOCAL_STORAGE_KEY),\n  {},\n  'invalid initialFileId',\n);\nconst initialFileId = {\n  sourceId: storedInitialFileId.hasOwnProperty('sourceId')\n    ? storedInitialFileId.sourceId : NO_OPEN_FILE_ID.sourceId,\n  viewId: storedInitialFileId.hasOwnProperty('viewId') ? storedInitialFileId.viewId : NO_OPEN_FILE_ID.viewId,\n  viewType: storedInitialFileId.hasOwnProperty('viewType') ? storedInitialFileId.viewType : NO_OPEN_FILE_ID.viewId,\n}\n\nconst SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE = 'currentOpenFileId/set';\nexport const setCurrentOpenFileIdAction = fileId => ({ type: SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE, fileId });\nexport const currentOpenFileIdReducer = (state = initialFileId, action) =>\n  action.type !== SET_CURRENT_OPEN_FILE_ID_ACTION_TYPE || !validateHasFileIdObj(action)\n    ? state : action.fileId;\n\nexport const SET_SAVE_DIRTY_FLAG_ACTION_TYPE = 'saveDirtyFlag/set';\nexport const CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE = 'saveDirtyFlag/clear';\nexport const saveDirtyFlagReducer = (state = false, action) =>\n  action.type !== SET_SAVE_DIRTY_FLAG_ACTION_TYPE && action.type !== CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE\n    ? state : action.type === SET_SAVE_DIRTY_FLAG_ACTION_TYPE;\n\nconst SET_SELECT_NODE_ACTION_TYPE = 'selectNode/set';\nexport const setSelectNodeAction = selectNode => ({ type: SET_SELECT_NODE_ACTION_TYPE, selectNode });\nexport const selectNodeReducer = (state = null, action) =>\n  action.type === SET_SELECT_NODE_ACTION_TYPE && action.hasOwnProperty('selectNode') &&\n  (!action.selectNode || action.selectNode.hasOwnProperty('pos'))\n    ? action.selectNode : (action.type === SET_SELECT_NODE_ACTION_TYPE ? null : state);\n","export const SET_TAGS_IN_VIEW_ACTION_TYPE = 'tagsInView/set';\nexport const setTagsInViewAction = tagsInView => ({ type: SET_TAGS_IN_VIEW_ACTION_TYPE, tagsInView });\nexport const setTagsInViewReducer = (state = null, action) =>\n\taction.type !== SET_TAGS_IN_VIEW_ACTION_TYPE || !action.hasOwnProperty('tagsInView')\n\t\t? state : action.tagsInView;\n","import {configureStore} from '@reduxjs/toolkit';\nimport {combineReducers} from 'redux';\nimport {currentOpenFileIdReducer, saveDirtyFlagReducer, selectNodeReducer} from './reducers/CurrentOpenFileState';\nimport {backendModeSignedInStatusReducer} from './reducers/BackendModeSignedInStatus';\nimport {setTagsInViewReducer} from \"./reducers/SetTagsInView\";\n\nexport default configureStore({\n  reducer: combineReducers({\n    currentOpenFileId: currentOpenFileIdReducer,\n    saveDirtyFlag: saveDirtyFlagReducer,\n    selectNode: selectNodeReducer,\n    backendModeSignedInStatus: backendModeSignedInStatusReducer,\n    tagsInView: setTagsInViewReducer\n  }),\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {Decoration, DecorationSet} from 'prosemirror-view';\nimport {setSelectNodeAction} from '../../reducers/CurrentOpenFileState';\nimport store from '../../store';\n\nconst SELECT_NODE_PLUGIN_NAME = 'select-node';\nexport const SelectNodePluginKey = new PluginKey(SELECT_NODE_PLUGIN_NAME);\n\nexport default new Plugin({\n  key: SelectNodePluginKey,\n  state: {\n    init: () => null,\n    apply: (tr, _value, oldState) => {\n      let head = tr.selection.head;\n      let newState = null;\n      tr.doc.nodesBetween(head, head, (node, pos) => {\n        if (node.hasOwnProperty('attrs') && node.attrs['tags']) { newState = { node, pos }; }\n      });\n      if (\n        (!oldState && newState) || (oldState && !newState) ||\n        (oldState && newState && (newState.pos !== oldState.pos || !newState.node.eq(oldState.node)))\n      ) { store.dispatch(setSelectNodeAction(newState ? { pos: newState.pos } : null)); }\n      return newState;\n    },\n  },\n  props: {\n    decorations: state => {\n      const selectDecorations = [];\n      const selectNode = SelectNodePluginKey.getState(state);\n      if (selectNode) {\n        selectDecorations.push(Decoration.node(\n          selectNode.pos,\n          selectNode.pos + selectNode.node.nodeSize,\n          { style: 'background: #FAFAFA; outline: 1px solid #DCDCDC;' },\n        ));\n      }\n      return DecorationSet.create(state.doc, selectDecorations);\n    },\n  },\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {Decoration, DecorationSet} from 'prosemirror-view';\nimport {SelectNodePluginKey} from './SelectNode';\n\nconst TAG_FILTERING_PLUGIN_NAME = 'tag-filtering';\nexport const TagFilteringPluginKey = new PluginKey(TAG_FILTERING_PLUGIN_NAME);\n\nconst matchTagFilters = (tags, tagFilters) => {\n  if (!tagFilters) { return true; }\n  if (!Array.isArray(tagFilters)) { return tags.hasOwnProperty(tagFilters); }\n  // invariant: tagFilters isArray\n  // only not expressions have array length 2\n  if (tagFilters.length === 2) { return !matchTagFilters(tags, tagFilters[1]); }\n  const match1 = matchTagFilters(tags, tagFilters[0]);\n  if (tagFilters.length === 1) { return match1; }\n  // invariant: length 3, [1] is op, [2] is tag or sub expression\n  const andOp = tagFilters[1] === '&';\n  // short circuit evaluation\n  if (andOp !== match1) { return match1; }\n  // invariant:\n  // if andOp then !match1, so result should be match2,\n  // if !andOp then match1, so result should be match2\n  return matchTagFilters(tags, tagFilters[2]);\n};\n\nconst evaluateTagFilters = (decorations, tagFilters, selectNode, node, parentTags, pos) => {\n  let match = false;\n  const taggable = node.hasOwnProperty('attrs') && node.attrs['tags'];\n  const nodeTags = { ...parentTags, ...(taggable ? node.attrs['tags'] : null) };\n  if (taggable) { match = matchTagFilters(nodeTags, tagFilters); }\n  if (!node.isTextblock) {\n    let cumulativeChildSize = 1;\n    for (let i = 0; i < node.childCount; ++i) {\n      const child = node.child(i);\n      const childPos = pos + cumulativeChildSize;\n      const childMatch = evaluateTagFilters(decorations, tagFilters, selectNode, child, nodeTags, childPos);\n      match = match || childMatch;\n      cumulativeChildSize += child.nodeSize;\n    }\n  }\n  if (pos !== 0 && !match) {\n    decorations.push(Decoration.node(pos - 1, pos - 1 + node.nodeSize, { style: 'display: none;' }));\n  }\n  return match;\n};\n\nexport default new Plugin({\n  key: TagFilteringPluginKey,\n  state: {\n    init: () => null,\n    apply: (tr, v) => {\n      const val = tr.getMeta(TagFilteringPluginKey);\n      return val === undefined ? v : val;\n    },\n  },\n  props: {\n    decorations: state => {\n      const filterDecorations = [];\n      const tagFilters = TagFilteringPluginKey.getState(state);\n      const selectNode = SelectNodePluginKey.getState(state);\n      if (tagFilters) { evaluateTagFilters(filterDecorations, tagFilters, selectNode, state.doc, {}, 0); }\n      return DecorationSet.create(state.doc, filterDecorations);\n    },\n  },\n});\n","import {Plugin, PluginKey} from 'prosemirror-state';\nimport {checkSourceFileId} from '../../util/FileIdAndTypeUtils';\nimport {TagFilteringPluginKey} from './TagFiltering';\nimport store from '../../store';\n\nconst CANCEL_LINE_BREAKS_PLUGIN_NAME = 'cancel-line-breaks';\nexport const CancelLineBreaksPluginKey = new PluginKey(CANCEL_LINE_BREAKS_PLUGIN_NAME);\n\nconst checkInsertLineBreakReplaceStep = step => step.slice.content.content.some(node => !node.isLeaf);\n\nconst checkRemoveLineBreakReplaceStep = (step, doc) => {\n  if (step.from === step.to) { return false; }\n  const fromNode = doc.nodeAt(step.from);\n  const toNode = doc.nodeAt(step.to);\n  if (toNode) { return !fromNode || (fromNode && !fromNode.eq(toNode)); }\n  return !fromNode || !doc.nodeAt(step.to - 1).eq(fromNode);\n};\n\nexport default new Plugin({\n  key: CancelLineBreaksPluginKey,\n  filterTransaction: (tr, state) =>\n    (checkSourceFileId(store.getState().currentOpenFileId) && !TagFilteringPluginKey.getState(state)) ||\n    tr.steps.every(\n      step => step.toJSON().stepType !== 'replace' ||\n        (!checkInsertLineBreakReplaceStep(step) && !checkRemoveLineBreakReplaceStep(step, state.doc))\n    ),\n});\n","import {Extension} from 'rich-markdown-editor';\nimport CancelLineBreaksPlugin from './plugins/CancelLineBreaks';\nimport SelectNodePlugin from './plugins/SelectNode';\nimport TagFilteringPlugin from './plugins/TagFiltering';\n\nclass BlockTagging extends Extension {\n  get name() { return 'yada-blockTagging'; }\n  get plugins() { return [CancelLineBreaksPlugin, SelectNodePlugin, TagFilteringPlugin]; }\n}\n\nexport default new BlockTagging();\n","import './TagMenu.css';\nimport {defer} from 'lodash';\nimport {v4 as uuidv4} from 'uuid';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {SET_SAVE_DIRTY_FLAG_ACTION_TYPE} from '../reducers/CurrentOpenFileState';\n\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\n\nconst BLOCK_NODE_TAGS_LIST_ID = 'block_node_tags_list';\n\nconst ADD_TAG_INPUT_ID = 'add_tag_input';\n\nconst MODIFY_TAG_INPUT_ID_PREFIX = 'modify_tag_input_';\n\nconst TAG_VALUE_REGEX = /[^{}]/;\nconst INVALID_TAG_VALUE_REGEX = /[{}]/;\n\nclass TagMenu extends React.Component {\n\n  state = { selectNodeAttrs: {}, modifying: '' }\n\n  handleAddTag = () => {\n    const tag = document.getElementById(ADD_TAG_INPUT_ID).value.trim();\n    if (!tag || INVALID_TAG_VALUE_REGEX.test(tag) || !this.props.selectNode) { return false; }\n    if (this.state.selectNodeAttrs.hasOwnProperty('tags') && this.state.selectNodeAttrs.tags.hasOwnProperty(tag)) {\n      alert('tag value \"' + tag + '\" already exists');\n      return false;\n    }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    newSelectNodeAttrs.tags[tag] = uuidv4();\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleDeleteTag = tag => {\n    if (\n      !this.props.selectNode || !this.state.selectNodeAttrs.hasOwnProperty('tags') ||\n      !this.state.selectNodeAttrs.tags.hasOwnProperty(tag)\n    ) { return false; }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    delete newSelectNodeAttrs.tags[tag];\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleModifyTagValue = oldTagValue => {\n    const newTagValue = document.getElementById(MODIFY_TAG_INPUT_ID_PREFIX + oldTagValue).value.trim();\n    if (\n      !newTagValue || INVALID_TAG_VALUE_REGEX.test(newTagValue) || !this.props.selectNode ||\n      !this.state.selectNodeAttrs.hasOwnProperty('tags') ||\n      !this.state.selectNodeAttrs.tags.hasOwnProperty(oldTagValue)\n    ) { return false; }\n    if (newTagValue === oldTagValue) { return true; }\n    if (this.state.selectNodeAttrs.tags.hasOwnProperty(newTagValue)) {\n      alert('tag value \"' + newTagValue + '\" already exists');\n      return false;\n    }\n    const newSelectNodeAttrs = { ...this.state.selectNodeAttrs, tags: {...this.state.selectNodeAttrs.tags} };\n    newSelectNodeAttrs.tags[newTagValue] = newSelectNodeAttrs.tags[oldTagValue];\n    delete newSelectNodeAttrs.tags[oldTagValue];\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setNodeMarkup(\n        this.props.selectNode.pos,\n        null,\n        newSelectNodeAttrs,\n      )\n    );\n    this.setState({ selectNodeAttrs: newSelectNodeAttrs });\n    this.props.dispatchSetSaveDirtyFlagAction();\n    return true;\n  };\n\n  handleCancelModifyTagValue = tag => {\n    const input = MODIFY_TAG_INPUT_ID_PREFIX + tag;\n    input.value = tag;\n    input.setSelectionRange(0, 0);\n    if (this.state.modifying === tag) { this.setState({ modifying: '' }); }\n  };\n\n  handleStartModifyingTagValue = (tag) => {\n    this.setState({ modifying: tag });\n    defer(() => {\n      const input = document.getElementById(MODIFY_TAG_INPUT_ID_PREFIX + tag);\n      input.focus();\n      input.setSelectionRange(0, input.value.length);\n    });\n  };\n  \n  componentDidUpdate = prevProps => {\n    if (\n      prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n      prevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId ||\n      (!prevProps.selectNode && this.props.selectNode) || (prevProps.selectNode && !this.props.selectNode) ||\n      (prevProps.selectNode && this.props.selectNode && prevProps.selectNode.pos !== this.props.selectNode.pos)\n    ) {\n      document.getElementById(ADD_TAG_INPUT_ID).value = '';\n      defer(() => {\n        if (this.props.selectNode) {\n          const node = BlockTaggingEditorExtension.editor.view.state.doc.nodeAt(this.props.selectNode.pos);\n          this.setState({ selectNodeAttrs: {...(node && node.hasOwnProperty('attrs') ? node.attrs : null)} });\n        } else { this.setState({ selectNodeAttrs: {} }); }\n      });\n    }\n  };\n\n  render = () =>\n    <div className=\"MarginPane\">\n      <div id=\"tag_menu_wrapper\">\n        <div className=\"InputRow\" id=\"add_tag_input_row\">\n          <input\n            id={ADD_TAG_INPUT_ID}\n            title=\"new tag\"\n            placeholder=\"new tag\"\n            disabled={!this.props.selectNode}\n            onKeyPress={event=> {\n              if (event.key === 'Enter' && this.handleAddTag()) { event.target.value = ''; }\n              if (!TAG_VALUE_REGEX.test(event.key)) { event.preventDefault(); }\n            }}\n            onKeyDown={event=> {\n              if (event.key === 'Escape') {\n                event.target.value = '';\n                BlockTaggingEditorExtension.editor.view.focus();\n              }\n            }}\n          />\n          <button\n            className=\"MonospaceCharButton\"\n            title=\"add\"\n            disabled={!this.props.selectNode}\n            onClick={this.handleAddTag}>\n            {'+'}\n          </button>\n        </div>\n        <div id=\"tag_menu_list_container\">\n          {\n            this.props.selectNode && this.state.selectNodeAttrs.hasOwnProperty('tags') &&\n            Object.keys(this.state.selectNodeAttrs.tags).length > 0\n              ? <ul id={BLOCK_NODE_TAGS_LIST_ID}>\n                  {\n                    Object.keys(this.state.selectNodeAttrs.tags).map(tag =>\n                      <li key={tag}>\n                        <div className=\"ButtonRow\">\n                          {\n                            this.state.modifying !== tag\n                              ? <button disabled>{tag}</button>\n                              :  <input\n                                  id={MODIFY_TAG_INPUT_ID_PREFIX + tag}\n                                  defaultValue={tag}\n                                  placeholder={tag}\n                                  disabled={this.state.modifying !== tag}\n                                  onBlur={event => {\n                                    this.handleModifyTagValue(tag);\n                                    if (this.state.modifying === tag) { this.setState({ modifying: '' }); }\n                                  }}\n                                  onKeyDown={event => {\n                                    if (event.key === 'Escape') { this.handleCancelModifyTagValue(tag); }\n                                  }}\n                                  onKeyPress={event => {\n                                    if (event.key === 'Enter') { event.target.blur(); }\n                                    if (!TAG_VALUE_REGEX.test(event.key)) { event.preventDefault(); }\n                                  }}\n                                />\n                          }\n                          <button\n                            className=\"MonospaceCharButton\"\n                            title=\"modify\"\n                            hidden={this.state.modifying === tag}\n                            onClick={() => { this.handleStartModifyingTagValue(tag); }}>\n                            {'#'}\n                          </button>\n                          <button\n                            className=\"MonospaceCharButton\"\n                            title=\"remove\"\n                            onClick={() => { this.handleDeleteTag(tag); }}>\n                            {'-'}\n                          </button>\n                        </div>\n                      </li>\n                    )\n                  }\n                </ul>\n              : <div className=\"PlaceholderDivWithText\" id=\"no_tags_placeholder\">\n                  {'no ' + (!this.props.selectNode ? 'selected block' : 'block tags')}\n                </div>\n          }\n        </div>\n      </div>\n    </div>;\n};\n\nexport default connect(\n  state => ({\n    selectNode: state.selectNode,\n    saveDirtyFlag: state.saveDirtyFlag,\n    currentOpenFileId: state.currentOpenFileId,\n  }),\n  dispatch => ({ dispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE }) }),\n)(TagMenu);\n","import {convertStrValueOrDefault, convertStrValueOrDefaultIfFalsy} from '../util/ConvertStrValueOrDefault';\nimport {getFileIdKeyStr} from '../util/FileIdAndTypeUtils';\n\nconst SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX = 'sourceViews_';\n\n// API-ish\nexport const doSetLocalStorageSourceViews = (sourceId, sourceViews) =>\n  localStorage.setItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId, JSON.stringify(sourceViews));\n\nconst doGetLocalStorageSourceViews = sourceId => convertStrValueOrDefaultIfFalsy(\n  localStorage.getItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n  {},\n  'invalid sourceViews',\n);\n\nconst SOURCE_ID_NAMES_LOCAL_STORAGE_KEY = 'sourceIdNames';\n\n// API-ish\nexport const doSetLocalStorageSourceIdNames = sourceIdNames =>\n  localStorage.setItem(SOURCE_ID_NAMES_LOCAL_STORAGE_KEY, JSON.stringify(sourceIdNames));\n\nconst doGetLocalStorageSourceIdNames = () => convertStrValueOrDefaultIfFalsy(\n  localStorage.getItem(SOURCE_ID_NAMES_LOCAL_STORAGE_KEY),\n  {},\n  'invalid sourceIdNames',\n);\n\nexport const calculateLocalStorageNextNewId = (existingIdsDict, candidate) => {\n  while (!candidate || existingIdsDict.hasOwnProperty(candidate.toString())) { candidate += 1; }\n  return candidate.toString();\n};\n\nexport const calculateLocalStorageNextNewFileIds = filesList => ({\n  source: calculateLocalStorageNextNewId(filesList, 0),\n  nextNewViewIdsForSourceIds: Object.fromEntries(Object.entries(filesList).map(\n    ([sourceId, { views }]) => [sourceId, calculateLocalStorageNextNewId(views, 0)]\n  )),\n});\n\nconst DEFAULT_VIEW_NAME = 'Unnamed View';\nconst DEFAULT_SOURCE_NAME = 'Unnamed Source';\n\nconst SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX = 'sourceSavedTagFilters_';\n\nconst VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX = 'viewSpec_';\n\nconst SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX = 'sourceContent_';\n\nexport default {\n  doGetFilesList: async () => {\n    const sourceIdNames = doGetLocalStorageSourceIdNames();\n    if (!sourceIdNames) { return null; }\n    const filesList = {};\n    for (const [sourceId, sourceName] of Object.entries(sourceIdNames)) {\n      const sourceViews = doGetLocalStorageSourceViews(sourceId);\n      if (!sourceViews) { return null; }\n      filesList[sourceId] = { name: sourceName, views: sourceViews };\n    }\n    return filesList;\n  },\n  doSaveViewSpec: async (tagsList, sourceId, viewId, type, createNew) => {\n    const viewSpecLocalStorageKey = VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId);\n    if (tagsList.length > 0) { localStorage.setItem(viewSpecLocalStorageKey, JSON.stringify(tagsList)); }\n    else { localStorage.removeItem(viewSpecLocalStorageKey); }\n    return { id: viewId, sourceId, ...(createNew ? { name: DEFAULT_VIEW_NAME, type } : null) };\n  },\n  doGetView: async (fileId) => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(fileId.sourceId, fileId.viewId)),\n    [],\n    'invalid viewSpec',\n  ),\n  doGetSourceTaggedBlocks: async sourceId => {\n    const sourceContentDocStr = localStorage.getItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    if (!sourceContentDocStr) { return {}; }\n    const sourceContentDoc = convertStrValueOrDefault(sourceContentDocStr, null, 'invalid sourceContent');\n    if (!sourceContentDoc) { return null; }\n    const sourceTaggedBlocks = {};\n    if (sourceContentDoc) {\n      const nodes = [sourceContentDoc];\n      while (nodes.length > 0) {\n        const node = nodes.shift();\n        if (node.hasOwnProperty('attrs') && node.attrs.hasOwnProperty('tags')) {\n          for (const [tag, tagId] of Object.entries(node.attrs.tags)) { sourceTaggedBlocks[tagId] = { tag, node }; }\n        } else if (node.hasOwnProperty('content')) { nodes.push(...node.content); }\n      }\n    }\n    return sourceTaggedBlocks;\n  },\n  doSaveSourceContent: async (value, sourceId, createNew) => {\n    const saveValue = convertStrValueOrDefaultIfFalsy(\n      value,\n      '',\n      'invalid sourceContent value',\n      valueStr => {\n        JSON.parse(valueStr);\n        return valueStr;\n      },\n    );\n    if (saveValue === null) { return null; }\n    const sourceContentLocalStorageKey = SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId;\n    if (saveValue) { localStorage.setItem(sourceContentLocalStorageKey, saveValue); }\n    else { localStorage.removeItem(sourceContentLocalStorageKey); }\n    return { id: sourceId, ...(createNew ? { name: DEFAULT_SOURCE_NAME } : null) };\n  },\n  doGetSourceContent: async sourceId => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n    '',\n    'invalid sourceContent',\n    valueStr => {\n      JSON.parse(valueStr);\n      return valueStr;\n    },\n  ),\n  // TODO add/remove single instead of set list\n  doSetSourceSavedTagFilters: async (sourceId, sourceSavedTagFilters) => {\n    const sourceSavedTagFiltersLocalStorageKey = SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId;\n    if (Object.keys(sourceSavedTagFilters).length > 0) {\n      localStorage.setItem(sourceSavedTagFiltersLocalStorageKey, JSON.stringify(sourceSavedTagFilters));\n    } else { localStorage.removeItem(sourceSavedTagFiltersLocalStorageKey); }\n    return true;\n  },\n  doGetSourceSavedTagFilters: async sourceId => convertStrValueOrDefaultIfFalsy(\n    localStorage.getItem(SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId),\n    {},\n    'invalid sourceSavedTagFilters',\n  ),\n  doDeleteView: async (sourceId, viewId) => {\n    localStorage.removeItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId));\n    return true;\n  },\n  doDeleteSource: async (sourceId, localStorageSourceViewIds) => {\n    localStorage.removeItem(SOURCE_SAVED_TAG_FILTERS_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    localStorage.removeItem(SOURCE_CONTENT_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    for (const viewId of localStorageSourceViewIds) {\n      localStorage.removeItem(VIEW_SPEC_LOCAL_STORAGE_KEY_PREFIX + getFileIdKeyStr(sourceId, viewId));\n    }\n    localStorage.removeItem(SOURCE_VIEWS_LOCAL_STORAGE_KEY_PREFIX + sourceId);\n    return true;\n  },\n  doRenameView: async () => true,\n  doRenameSource: async () => true,\n};\n","import Cookies from 'js-cookie';\nimport axios from 'axios';\nimport {fetchWithTimeout} from '../util/FetchWithTimeout';\nimport {convertStrValueOrDefaultIfFalsy} from '../util/ConvertStrValueOrDefault';\nimport {ACCESS_TOKEN_COOKIE_KEY, SERVER_BASE_URL} from '../reducers/BackendModeSignedInStatus';\n\nconst EMPTY_SOURCE_CONTENT = { type: 'doc', content: [{ type: 'paragraph', attrs: { tags: {} } }] };\n\nexport default {\n  doGetFilesList: async () => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `documents`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSaveViewSpec: async (tagsList, sourceId, viewId, type, createNew) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewType=${type}` + (!createNew ? `&viewID=${viewId}` : ''),\n        {\n          method: 'PUT',\n          body: JSON.stringify({ tags: tagsList }),\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        const { viewID } = await response.json();\n        return { id: viewID, sourceId: sourceId, ...(createNew ? { name:\"Untitled\", type } : null) };\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetView: async (fileId) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const viewResponse = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${fileId.sourceId}&viewID=${fileId.viewId}`,\n        { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      const tagResponse = await fetchWithTimeout(\n          SERVER_BASE_URL + `tags?docID=${fileId.sourceId}`,\n          { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (!viewResponse.ok || !tagResponse.ok) { return null; }\n      const view_json = await viewResponse.json();\n      const tags_json = await tagResponse.json();\n      return {\"view\": view_json, \"tags\": tags_json, \"type\": fileId.viewType};\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceTaggedBlocks: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `tags?docID=${sourceId}`,\n        { method: 'GET', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSaveSourceContent: async (value, sourceId, createNew) => {\n    const saveValue = convertStrValueOrDefaultIfFalsy(\n      value,\n      JSON.stringify(EMPTY_SOURCE_CONTENT),\n      'invalid sourceContent value',\n      valueStr => {\n        JSON.parse(valueStr);\n        return valueStr;\n      },\n    );\n    if (!saveValue) { return null; }\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + 'document' + (!createNew ? `?docID=${sourceId}` : ''),\n        {\n          method: 'PUT',\n          body: saveValue,\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        const { id, name } = await response.json();\n        return { id: id, ...(createNew ? { name } : null) };\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceContent: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.text(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doSetSourceSavedTagFilters: async (sourceId, sourceSavedTagFilters) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    const filters = Object.keys(sourceSavedTagFilters).map(k => sourceSavedTagFilters[k]);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `filters?docID=`,\n        {\n          method: 'POST',\n          body: JSON.stringify({ body: {\"docID\": sourceId, \"filters\": filters} }),\n          headers: new Headers({ 'Content-Type': 'application/json', 'Set-Cookie': `token=${token}` }),\n        },\n      );\n      if (response.ok) {\n        return true;\n      };\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doGetSourceSavedTagFilters: async sourceId => { // TODO\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const response = await fetchWithTimeout(\n        SERVER_BASE_URL + `filters?docID=${sourceId}`,\n        { headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      if (response.ok) { return await response.json(); }\n    } catch (e) { console.log(e); }\n    return null;\n  },\n  doDeleteSource: async sourceId => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}`,\n        { method: 'DELETE', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doDeleteView: async (sourceId, viewId) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewID=${viewId}`,\n        { method: 'DELETE', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doRenameSource: async (sourceId, name) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `document?docID=${sourceId}&name=${name}`,\n        { method: 'PATCH', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n  doRenameView: async (sourceId, viewId, name) => {\n    const token = Cookies.get(ACCESS_TOKEN_COOKIE_KEY);\n    try {\n      const { ok } = await fetchWithTimeout(\n        SERVER_BASE_URL + `view?docID=${sourceId}&viewID=${viewId}&name=${name}`,\n        { method: 'PATCH', headers: new Headers({ 'Set-Cookie': `token=${token}` }) },\n      );\n      return ok;\n    } catch (e) { console.log(e); }\n    return false;\n  },\n};\n","import {BACKEND_MODE_SIGNED_IN_STATUS} from '../reducers/BackendModeSignedInStatus';\nimport LocalFileStorageSystemClient from './LocalFileStorageSystemClient';\nimport HostedFileStorageSystemClient from './HostedFileStorageSystemClient';\nimport store from '../store';\n\nconst getFileStorageSystemClient = () =>\n  store.getState().backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n    ? LocalFileStorageSystemClient : HostedFileStorageSystemClient;\n\nconst clientInterface = {\n  doGetFilesList: () => { throw new Error('not implemented'); },\n  doSaveViewSpec: () => { throw new Error('not implemented'); },\n  doGetView: () => { throw new Error('not implemented'); },\n  doGetSourceTaggedBlocks: () => { throw new Error('not implemented'); },\n  doSaveSourceContent: () => { throw new Error('not implemented'); },\n  doGetSourceContent: () => { throw new Error('not implemented'); },\n  doSetSourceSavedTagFilters: () => { throw new Error('not implemented'); },\n  doGetSourceSavedTagFilters: () => { throw new Error('not implemented'); },\n  doDeleteView: () => { throw new Error('not implemented'); },\n  doDeleteSource: () => { throw new Error('not implemented'); },\n  doRenameView: () => { throw new Error('not implemented'); },\n  doRenameSource: () => { throw new Error('not implemented'); },\n};\n\nexport default Object.keys(clientInterface).reduce(\n  (partial, key) => {\n    partial[key] = async (...args) => {\n      const fileStorageSystemClient = getFileStorageSystemClient();\n      return fileStorageSystemClient.hasOwnProperty(key)\n        ? (\n            store.getState().backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n              ? await fileStorageSystemClient[key](...args) : null\n          )\n        : clientInterface[key]();\n    };\n    return partial;\n  },\n  {},\n);\n","import './Editor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {NO_OPEN_FILE_ID, checkNoOpenFileId, checkSourceFileId} from '../util/FileIdAndTypeUtils';\nimport {\n  CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE,\n  SET_SAVE_DIRTY_FLAG_ACTION_TYPE,\n} from '../reducers/CurrentOpenFileState';\nimport {TextSelection} from 'prosemirror-state';\nimport {handleSetCurrentOpenFileId} from './Navigator';\nimport TagMenu from './TagMenu';\nimport RichMarkdownEditor from 'rich-markdown-editor';\n\nimport store from '../store';\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\n\nexport const handleSaveCurrentFileEditorContent = () => {\n  const currentOpenFileId = store.getState().currentOpenFileId;\n  if (checkSourceFileId(store.getState().currentOpenFileId) && store.getState().saveDirtyFlag) {\n    FileStorageSystemClient.doSaveSourceContent(\n      BlockTaggingEditorExtension.editor.value(true),\n      currentOpenFileId.sourceId,\n    ).then(success => {\n      if (success) { store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE }); }\n      else { alert('failed to save source content'); }\n    });\n  }\n};\n\nclass Editor extends React.Component {\n\n  render = () => {\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    return (\n      <div className=\"MainPane\">\n        <div id=\"editor_container\">\n          <div className=\"InputRow\" id=\"current_open_file_controls\">\n            <button\n              className=\"MonospaceCharButton\"\n              title=\"close\"\n              disabled={noOpenFileIdCheck}\n              onClick={() => { handleSetCurrentOpenFileId(NO_OPEN_FILE_ID); }}>\n              {''}\n            </button>\n            <button\n              className=\"MonospaceCharButton\"\n              title=\"save\"\n              disabled={noOpenFileIdCheck || !this.props.saveDirtyFlag}\n              onClick={handleSaveCurrentFileEditorContent}>\n              {'^'}\n            </button>\n            <div style={{ minWidth: '5px' }} />\n            {this.props.children}\n          </div>\n          <div id=\"editor\" hidden={noOpenFileIdCheck}>\n            <RichMarkdownEditor\n              extensions={[BlockTaggingEditorExtension]}\n              key={this.props.fileIdKeyStr}\n              defaultValue={this.props.fileContent}\n              jsonStrValue={!(!this.props.fileContent)}\n              onKeyDown={event => {\n                if (event.key === 'Escape') {\n                  BlockTaggingEditorExtension.editor.view.dispatch(\n                    BlockTaggingEditorExtension.editor.view.state.tr\n                      .setSelection(TextSelection.create(BlockTaggingEditorExtension.editor.view.state.doc, 0, 0))\n                  );\n                  event.target.blur();\n                }\n              }}\n              onChange={() => { if (!this.props.saveDirtyFlag) { this.props.dispatchSetSaveDirtyFlagAction(); } }}\n            />\n          </div>\n          <div\n            className=\"PlaceholderDivWithText\"\n            id=\"no_file_editor_placeholder\"\n            hidden={!noOpenFileIdCheck}>\n            <div style={{ flexGrow: 1 }} />\n            <div style={{ display: 'flex' }}>\n              <div style={{ flexGrow: 2 }} />\n              open a doc using the navigator side pane on the left\n              <div style={{ flexGrow: 3 }} />\n            </div>\n            <div style={{ flexGrow: 8 }} />\n          </div>\n        </div>\n        <TagMenu />\n      </div>\n    );\n  };\n};\n\nexport default connect(\n  state => ({ currentOpenFileId: state.currentOpenFileId, saveDirtyFlag: state.saveDirtyFlag }),\n  dispatch => ({ dispatchSetSaveDirtyFlagAction: () => dispatch({ type: SET_SAVE_DIRTY_FLAG_ACTION_TYPE }) }),\n)(Editor);\n","import './Editor.css';\nimport {defer} from 'lodash';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {NO_OPEN_FILE_ID, checkNoOpenFileId, checkSourceFileId, checkViewFileId, getFileIdKeyStr} from '../util/FileIdAndTypeUtils';\nimport {Selection, TextSelection} from 'prosemirror-state';\nimport {parse as parseTagFilters} from '../lib/TagFiltersGrammar';\nimport {TagFilteringPluginKey} from '../editor_extension/plugins/TagFiltering';\nimport Editor from './Editor';\nimport {handleSetCurrentOpenFileId} from './Navigator';\n\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport BlockTaggingEditorExtension from '../editor_extension/BlockTagging';\n\nexport const INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY = 'initialTagFilters';\n\nconst TAG_FILTERS_INPUT_ID = 'tag_filters_input';\nconst SAVED_TAG_FILTERS_DATALIST_ID = 'saved_tag_filters_datalist';\n\nconst DEFAULT_STATE = {\n  fileIdKeyStr: getFileIdKeyStr(NO_OPEN_FILE_ID),\n  fileContent: '',\n  modifyingTagFilters: false,\n  currentTagFiltersStr: '',\n  currentParsedTagFiltersStr: '',\n  sourceSavedTagFilters: {},\n};\n\nclass SourceEditorWithTagFiltersInput extends React.Component {\n\n  state = DEFAULT_STATE;\n\n  handleCancelModifyingTagFilters = () => {\n    const input = document.getElementById(TAG_FILTERS_INPUT_ID);\n    input.value = this.state.currentTagFiltersStr;\n    this.setState({ modifyingTagFilters: false });\n  };\n\n  handleStartModifyingTagFilters = () => {\n    this.setState({ modifyingTagFilters: true });\n    defer(() => {\n      const input = document.getElementById(TAG_FILTERS_INPUT_ID);\n      input.focus();\n      input.setSelectionRange(input.value.length, input.value.length);\n    });\n  };\n\n  // TODO remove from list directly instead of only unpersist current\n  handleUnpersistCurrentTagFilters = () => {\n    if (\n      !this.state.currentTagFiltersStr ||\n      !this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentParsedTagFiltersStr)\n    ) { return false; }\n    const newSourceSavedTagFilters = {...this.state.sourceSavedTagFilters};\n    delete newSourceSavedTagFilters[this.state.currentParsedTagFiltersStr];\n    FileStorageSystemClient.doSetSourceSavedTagFilters(\n      this.props.currentOpenFileId.sourceId,\n      newSourceSavedTagFilters,\n    ).then(success => {\n      if (!success) { alert('failed to set source saved tag filters'); }\n      else { this.setState({ sourceSavedTagFilters: newSourceSavedTagFilters }); }\n    });\n  };\n\n  handlePersistNewSavedTagFilters = () => {\n    if (\n      !this.state.currentTagFiltersStr ||\n      this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentParsedTagFiltersStr)\n    ) { return false; }\n    const newSourceSavedTagFilters = {...this.state.sourceSavedTagFilters};\n    newSourceSavedTagFilters[this.state.currentParsedTagFiltersStr] = this.state.currentTagFiltersStr;\n    FileStorageSystemClient.doSetSourceSavedTagFilters(\n      this.props.currentOpenFileId.sourceId,\n      newSourceSavedTagFilters,\n    ).then(success => {\n      if (!success) { alert('failed to set source saved tag filters'); }\n      else { this.setState({ sourceSavedTagFilters: newSourceSavedTagFilters }); }\n    });\n  };\n\n  handleApplyTagFilters = () => {\n    let tagFilters = null;\n    const tagFiltersStr = document.getElementById(TAG_FILTERS_INPUT_ID).value.trim();\n    if (tagFiltersStr) {\n      tagFilters = parseTagFilters(tagFiltersStr);\n      if (!tagFilters) {\n        alert('invalid tag filters');\n        return false;\n      }\n    }\n    document.getElementById(TAG_FILTERS_INPUT_ID).value = tagFiltersStr;\n    if (tagFilters) { localStorage.setItem(INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY, tagFiltersStr); }\n    else { localStorage.removeItem(INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY); }\n    const parsedTagFiltersStr = JSON.stringify(tagFilters);\n    const oldParsedTagFiltersStr = this.state.currentParsedTagFiltersStr;\n    this.setState({ currentTagFiltersStr: tagFiltersStr, currentParsedTagFiltersStr: parsedTagFiltersStr });\n    if (parsedTagFiltersStr === oldParsedTagFiltersStr) { return true; }\n    BlockTaggingEditorExtension.editor.view.dispatch(\n      BlockTaggingEditorExtension.editor.view.state.tr.setMeta(TagFilteringPluginKey, tagFilters)\n        .setSelection(\n          tagFilters\n            ? TextSelection.create(BlockTaggingEditorExtension.editor.view.state.doc, 0, 0)\n            : Selection.atStart(BlockTaggingEditorExtension.editor.view.state.doc)\n        ).scrollIntoView()\n    );\n    defer(() => {\n      if (tagFilters) { BlockTaggingEditorExtension.editor.view.dom.blur(); }\n      else { BlockTaggingEditorExtension.editor.view.focus(); }\n    });\n    return true;\n  };\n\n  changeFile = async () => {\n    console.log(\"Change FILE\");\n    if (!checkNoOpenFileId(this.props.currentOpenFileId)) {\n      defer(() => {\n        BlockTaggingEditorExtension.editor.focusAtStart();\n      });\n    }\n    const fileIdKeyStr = getFileIdKeyStr(this.props.currentOpenFileId);\n    console.log(this.props.currentOpenFileId);\n    if (checkSourceFileId(this.props.currentOpenFileId)) {\n      FileStorageSystemClient.doGetSourceContent(this.props.currentOpenFileId.sourceId).then(value => {\n        if (value === null) {\n          alert('failed to retrieve source content');\n          handleSetCurrentOpenFileId(NO_OPEN_FILE_ID);\n        } else {\n          this.setState({fileIdKeyStr, fileContent: value ?? ''});\n          FileStorageSystemClient.doGetSourceSavedTagFilters(this.props.currentOpenFileId.sourceId)\n              .then(sourceSavedTagFilters => {\n                if (!sourceSavedTagFilters) {\n                  alert('failed to retrieve source saved tag filters');\n                } else {\n                  this.setState({sourceSavedTagFilters});\n                }\n              });\n        }\n      });\n    } else {\n      this.setState({fileIdKeyStr, fileContent: ''});\n    }\n  };\n\n  componentDidMount = () => {\n    this.changeFile().then(() => {\n      if (checkSourceFileId(this.props.currentOpenFileId)) {\n        const initialTagFiltersStr = localStorage.getItem(INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY);\n        if (initialTagFiltersStr) {\n          document.getElementById(TAG_FILTERS_INPUT_ID).value = initialTagFiltersStr;\n          this.handleApplyTagFilters();\n        }\n      }\n    });\n  };\n\n  componentDidUpdate = prevProps => {\n    if (\n      prevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n      prevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n    ) {\n      document.getElementById(TAG_FILTERS_INPUT_ID).value = '';\n      this.handleApplyTagFilters();\n      this.setState({ sourceSavedTagFilters: {} });\n      this.changeFile();\n    }\n  };\n\n  render = () => {\n    const sourceFileIdCheck = checkSourceFileId(this.props.currentOpenFileId);\n    const currentTagFiltersSaved =\n      this.state.sourceSavedTagFilters.hasOwnProperty(this.state.currentParsedTagFiltersStr);\n    return (\n      <Editor fileIdKeyStr={this.state.fileIdKeyStr} fileContent={this.state.fileContent}>\n        <div className=\"InputRow\">\n          <button\n            className=\"MonospaceCharButton\"\n            title={(currentTagFiltersSaved ? 'un-' : '') + 'persist'}\n            disabled={!sourceFileIdCheck || !this.state.currentTagFiltersStr || this.state.modifyingTagFilters}\n            onClick={\n              currentTagFiltersSaved ? this.handleUnpersistCurrentTagFilters : this.handlePersistNewSavedTagFilters\n            }>\n            {currentTagFiltersSaved ? '-' : '+'}\n          </button>\n          <button\n            className=\"MonospaceCharButton\"\n            title=\"modify\"\n            disabled={!sourceFileIdCheck || this.state.modifyingTagFilters}\n            onClick={this.handleStartModifyingTagFilters}>\n            {'#'}\n          </button>\n          <input\n            id={TAG_FILTERS_INPUT_ID}\n            defaultValue={this.state.currentTagFiltersStr}\n            placeholder=\"tag filters\"\n            title=\"tag filters - example syntax: ( #{tag1} | !( #{tag2} ) ) & #{tag3}\"\n            list={SAVED_TAG_FILTERS_DATALIST_ID}\n            disabled={!sourceFileIdCheck || !this.state.modifyingTagFilters}\n            onBlur={event => {\n              if (this.handleApplyTagFilters()) { this.setState({ modifyingTagFilters: false }); }\n              else {\n                const input = event.target;\n                defer(() => { input.focus(); });\n              }\n            }}\n            onKeyDown={event => { if (event.key === 'Escape') { this.handleCancelModifyingTagFilters(); } }}\n            onKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n          />\n          <datalist id={SAVED_TAG_FILTERS_DATALIST_ID}>\n            {\n              Object.entries(this.state.sourceSavedTagFilters)\n                .map(([_parsedTagFiltersStr, tagFiltersStr]) => <option key={tagFiltersStr} value={tagFiltersStr} />)\n            }\n          </datalist>\n          <button\n            className=\"MonospaceCharButton\"\n            title=\"clear\"\n            disabled={!sourceFileIdCheck || !this.state.currentTagFiltersStr || this.state.modifyingTagFilters}\n            onClick={() => {\n              document.getElementById(TAG_FILTERS_INPUT_ID).value = '';\n              this.handleApplyTagFilters();\n            }}>\n            {''}\n          </button>\n        </div>\n      </Editor>\n    );\n  };\n}\n\nexport default connect(state => ({ currentOpenFileId: state.currentOpenFileId }))(SourceEditorWithTagFiltersInput);\n","import './Navigator.css';\nimport {debounce, defer} from 'lodash';\nimport Cookies from 'js-cookie';\nimport React from 'react';\nimport {batch, connect} from 'react-redux';\nimport {\n  FILE_TYPE,\n  NO_OPEN_FILE_ID,\n  validateFileIdObj,\n  checkNoOpenFileId,\n  checkSourceFileId,\n  checkViewFileId,\n  getFileIdKeyStr,\n} from '../util/FileIdAndTypeUtils';\nimport {INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY} from './SourceEditorWithTagFiltersInput';\nimport {\n  CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE,\n  INITIAL_FILE_ID_LOCAL_STORAGE_KEY,\n  setCurrentOpenFileIdAction,\n  setSelectNodeAction,\n} from '../reducers/CurrentOpenFileState';\nimport {\n  ACCESS_TOKEN_COOKIE_KEY,\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  getUserSignedInStatus,\n  setBackendModeSignedInStatusAction,\n} from '../reducers/BackendModeSignedInStatus';\nimport {\n  doSetLocalStorageSourceIdNames,\n  doSetLocalStorageSourceViews,\n  calculateLocalStorageNextNewId,\n  calculateLocalStorageNextNewFileIds,\n} from '../backend/LocalFileStorageSystemClient';\nimport Button from '@material-ui/core/Button';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport Input from '@material-ui/core/Input';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Divider from '@material-ui/core/Divider';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Collapse from '@material-ui/core/Collapse';\nimport ExpandLess from '@material-ui/icons/ExpandLess';\nimport ExpandMore from '@material-ui/icons/ExpandMore';\nimport Paper from '@material-ui/core/Paper';\nimport InputBase from '@material-ui/core/InputBase';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport EditIcon from '@material-ui/icons/Edit';\nimport Popover from '@material-ui/core/Popover';\nimport store from '../store';\nimport FileStorageSystemClient from '../backend/FileStorageSystemClient';\nimport CheckIcon from '@material-ui/icons/Check';\nimport AddIcon from '@material-ui/icons/Add';\nimport TextFieldsIcon from '@material-ui/icons/TextFields';\nimport AmpStoriesIcon from '@material-ui/icons/AmpStories';\nimport DescriptionIcon from '@material-ui/icons/Description';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\n\nexport const handleSetCurrentOpenFileId = fileId => {\n  console.log(fileId);\n  if (!validateFileIdObj(fileId)) { return false; }\n  const currentOpenFileId = store.getState().currentOpenFileId;\n  if (fileId.sourceId === currentOpenFileId.sourceId && fileId.viewId === currentOpenFileId.viewId) { return true; }\n  if (!store.getState().saveDirtyFlag || window.confirm('confirm discard unsaved changes')) {\n    batch(() => {\n      store.dispatch(setCurrentOpenFileIdAction(fileId));\n      store.dispatch({ type: CLEAR_SAVE_DIRTY_FLAG_ACTION_TYPE });\n      store.dispatch(setSelectNodeAction(null));\n    });\n    localStorage.setItem(INITIAL_FILE_ID_LOCAL_STORAGE_KEY, JSON.stringify(fileId));\n    localStorage.removeItem(INITIAL_TAG_FILTERS_LOCAL_STORAGE_KEY);\n    return true;\n  }\n  return false;\n};\n\nconst convertFilesListStateToFileIdNamesList = filesListState => Object.fromEntries(\n  Object.entries(filesListState).map(([id, { name }]) => [id, name])\n);\n\nconst countNumFiles = filesList => Object.entries(filesList)\n  .reduce((count, [_sourceId, { views }]) => count + 1 + Object.keys(views).length, 0);\n\nconst FILE_LIST_ID = 'file_list';\n\nconst SEARCH_FILE_NAMES_INPUT_ID = 'search_file_names_input';\n\nconst CURRENT_SOURCE_NAME_INPUT_ID = 'current_source_name_input';\nconst CURRENT_VIEW_NAME_INPUT_ID = 'current_view_name_input';\n\nconst RENAME_SOURCE_LIST_ITEM_INPUT_ID_PREFIX = 'rename_source_list_item_input_';\nconst RENAME_VIEW_LIST_ITEM_INPUT_ID_PREFIX = 'rename_view_list_item_input_';\n\nconst RENAME_INPUT_TYPES = {\n  CURRENT_SOURCE: 'CURRENT_SOURCE',\n  CURRENT_VIEW: 'CURRENT_VIEW',\n  SOURCE_LIST_ITEM: 'SOURCE_LIST_ITEM',\n  VIEW_LIST_ITEM: 'VIEW_LIST_ITEM',\n};\n\nconst getRenameInputIdFunctions = {\n  [RENAME_INPUT_TYPES.CURRENT_SOURCE]: () => CURRENT_SOURCE_NAME_INPUT_ID,\n  [RENAME_INPUT_TYPES.CURRENT_VIEW]: () => CURRENT_VIEW_NAME_INPUT_ID,\n  [RENAME_INPUT_TYPES.SOURCE_LIST_ITEM]: fileId => RENAME_SOURCE_LIST_ITEM_INPUT_ID_PREFIX + fileId.sourceId,\n  [RENAME_INPUT_TYPES.VIEW_LIST_ITEM]: fileId => RENAME_VIEW_LIST_ITEM_INPUT_ID_PREFIX + getFileIdKeyStr(fileId),\n};\n\nconst NO_RENAMING_STATE = { inputType: null, fileId: NO_OPEN_FILE_ID };\n\nconst DEFAULT_STATE = {\n  searching: '',\n  renaming: NO_RENAMING_STATE,\n  filesList: {},\n  nextNewFileIds: null,\n  selectedFileId: null,\n  selectedViewId: null,\n  selectedFileOpen: false,\n  editMenuAnchorElement: null,\n  renameSelected: false,\n  newViewAnchorElement: null\n};\n\nclass FileListItem extends React.Component {\n  render = () => {\n    if(this.props.fileId.viewId !== 0){\n      const viewType = this.props.viewType;\n      return (\n        <Paper className={\"fileList-viewRoot\"} style={(this.props.selected) ? {backgroundColor: 'rgba(0, 0, 0, 0.08)'} : {} } component=\"form\" elevation={0}>\n          <IconButton>\n            {\n              (viewType === FILE_TYPE.CARD_VIEW) ? \n              <AmpStoriesIcon/>:\n              (viewType === FILE_TYPE.TEXT_VIEW) ?\n             <TextFieldsIcon /> :\n              null\n            }\n          </IconButton>\n          <InputBase \n            value={this.props.fileName}\n            className=\"file_list_input\"\n            disabled={!(this.props.selected && this.props.renameSelected)}\n          />\n          <Divider className={\"fileList-divider\"} orientation=\"vertical\" />\n          <IconButton className={\"fileList-iconButton\"} onClick={this.props.handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"disabled\"/>\n          </IconButton>\n        </Paper>\n      );\n    }else{\n      return (\n        <Paper className={\"fileList-viewRoot\"} style={(this.props.selected) ? {backgroundColor: '#a3d2f7', border:\"solid #3f51b5 thin\"} : {} } component=\"form\" elevation={0}>\n          <InputBase \n            value={this.props.fileName}\n            className=\"file_list_input\"\n            disabled={!(this.props.selected && this.props.renameSelected)}\n          />\n          {this.props.childViewsExist ? (this.props.open ? <ExpandLess /> : <ExpandMore />) : null}\n          <Divider className={\"fileList-divider\"} orientation=\"vertical\" />\n          <IconButton className={\"fileList-iconButton\"} onClick={this.props.handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"disabled\"/>\n          </IconButton>\n        </Paper>\n      );\n    }\n  }\n};\n\nclass Navigator extends React.Component {\n  \n  state = DEFAULT_STATE;\n\n  resetState = () => { this.setState(DEFAULT_STATE); }\n\n  getSourceName = fileId => validateFileIdObj(fileId) && this.state.filesList.hasOwnProperty(fileId.sourceId)\n      ? this.state.filesList[fileId.sourceId].name : '';\n  \n  getViewName = fileId => checkViewFileId(fileId) && this.state.filesList.hasOwnProperty(fileId.sourceId) &&\n    this.state.filesList[fileId.sourceId].views.hasOwnProperty(fileId.viewId)\n      ? this.state.filesList[fileId.sourceId].views[fileId.viewId].name : '';\n\n  getFileName = fileId => checkViewFileId(fileId) ? this.getViewName(fileId) : this.getSourceName(fileId);\n\n  getRenameInputValueFunctions = {\n    [RENAME_INPUT_TYPES.CURRENT_SOURCE]: this.getSourceName,\n    [RENAME_INPUT_TYPES.CURRENT_VIEW]: this.getViewName,\n    [RENAME_INPUT_TYPES.SOURCE_LIST_ITEM]: this.getFileName,\n    [RENAME_INPUT_TYPES.VIEW_LIST_ITEM]: this.getFileName,\n  };\n\n  handleSwitchBackendModeSignedInStatus = status => {\n    if (status === this.props.backendModeSignedInStatus) { return true; }\n    if (handleSetCurrentOpenFileId(NO_OPEN_FILE_ID)) {\n      this.resetState();\n      this.props.dispatchSetBackendModeSignedInStatusAction(status);\n      return true;\n    }\n    return false;\n  };\n\n  handleCancelRenaming = (inputType, fileId) => {\n    const input = document.getElementById(getRenameInputIdFunctions[inputType](fileId));\n    input.value = this.getRenameInputValueFunctions[inputType](fileId);\n    input.setSelectionRange(0, 0);\n    this.setState({ renaming: NO_RENAMING_STATE });\n  };\n\n  handleClearSearchingInput = () => {\n    document.getElementById(SEARCH_FILE_NAMES_INPUT_ID).value = '';\n    this.setState({ searching: '' });\n  };\n\n  handleChangeSearchingInput = () => {\n    this.setState({ searching: document.getElementById(SEARCH_FILE_NAMES_INPUT_ID).value.trim() });\n  };\n\n  handleDoFileNamesSearch = () => Object.fromEntries(\n    Object.entries(this.state.filesList).map(([sourceId, { name: sourceName, views }]) => [\n      sourceId,\n      {\n        name: sourceName,\n        views: this.state.searching\n          ? Object.fromEntries(Object.entries(views).filter(\n              ([_viewId, { name: viewName }]) => viewName.includes(this.state.searching)\n            ))\n          : views,\n      },\n    ]).filter(\n      ([_sourceId, { name: sourceName, views }]) => !this.state.searching ||\n        Object.keys(views).length > 0 || sourceName.includes(this.state.searching)\n    )\n  );\n\n  handleCreateNewFile = async fileType => {\n    if (!FILE_TYPE.hasOwnProperty(fileType)) { return; }\n    const sourceFileType = fileType === FILE_TYPE.SOURCE;\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    if (\n      (noOpenFileIdCheck && !sourceFileType) ||\n      (!noOpenFileIdCheck && !handleSetCurrentOpenFileId(NO_OPEN_FILE_ID))\n    ) { return; }\n    const localStorageNextNewFileId =\n      this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n        ? (\n            sourceFileType\n              ? this.state.nextNewFileIds.source\n              : this.state.nextNewFileIds.nextNewViewIdsForSourceIds[this.props.currentOpenFileId.sourceId]\n          )\n        : null;\n    const newFilePromise = sourceFileType\n      ? FileStorageSystemClient.doSaveSourceContent(null, localStorageNextNewFileId, true)\n      : FileStorageSystemClient.doSaveViewSpec(\n          [],\n          this.props.currentOpenFileId.sourceId,\n          localStorageNextNewFileId,\n          fileType,\n          true,\n        );\n    const newFile = await newFilePromise;\n    if (!newFile) {\n      alert('failed to create new file');\n      return;\n    }\n    const updatedSourceId = sourceFileType ? newFile.id : this.state.selectedFileId;\n    const newFilesList = {\n      ...this.state.filesList,\n      [updatedSourceId]: {\n        name: sourceFileType ? newFile.name : this.state.filesList[updatedSourceId].name,\n        views: {\n          ...(\n            !sourceFileType\n              ? {\n                  ...this.state.filesList[updatedSourceId].views,\n                  [newFile.id]: { name: newFile.name, type: newFile.type },\n                }\n              : null\n          ),\n        },\n      },\n    };\n    this.setState({ filesList: newFilesList });\n    defer(() => {\n      const fileId = { sourceId: updatedSourceId, viewId: !sourceFileType ? newFile.id : 0 };\n      handleSetCurrentOpenFileId(fileId);\n    });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileType) { doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList)); }\n      else { doSetLocalStorageSourceViews(updatedSourceId, newFilesList[updatedSourceId].views); }\n      this.setState({\n        nextNewFileIds: {\n          source: sourceFileType\n            ? calculateLocalStorageNextNewId(newFilesList, parseInt(updatedSourceId))\n            : this.state.nextNewFileIds.source,\n          nextNewViewIdsForSourceIds: {\n            ...this.state.nextNewFileIds.nextNewViewIdsForSourceIds,\n            ...(\n              !sourceFileType\n                ? {\n                    [updatedSourceId]:\n                      calculateLocalStorageNextNewId(newFilesList[updatedSourceId].views, parseInt(newFile.id)),\n                  }\n                : null\n            ),\n          },\n        },\n      });\n    }\n  }\n\n  handleDeleteFile = async fileId => {\n    if (checkNoOpenFileId(fileId)) { return; }\n    if (\n      fileId.sourceId === this.props.currentOpenFileId.sourceId &&\n      fileId.viewId === this.props.currentOpenFileId.viewId &&\n      !handleSetCurrentOpenFileId(NO_OPEN_FILE_ID)\n    ) { return; }\n    const sourceFileIdCheck = checkSourceFileId(fileId);\n    const deleteFilePromise = sourceFileIdCheck\n      ? FileStorageSystemClient.doDeleteSource(\n          fileId.sourceId,\n          Object.keys(this.state.filesList[fileId.sourceId].views),\n        )\n      : FileStorageSystemClient.doDeleteView(fileId.sourceId, fileId.viewId);\n    const success = await deleteFilePromise;\n    if (!success) {\n      alert('failed to delete file');\n      return;\n    }\n    const newFilesList = {...this.state.filesList};\n    if (sourceFileIdCheck) { delete newFilesList[fileId.sourceId]; }\n    else {\n      const newSourceViews = {...newFilesList[fileId.sourceId].views};\n      delete newSourceViews[fileId.viewId];\n      newFilesList[fileId.sourceId] = { name: newFilesList[fileId.sourceId].name, views: newSourceViews };\n    }\n    this.setState({ filesList: newFilesList });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileIdCheck) {\n        doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList));\n        const newNextNewViewIdsForSourceIds = {...this.state.nextNewFileIds.nextNewViewIdsForSourceIds};\n        delete newNextNewViewIdsForSourceIds[fileId.sourceId];\n        this.setState({\n          nextNewFileIds: {\n            source: this.state.nextNewFileIds.source,\n            nextNewViewIdsForSourceIds: newNextNewViewIdsForSourceIds,\n          },\n        });\n      } else { doSetLocalStorageSourceViews(fileId.sourceId, newFilesList[fileId.sourceId].views); }\n    }\n  };\n\n  handleRenameFile = async (fileId) => {\n    if (checkNoOpenFileId(fileId)) { return; }\n    const input = document.getElementById(\"rename_field\");\n    if (!input) { return; }\n    const newName = input.value.trim();\n    if (!newName || newName === this.getFileName(fileId)) { return; }\n    const sourceFileIdCheck = checkSourceFileId(fileId);\n    const renameFilePromise = sourceFileIdCheck\n      ? FileStorageSystemClient.doRenameSource(fileId.sourceId, newName)\n      : FileStorageSystemClient.doRenameView(fileId.sourceId, fileId.viewId, newName);\n    const success = await renameFilePromise;\n    if (!success) {\n      alert('failed to rename file');\n      return;\n    }\n    const newFilesList = {...this.state.filesList};\n    if (sourceFileIdCheck) {\n      newFilesList[fileId.sourceId] = { name: newName, views: newFilesList[fileId.sourceId].views };\n    } else {\n      const newSourceViews = {\n        ...newFilesList[fileId.sourceId].views,\n        [fileId.viewId]: { ...newFilesList[fileId.sourceId].views[fileId.viewId], name: newName },\n      };\n      newFilesList[fileId.sourceId] = { name: newFilesList[fileId.sourceId].name, views: newSourceViews };\n    }\n    this.setState({ filesList: newFilesList });\n    if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      if (sourceFileIdCheck) { doSetLocalStorageSourceIdNames(convertFilesListStateToFileIdNamesList(newFilesList)); }\n      else { doSetLocalStorageSourceViews(fileId.sourceId, newFilesList[fileId.sourceId].views); }\n    }\n  };\n\n  componentDidMount = () => {\n    FileStorageSystemClient.doGetFilesList().then(filesList => {\n      if (!filesList) { alert('failed to retrieve files list'); }\n      else { this.setState({ filesList }); }\n      if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n        this.setState({ nextNewFileIds: calculateLocalStorageNextNewFileIds(this.state.filesList) });\n      }\n    });\n  };\n\n  componentDidUpdate = (prevProps, prevState) => {\n    if (prevProps.backendModeSignedInStatus !== this.props.backendModeSignedInStatus) {\n      FileStorageSystemClient.doGetFilesList().then(filesListValue => filesListValue ?? {}).then(filesList => {\n        this.setState({\n          ...DEFAULT_STATE,\n          filesList,\n          nextNewFileIds: this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n            ? calculateLocalStorageNextNewFileIds(filesList) : null,\n        });\n      });\n    }\n  };\n  \n  renameInput = ({ inputType, fileId, ...remainingProps }) => {\n    const inputId = getRenameInputIdFunctions[inputType](fileId);\n    const value = this.getRenameInputValueFunctions[inputType](fileId);\n    return (\n      <input\n        id={inputId}\n        defaultValue={value}\n        placeholder={value}\n        disabled={\n          checkNoOpenFileId(fileId) || this.state.renaming.inputType !== inputType ||\n          this.state.renaming.fileId.sourceId !== fileId.sourceId ||\n          this.state.renaming.fileId.viewId !== fileId.viewId\n        }\n        onBlur={() => {\n          this.handleRenameFile(inputType, fileId).then(() => {\n            if (\n              this.state.renaming.inputType === inputType && this.state.renaming.fileId.sourceId === fileId.sourceId &&\n              this.state.renaming.fileId.viewId === fileId.viewId\n            ) { this.handleCancelRenaming(inputType, fileId); }\n          });\n        }}\n        onKeyDown={event => { if (event.key === 'Escape') { this.handleCancelRenaming(inputType, fileId); } }}\n        onKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n        {...remainingProps}\n      />\n    );\n  };\n\n  fileListItem = ({ fileId, selected, open, handleEditMenuClick, childViewsExist }) => {\n    const useStyles = makeStyles((theme) => ({\n      root: {\n        padding: '2px 4px',\n        display: 'flex',\n        alignItems: 'center',\n        width: 400,\n      },\n      viewRoot: {\n        padding: '2px 4px',\n        display: 'flex',\n        alignItems: 'center',\n        width: 200,\n      },\n      input: {\n        marginLeft: theme.spacing(1),\n        flex: 1,\n      },\n      iconButton: {\n        padding: 5,\n      },\n      divider: {\n        height: 28,\n        margin: 4,\n      },\n    }));\n    const classes = useStyles();\n    const fileName = this.getFileName(fileId);\n    if(fileId.viewId !== 0){\n      const viewType = this.state.filesList[fileId.sourceId].views[fileId.viewId].type;\n      return (\n        <Paper className={classes.viewRoot} style={(selected) ? {backgroundColor: 'rgba(0, 0, 0, 0.08)'} : {} } component=\"form\" elevation={0}>\n          <IconButton>\n            {\n              (viewType === FILE_TYPE.CARD_VIEW) ? \n              <AmpStoriesIcon/>:\n              (viewType === FILE_TYPE.TEXT_VIEW) ?\n             <TextFieldsIcon /> :\n              null\n            }\n          </IconButton>\n          <InputBase \n            value={fileName}\n            className=\"file_list_input\"\n            disabled={!(selected && this.state.renameSelected)}\n          />\n          <Divider className={classes.divider} orientation=\"vertical\" />\n          <IconButton className={classes.iconButton} onClick={handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"disabled\"/>\n          </IconButton>\n        </Paper>\n      );\n    }else{\n      return (\n        <Paper className={classes.root} style={(selected) ? {backgroundColor: '#a3d2f7', border:\"solid #3f51b5 thin\"} : {} } component=\"form\" elevation={0}>\n          <InputBase \n            value={fileName}\n            className=\"file_list_input\"\n            disabled={!(selected && this.state.renameSelected)}\n          />\n          {childViewsExist ? (open ? <ExpandLess /> : <ExpandMore />) : null}\n          <Divider className={classes.divider} orientation=\"vertical\" />\n          <IconButton className={classes.iconButton} onClick={handleEditMenuClick}>\n            <MoreVertIcon fontSize=\"small\" color=\"disabled\"/>\n          </IconButton>\n        </Paper>\n      );\n    }\n  };\n\n  handleFileListClick = (fileId) => {\n    if (fileId === this.state.selectedFileId) {\n      this.setState({\n        selectedViewId: null,\n        selectedFileOpen: !(this.state.selectedFileOpen)\n      });\n    }else{\n      if(handleSetCurrentOpenFileId({ sourceId:fileId, viewId: 0 })){\n        this.setState({\n          selectedFileId: fileId,\n          selectedViewId: null,\n          selectedFileOpen: true\n        });\n      }\n    }\n    \n  };\n\n  handleViewListClick = (fileId) => {\n    handleSetCurrentOpenFileId(fileId);\n    this.setState({\n      selectedViewId: fileId.viewId,\n    });\n  };\n\n  handleEditMenuClick = (event) => {\n    this.setState({\n      editMenuAnchorElement: event.currentTarget\n    })\n  }\n\n  handleEditMenuClose = () => {\n    this.setState({\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleDeleteMenuClick = () => {\n    this.handleEditMenuClose();\n    const fileId = { sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId === null) ? 0 : this.state.selectedViewId}\n    this.handleDeleteFile(fileId).then(success => {\n      if (fileId.viewId !== 0) {\n        this.setState({\n          selectedViewId: null,\n        });\n      }else{\n        this.setState({\n          selectedFileId: null,\n          selectedViewId: null,\n          selectedFileOpen: false\n        });\n      }\n    });\n  }\n\n  handleRenameMenuClick = (event) => {\n    this.setState({\n      renamePopoverElement: this.state.editMenuAnchorElement,\n      editMenuAnchorElement: null\n    })\n  }\n\n  handleRenamePopoverClose = () => {\n    this.setState({\n      renamePopoverElement: null\n    })\n  }\n\n  handleViewMenuOpen = (event) => {\n    this.setState({\n      newViewAnchorElement : this.state.editMenuAnchorElement\n    })\n  }\n\n  handleViewMenuClose = () => {\n    this.setState({\n      newViewAnchorElement : null,\n      editMenuAnchorElement: null\n    })\n  }\n\n  render = () => {\n    const noOpenFileIdCheck = checkNoOpenFileId(this.props.currentOpenFileId);\n    const currentSourceRenameComponentProps = {\n      inputType: RENAME_INPUT_TYPES.CURRENT_SOURCE,\n      fileId: { sourceId: this.props.currentOpenFileId.sourceId, viewId: 0 },\n    };\n    const currentViewRenameComponentProps = {\n      inputType: RENAME_INPUT_TYPES.CURRENT_VIEW,\n      fileId: this.props.currentOpenFileId,\n    };\n    const numFiles = countNumFiles(this.state.filesList);\n    const filteredFilesList = this.state.searching ? this.handleDoFileNamesSearch() : this.state.filesList;\n    const numFilteredFiles = countNumFiles(filteredFilesList);\n    return (\n      <div className=\"SidePane\">\n        { (this.state.selectedFileId === null) ? null :\n              <div>\n                <div id=\"current_file_container\">\n                  <Grid container spacing={3} alignItems=\"center\">\n                    <Grid item xs={3}>\n                    <IconButton>\n                    <DescriptionIcon   />\n                    </IconButton>\n                    </Grid>\n                    <Grid item xs={9}>\n                      <Typography variant=\"h6\" color=\"inherit\" id={CURRENT_SOURCE_NAME_INPUT_ID}>\n                          {this.getFileName({sourceId: this.state.selectedFileId, viewId: 0})}\n                      </Typography>\n                    </Grid>\n                  </Grid>\n                </div>\n                <Divider variant=\"middle\" />\n              </div>\n        }\n        <div id=\"file_list_container\">\n            <Button\n              variant=\"outlined\"\n              color=\"primary\"\n              endIcon={<AddCircleIcon />}\n              disableElevation\n              id=\"new_document_button\"\n              onClick={() => { this.handleCreateNewFile(FILE_TYPE.SOURCE); }}\n            >\n              New Document\n            </Button>\n          <div className=\"InputRow\" id=\"search_file_names_input_row\">\n            <Input\n              variant=\"outlined\"\n              id={SEARCH_FILE_NAMES_INPUT_ID}\n              startAdornment={\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              }\n              style={{\"width\":\"100%\"}}\n              title=\"Search File Names\"\n              placeholder=\"Search File Names\"\n              onChange={debounce(this.handleChangeSearchingInput, 150)}\n              onKeyPress={event => { if (event.key === 'Enter') { event.target.blur(); } }}\n              onKeyDown={event => { if (event.key === 'Escape') { event.target.blur(); } }}\n            />\n          </div>\n          {\n            Object.keys(filteredFilesList).length > 0\n              ?  <List\n                    component=\"nav\"\n                    aria-labelledby=\"nested-list-subheader\"\n                    subheader={\n                      <ListSubheader component=\"div\" id=\"nested-list-subheader\">\n                        Source Files\n                      </ListSubheader>\n                    }\n                    id={FILE_LIST_ID}\n                    style={{\"maxWidth\" : 360, \"width\" : '100%'}}\n                  >\n                  {\n                    Object.entries(filteredFilesList).map(([sourceId, { views }]) =>\n                    <div>\n                      <ListItem button \n                      key={sourceId} \n                      disableGutters={true}\n                      divider={true}\n                      selected={true}\n                      style={{\"padding\":\"0px\"}}\n                      onClick={() => {this.handleFileListClick(sourceId)}}\n                      >\n                        <FileListItem\n                          fileId={{ sourceId, viewId: 0 }}\n                          selected={sourceId === this.state.selectedFileId}\n                          open={sourceId === this.state.selectedFileId && this.state.selectedFileOpen}\n                          handleEditMenuClick={this.handleEditMenuClick}\n                          childViewsExist={Object.keys(views).length > 0}\n                          fileName={this.getFileName({ sourceId, viewId: 0 })}\n                          renameSelected={this.state.renameSelected}\n                          handleEditMenuClick={this.handleEditMenuClick}\n                        />\n                      </ListItem>\n                        {\n                          Object.keys(views).length > 0\n                            ? <Collapse in={sourceId === this.state.selectedFileId && this.state.selectedFileOpen} timeout=\"auto\" unmountOnExit>\n                                <List component=\"div\" disablePadding style={{\"borderStyle\": \"none solid solid solid\", \"borderColor\" :\"#3f51b5\", \"borderWidth\": \"thin\", \"borderRadius\": \"4px\"}}>\n                                {\n                                  Object.keys(views).map(viewId => {\n                                    const fileId = { sourceId, viewId, \"viewType\": views[viewId].type };\n                                    return (\n                                      <ListItem button \n                                      key={getFileIdKeyStr(fileId)} \n                                      disableGutters={true}\n                                      divider={true}\n                                      selected={true}\n                                      style={{ \"paddingTop\": \"0px\", \"paddingBottom\": \"0px\", \"backgroundColor\": \"transparent\"}}\n                                      onClick={() => {this.handleViewListClick(fileId)}}\n                                      >\n                                      <FileListItem\n                                          fileId={fileId}\n                                          open={viewId === this.state.selectedViewId}\n                                          handleEditMenuClick={this.handleEditMenuClick}\n                                          fileName={this.getFileName(fileId)}\n                                          viewType={views[viewId].type}\n                                          renameSelected={this.state.renameSelected}\n                                          selected={viewId === this.state.selectedViewId}\n                                          handleEditMenuClick={this.handleEditMenuClick}\n                                        />\n                                      </ListItem>\n                                    );\n                                  })\n                                }\n                                </List>\n                              </Collapse>\n                            : null\n                          }\n                          </div>   \n                    )\n                  }\n                </List>\n              : <div className=\"PlaceholderDivWithText\" id=\"no_files_placeholder\">\n                  No Files\n                </div>\n          }\n          <Menu\n            id=\"edit_menu\"\n            anchorEl={this.state.editMenuAnchorElement}\n            keepMounted\n            open={Boolean(this.state.editMenuAnchorElement)}\n            onClose={() => this.handleEditMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'right',\n            }}\n          >\n            {\n              (this.state.selectedViewId === null) ? \n              <MenuItem onClick={() => this.handleViewMenuOpen()}>\n                <ListItemIcon>\n                  <AddIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"New View\" />\n              </MenuItem>\n              : null\n            }\n              <MenuItem onClick={() => this.handleRenameMenuClick()}>\n                <ListItemIcon>\n                  <EditIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Rename\" />\n              </MenuItem>\n              <MenuItem onClick={() => this.handleDeleteMenuClick()}>\n                <ListItemIcon>\n                  <DeleteIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Delete\" />\n              </MenuItem>\n          </Menu>\n          <Menu \n            id=\"viewMenu\"\n            anchorEl={this.state.newViewAnchorElement}\n            keepMounted\n            open={Boolean(this.state.newViewAnchorElement)}\n            onClose={() => this.handleViewMenuClose()}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'left',\n            }}\n          >\n              <MenuItem \n                  onClick={() => {\n                    this.handleViewMenuClose();\n                    this.handleCreateNewFile(FILE_TYPE.TEXT_VIEW);}}\n              >\n                <ListItemIcon>\n                  <TextFieldsIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Text View\" />\n              </MenuItem>\n              <MenuItem\n              onClick={() => {\n                this.handleViewMenuClose();\n                this.handleCreateNewFile(FILE_TYPE.CARD_VIEW);}}\n              >\n                <ListItemIcon>\n                  <AmpStoriesIcon fontSize=\"small\" />\n                </ListItemIcon>\n                <ListItemText primary=\"Card View\" />\n              </MenuItem>\n          </Menu>\n          <Popover\n            open={Boolean(this.state.renamePopoverElement)}\n            anchorEl={this.state.renamePopoverElement}\n            anchorOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            transformOrigin={{\n              vertical:'top',\n              horizontal: 'right'\n            }}\n            id=\"rename_popover\"\n          >\n            <Input\n              id=\"rename_field\"\n              defaultValue={this.getFileName({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})}\n              onKeyPress={event => {\n                if(event.key === 'Enter') {\n                    this.handleRenameFile({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})\n                    this.handleRenamePopoverClose();\n                }   \n              }}\n              onKeyDown={event => {\n                if(event.key === 'Escape') {\n                    this.handleRenamePopoverClose();\n                }   \n              }}\n              endAdornment={\n                <InputAdornment position=\"end\">\n                  <IconButton \n                    onClick= {() => {\n                      this.handleRenameFile({sourceId: this.state.selectedFileId, viewId: (this.state.selectedViewId == null) ? 0 : this.state.selectedViewId})\n                      this.handleRenamePopoverClose();\n                    }}\n                  >\n                      <CheckIcon/>\n                  </IconButton>\n                </InputAdornment>\n              }\n              disableUnderline={true}\n              fullWidth={true}\n              style={{height:\"50px\", \"paddingLeft\": \"10px\"}}\n            />\n          </Popover>\n          <div\n            className=\"PlaceholderDivWithText\"\n            id=\"filtered_files_placeholder\"\n            hidden={!this.state.searching}>\n            {(numFiles - numFilteredFiles) + ' of ' + (numFiles) + ' files hidden by search'}\n          </div>\n        </div>\n        <div id=\"user_controls_container\">\n          {\n            this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_IN\n              ? <Button\n                  variant=\"outlined\"\n                  onClick={() => {\n                    if (\n                      this.props.dispatchSetBackendModeSignedInStatusAction(\n                        BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n                      )\n                    ) { Cookies.remove(ACCESS_TOKEN_COOKIE_KEY); }\n                  }}>\n                  Sign out\n                </Button>\n              : null\n          }\n          <Button\n            variant=\"outlined\"\n            onClick={() => {\n              if (this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n                getUserSignedInStatus().then(backendModeSignedInStatus => {\n                  this.handleSwitchBackendModeSignedInStatus(backendModeSignedInStatus);\n                });\n              } else { this.handleSwitchBackendModeSignedInStatus(BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE); }\n            }}>\n            {\n              'Switch to ' +\n              (\n                this.props.backendModeSignedInStatus === BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE\n                  ? 'cloud' : 'local'\n              ) + ' storage'\n            }\n          </Button>\n        </div>\n      </div>\n    );\n  };\n};\n\nexport default connect(\n  state => ({\n    currentOpenFileId: state.currentOpenFileId,\n    backendModeSignedInStatus: state.backendModeSignedInStatus,\n  }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n  }),\n)(Navigator);\n","import React from 'react';\nimport RichMarkdownEditor from 'rich-markdown-editor';\nimport BootstrapCard from 'react-bootstrap/Card';\nimport ReactCardFlip from 'react-card-flip';\n\nclass Card extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconsole.log(this.props.content);\n\t\tthis.state = {\n\t\t\tisFlipped: false,\n\t\t\tkey: this.props.content[\"index\"],\n\t\t\tfront: this.props.content[\"front\"],\n\t\t\tback: this.props.content[\"back\"]\n\t\t};\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.createBootstrapCard = this.createBootstrapCard.bind(this);\n\t}\n\t\n\thandleClick(e) {\n\t\te.preventDefault();\n\t\tthis.setState(prevState => ({ isFlipped: !prevState.isFlipped }));\n\t}\n\t\n\tcreateBootstrapCard(key, json) {\n\t\treturn (\n\t\t\t<BootstrapCard\n\t\t\t\tkey={key}\n\t\t\t\ttext=\"black\"\n\t\t\t\tclassName=\"BootstrapCard\"\n\t\t\t\tonClick={this.handleClick}\n\t\t\t>\n\t\t\t\t{\n\t\t\t\t\tjson &&\n\t\t\t\t\t<RichMarkdownEditor\n\t\t\t\t\t\tclassName=\"Card\"\n\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\tkey={`card${key}`}\n\t\t\t\t\t\tdefaultValue={JSON.stringify(json)}\n\t\t\t\t\t\tjsonStrValue={true}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t</BootstrapCard>\n\t\t);\n\t}\n\t\n\trender = () => {\n\t\tconst content = this.props.content;\n\t\tif (content !== undefined) {\n\t\t\tconst key = content[\"index\"];\n\t\t\tconst front = content[\"front\"];\n\t\t\tconst back = content[\"back\"];\n\t\t\treturn (\n\t\t\t\t<ReactCardFlip isFlipped={this.state.isFlipped} flipDirection=\"vertical\">\n\t\t\t\t\t{this.createBootstrapCard(key, front)}\n\t\t\t\t\t{this.createBootstrapCard(key, back)}\n\t\t\t\t</ReactCardFlip>\n\t\t\t);\n\t\t} else { return null; }\n\t};\n}\n\nexport default Card;\n","import styled from 'styled-components'\nimport React from 'react';\nimport {Droppable, Draggable} from 'react-beautiful-dnd';\n\nclass Tag extends React.Component {\n\trender = () => {\n\t\tconst Container = styled.div`\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-bottom: 8px;\n\t\t\tbackground-color: ${props => (props.isDragging ? 'lightgreen' : 'white')};\n\t\t`;\n\t\tconst TagId = styled.h5``;\n\t\tconst Content = styled.div``\n\t\treturn (\n\t\t\t<Draggable draggableId={this.props.tagId} index={this.props.index}>\n\t\t\t\t{(provided, snapshot) => (\n\t\t\t\t\t<Container\n\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t{...provided.draggableProps}\n\t\t\t\t\t\t{...provided.dragHandleProps}\n\t\t\t\t\t\tisDragging={snapshot.isDragging}\n\t\t\t\t\t>\n\t\t\t\t\t\t<TagId>{this.props.tagInfo[\"tag_name\"]}</TagId>\n\t\t\t\t\t\t<Content>{this.props.tagInfo.preview}</Content>\n\t\t\t\t\t</Container>\n\t\t\t\t)}\n\t\t\t</Draggable>\n\t\t);\n\t};\n}\n\nclass InnerTagList extends React.Component {\n\t// performance optimization to prevent unnecessary renders\n\tshouldComponentUpdate(nextProps, nextState, nextContext) {\n\t\treturn nextProps.tagData !== this.props.tagData;\n\t}\n\t\n\trender() {\n\t\treturn Object.keys(this.props.tagData).map((tagId, index) => (\n\t\t\t<Tag key={tagId} tagId={tagId} index={index} tagInfo={this.props.tagData[tagId]}/>\n\t\t));\n\t}\n}\n\nclass DragDropColumn extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// used to maintain scroll when rendering updates to tag list\n\t\tthis.tagListRef = React.createRef();\n\t}\n\t\n\tgetSnapshotBeforeUpdate(prevProps, prevState) {\n\t\tconst list = this.tagListRef.current;\n\t\treturn list.scrollHeight - list.scrollTop;\n\t}\n\t\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (snapshot !== null) {\n\t\t\tconst list = this.tagListRef.current;\n\t\t\tlist.scrollTop = list.scrollHeight - snapshot;\n\t\t}\n\t}\n\t\n\trender = () => {\n\t\tconst Container = styled.div`\n\t\t\tborder: 1px solid lightgrey;\n\t\t\tborder-radius: 10px;\n\t\t\tpadding: 8px;\n\t\t\tmargin-top: 10px;\n\t\t\tmargin-bottom: 10px;\n\t\t\ttransition: background-color 0.2s ease;\n\t\t\tbackground-color: ${props => (props.isDraggingOver) ? 'skyblue' : 'white'};\n\t\t`;\n\t\tconst Title = styled.h3`\n\t\t\tpadding: 8px;\n\t\t`;\n\t\tconst DroppableRegion = styled.div`\n\t\t\tpadding: 8px;\n\t\t`;\n\t\tconst TagList = styled.div`\n\t\t\toverflow-x: hidden;\n\t\t\toverflow-y: auto;\n\t\t\theight: 200px;\n\t\t\tpadding-bottom: 30px;\n\t\t`;\n\n\t\treturn (\n\t\t\t<Droppable droppableId={this.props.column.id}>\n\t\t\t\t{(provided, snapshot) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Container isDraggingOver={snapshot.isDraggingOver}>\n\t\t\t\t\t\t\t<Title>{this.props.column.title}</Title>\n\t\t\t\t\t\t\t\t<DroppableRegion\n\t\t\t\t\t\t\t\t\tref={provided.innerRef}\n\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<TagList ref={this.tagListRef}>\n\t\t\t\t\t\t\t\t\t\t<InnerTagList tagData={this.props.tagData}/>\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\n\t\t\t\t\t\t\t\t\t</TagList>\n\t\t\t\t\t\t\t\t</DroppableRegion>\n\t\t\t\t\t\t</Container>\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t</Droppable>\n\t\t);\n\t};\n}\n\nexport default DragDropColumn;\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport DragDropColumn from './DragDropColumn';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport {DragDropContext} from 'react-beautiful-dnd';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\n\nclass TagEditor extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tconst tagsInView = new Set(this.props.tagsInView);\n\t\tconst availableTags = Object.keys(this.props.allTagsData).filter(t => !tagsInView.has(t));\n\t\t\n\t\t// parse nodes to obtain preview\n\t\tfunction getPreview(node) {\n\t\t\tfor (let i = 0; i < node.content.length; ++i) {\n\t\t\t\tconst contentNode = node.content[i];\n\t\t\t\tif (contentNode.type === \"text\") {\n\t\t\t\t\treturn contentNode.text;\n\t\t\t\t} else if (contentNode) {\n\t\t\t\t\tconst recurseResponse = getPreview(contentNode);\n\t\t\t\t\tif (recurseResponse !== \"\") return recurseResponse;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"\";\n\t\t}\n\t\t\n\t\tconst tagData = this.props.allTagsData;\n\t\tObject.keys(tagData).forEach(tagId => {\n\t\t\tconst preview = getPreview(tagData[tagId].content);\n\t\t\tconst maxPreviewLength = 50;\n\t\t\ttagData[tagId][\"preview\"] = preview.substring(0, maxPreviewLength);\n\t\t\tif (preview.length > maxPreviewLength) {\n\t\t\t\ttagData[tagId][\"preview\"] += \" . . .\";\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.state = {\n\t\t\ttagData: tagData,\n\t\t\tcolumns: {\n\t\t\t\ttags_in_view: {\n\t\t\t\t\tid: 'tags_in_view',\n\t\t\t\t\ttitle: \"Tags in View\",\n\t\t\t\t\ttagIds: this.props.tagsInView\n\t\t\t\t},\n\t\t\t\ttags_available: {\n\t\t\t\t\tid: 'tags_available',\n\t\t\t\t\ttitle: \"Available Tags\",\n\t\t\t\t\ttagIds: availableTags\n\t\t\t\t},\n\t\t\t},\n\t\t\tcolumnOrder: ['tags_in_view', 'tags_available']\n\t\t};\n\t}\n\t\n\tonDragEnd = result => {\n\t\tconst { destination, source, draggableId } = result;\n\t\tif (!destination) return;\n\t\tif (destination.droppableId === source.droppableId && destination.index === source.index) return;\n\t\t\n\t\tlet newState = {}\n\t\tif (destination.droppableId === source.droppableId) {\n\t\t\tconst column = this.state.columns[source.droppableId]\n\t\t\tconst newTagIds = Array.from(column.tagIds);\n\t\t\tnewTagIds.splice(source.index, 1);\n\t\t\tnewTagIds.splice(destination.index, 0, draggableId)\n\t\t\t\n\t\t\tconst newColumn = {\n\t\t\t\t...column,\n\t\t\t\ttagIds: newTagIds\n\t\t\t}\n\t\t\t\n\t\t\tnewState = {\n\t\t\t\t...this.state,\n\t\t\t\tcolumns: {\n\t\t\t\t\t...this.state.columns,\n\t\t\t\t\t[newColumn.id]: newColumn\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tconst start = this.state.columns[source.droppableId];\n\t\t\tconst finish = this.state.columns[destination.droppableId];\n\t\t\tconst startTagIds = Array.from(start.tagIds);\n\t\t\tstartTagIds.splice(source.index, 1);\n\t\t\tconst newStart = {\n\t\t\t\t...start,\n\t\t\t\ttagIds: startTagIds\n\t\t\t};\n\t\t\t\n\t\t\tconst finishTagIds = Array.from(finish.tagIds);\n\t\t\tfinishTagIds.splice(destination.index, 0, draggableId);\n\t\t\tconst newFinish = {\n\t\t\t\t...finish,\n\t\t\t\ttagIds: finishTagIds\n\t\t\t};\n\t\t\t\n\t\t\tnewState = {\n\t\t\t\t...this.state,\n\t\t\t\tcolumns: {\n\t\t\t\t\t...this.state.columns,\n\t\t\t\t\t[newStart.id]: newStart,\n\t\t\t\t\t[newFinish.id]: newFinish\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis.props.setTagsInView(newState.columns.tags_in_view.tagIds);\n\t\tthis.setState(newState);\n\t}\n\t\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tconst tagsInView = new Set(this.props.tagsInView);\n\t\t\tconst availableTags = Object.keys(this.props.allTagsData).filter(t => !tagsInView.has(t));\n\t\t\tconst newState = Object.assign({}, this.state);\n\t\t\tnewState.columns.tags_in_view.tagIds = tagsInView;\n\t\t\tnewState.columns.tags_available.tagIds = availableTags;\n\t\t\tthis.setState(newState);\n\t\t}\n\t}\n\t\n\trender = () => {\n\t\treturn (\n\t\t\t<DragDropContext onDragEnd={this.onDragEnd}>\n\t\t\t\t<Container>\n\t\t\t\t\t<Row className=\"justify-content-md-center\">\n\t\t\t\t\t\t{this.state.columnOrder.map(columnId => {\n\t\t\t\t\t\t\tconst column = this.state.columns[columnId];\n\t\t\t\t\t\t\t// Generate subdict here\n\t\t\t\t\t\t\tlet tagDataInColumn = {};\n\t\t\t\t\t\t\tfor (const tagId of column.tagIds) {\n\t\t\t\t\t\t\t\ttagDataInColumn[tagId] = this.state.tagData[tagId];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Col key={column.id} md=\"12\" lg=\"6\">\n\t\t\t\t\t\t\t\t\t<DragDropColumn key={column.id} column={column} tagData={tagDataInColumn}/>\n\t\t\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t</DragDropContext>\n\t\t);\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView }),\n\tdispatch => ({ setTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)) }),\n)(TagEditor);\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport './CardDeck.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from './Card';\nimport TagEditor from '../ViewComponents/TagEditor';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport FileStorageSystemClient from \"../../backend/FileStorageSystemClient\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\n\n\nclass CardDeck extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tallTagsData: props.data.allTagsData,\n\t\t}\n\t\tthis.props.setTagsInView(props.data.tagsInView);\n\t}\n\t\n\tkeydownHandler = (event) => {\n\t\tif ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey)  && event.keyCode === 83) {\n\t\t\tevent.preventDefault();\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tFILE_TYPE.CARD_VIEW,\n\t\t\t\tfalse,\n\t\t\t)\n\t\t\t\t.then(() => alert(\"Card view saved\"))\n\t\t\t\t.catch(() => alert(\"Failed to save card view\"));\n\t\t}\n\t};\n\t\n\tconstructDoc = (tagId) => {\n\t\tconst node = this.state.allTagsData[tagId][\"content\"];\n\t\treturn {\n\t\t\t\"type\": \"doc\",\n\t\t\t\"content\": [node]\n\t\t};\n\t};\n\t\n\tconstructCard = (index) => {\n\t\tconst cardContent = { \"index\": index };\n\t\tcardContent[\"front\"] = this.constructDoc(this.props.tagsInView[index]);\n\t\tif (index + 1 < this.props.tagsInView.length) {\n\t\t\tcardContent[\"back\"] = this.constructDoc(this.props.tagsInView[index+1]);\n\t\t} else { cardContent[\"back\"] = null; }\n\t\treturn <Card content={cardContent} />;\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tdocument.addEventListener('keydown',this.keydownHandler);\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tthis.props.setTagsInView(this.props.tagsInView);\n\t\t}\n\t};\n\tcomponentWillUnmount = () => { document.removeEventListener('keydown',this.keydownHandler); };\n\t\n\trender = () => {\n\t\tif (!this.state.allTagsData || this.props.tagsInView == null) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Loading Card Deck ...</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t} else {\n\t\t\tconst cards = [];\n\t\t\tfor (let i = 0; i < this.props.tagsInView.length; i+=4) {\n\t\t\t\tcards.push(\n\t\t\t\t\t<Row key={`row_${i%4}`} className=\"justify-content-md-center\">\n\t\t\t\t\t\t<Col lg=\"12\" xl=\"6\">\n\t\t\t\t\t\t\t{this.constructCard(i)}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col lg=\"12\" xl=\"6\">\n\t\t\t\t\t\t\t{(i + 2 < this.props.tagsInView.length) && this.constructCard(i + 2)}\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<TagEditor allTagsData={this.state.allTagsData} tagsInView={this.props.tagsInView} />\n\t\t\t\t\t{cards}\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({ setTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)) }),\n)(CardDeck);\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport './TextView.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport Container from 'react-bootstrap/Container'\nimport TagEditor from '../ViewComponents/TagEditor';\nimport {setTagsInViewAction} from '../../reducers/SetTagsInView';\nimport FileStorageSystemClient from \"../../backend/FileStorageSystemClient\";\nimport {FILE_TYPE} from \"../../util/FileIdAndTypeUtils\";\nimport RichMarkdownEditor from \"rich-markdown-editor\";\n\n\nclass TextView extends React.Component {\n\t\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tallTagsData: props.data.allTagsData,\n\t\t}\n\t\tthis.props.setTagsInView(props.data.tagsInView);\n\t}\n\t\n\tkeydownHandler = (event) => {\n\t\tif ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey)  && event.keyCode === 83) {\n\t\t\tevent.preventDefault();\n\t\t\tFileStorageSystemClient.doSaveViewSpec(\n\t\t\t\tthis.props.tagsInView,\n\t\t\t\tthis.props.currentOpenFileId.sourceId,\n\t\t\t\tthis.props.currentOpenFileId.viewId,\n\t\t\t\tFILE_TYPE.TEXT_VIEW,\n\t\t\t\tfalse,\n\t\t\t\t)\n\t\t\t\t.then(() => alert(\"Text view saved\"))\n\t\t\t\t.catch(() => alert(\"Failed to save text view\"));\n\t\t}\n\t};\n\t\n\tconstructTextView = () => {\n\t\treturn {\n\t\t\t\"type\": \"doc\",\n\t\t\t\"content\": this.props.tagsInView.map(t => this.state.allTagsData[t][\"content\"])\n\t\t};\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tdocument.addEventListener('keydown',this.keydownHandler);\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (prevProps.tagsInView !== this.props.tagsInView) {\n\t\t\tthis.props.setTagsInView(this.props.tagsInView);\n\t\t}\n\t};\n\tcomponentWillUnmount = () => { document.removeEventListener('keydown',this.keydownHandler); };\n\t\n\trender = () => {\n\t\tif (!this.state.allTagsData || this.props.tagsInView == null) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Loading Text View ...</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<TagEditor allTagsData={this.state.allTagsData} tagsInView={this.props.tagsInView} />\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.props.tagsInView.length > 0 &&\n\t\t\t\t\t\t<RichMarkdownEditor\n\t\t\t\t\t\t\tclassName=\"TextViewEditor\"\n\t\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\t\tkey={\"text_view\"}\n\t\t\t\t\t\t\tdefaultValue={JSON.stringify(this.constructTextView())}\n\t\t\t\t\t\t\tjsonStrValue={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t};\n}\n\nexport default connect(\n\tstate => ({ tagsInView: state.tagsInView, currentOpenFileId: state.currentOpenFileId }),\n\tdispatch => ({ setTagsInView: tagsInView => dispatch(setTagsInViewAction(tagsInView)) }),\n)(TextView);\n","import './ViewEditor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {\n\tFILE_TYPE,\n\tNO_OPEN_FILE_ID\n} from \"../util/FileIdAndTypeUtils\";\nimport FileStorageSystemClient from \"../backend/FileStorageSystemClient\";\nimport {handleSetCurrentOpenFileId} from \"./Navigator\";\nimport CardDeck from \"./CardView/CardDeck\";\nimport TextView from \"./TextView/TextView\";\n\nconst DEFAULT_STATE = {\n\tsourceId: 0,\n\tviewId: 0,\n\tdata: null,\n\tfileType: FILE_TYPE.EMPTY\n};\n\nclass ViewEditor extends React.Component {\n\t\n\tstate = DEFAULT_STATE;\n\t\n\tchangeFile = async () => {\n\t\tFileStorageSystemClient.doGetView(this.props.currentOpenFileId).then(value => {\n\t\t\tif (value === null) {\n\t\t\t\talert('failed to retrieve view');\n\t\t\t\thandleSetCurrentOpenFileId(NO_OPEN_FILE_ID);\n\t\t\t} else {\n\t\t\t\tthis.setState({\n\t\t\t\t\tsourceId: this.props.currentOpenFileId.sourceId,\n\t\t\t\t\tviewId: this.props.currentOpenFileId.viewId,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttagsInView: value[\"view\"][\"order\"],\n\t\t\t\t\t\tallTagsData: value[\"tags\"][\"items\"]\n\t\t\t\t\t},\n\t\t\t\t\tfileType: this.props.currentOpenFileId.viewType\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile().then(() => console.log(\"Mounted view file\"));\n\t};\n\tcomponentDidUpdate = prevProps => {\n\t\tif (\n\t\t\tprevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n\t\t\tprevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n\t\t) {\n\t\t\tthis.changeFile().then(() => console.log(\"Updated view file\"));\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\tif (this.state.fileType === FILE_TYPE.CARD_VIEW) {\n\t\t\treturn <CardDeck data={this.state.data}/>;\n\t\t} else if (this.state.fileType === FILE_TYPE.TEXT_VIEW) {\n\t\t\treturn <TextView data={this.state.data}/>;\n\t\t}\n\t\treturn null;\n\t};\n}\n\nexport default connect(state => ({ currentOpenFileId: state.currentOpenFileId }))(ViewEditor);\n\n","import './Editor.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport SourceEditorWithTagFilters from \"./SourceEditorWithTagFiltersInput\";\nimport {\n\tcheckSourceFileId,\n\tcheckViewFileId,\n\tFILE_TYPE,\n} from \"../util/FileIdAndTypeUtils\";\nimport ViewEditor from \"./ViewEditor\";\nimport Container from \"react-bootstrap/Container\";\n\nconst DEFAULT_STATE = {\n\tfileType: FILE_TYPE.EMPTY,\n};\n\nclass EditorManager extends React.Component {\n\t\n\tstate = DEFAULT_STATE;\n\t\n\tchangeFile = () => {\n\t\tif (checkSourceFileId(this.props.currentOpenFileId)) {\n\t\t\tthis.setState({fileType: FILE_TYPE.SOURCE});\n\t\t} else if (checkViewFileId(this.props.currentOpenFileId)) {\n\t\t\tthis.setState({fileType: FILE_TYPE.CARD_VIEW});\n\t\t} else {\n\t\t\tthis.setState({fileType: FILE_TYPE.EMPTY});\n\t\t}\n\t};\n\t\n\t\n\tcomponentDidMount = () => {\n\t\tthis.changeFile();\n\t};\n\t\n\tcomponentDidUpdate = prevProps => {\n\t\tif (\n\t\t\tprevProps.currentOpenFileId.sourceId !== this.props.currentOpenFileId.sourceId ||\n\t\t\tprevProps.currentOpenFileId.viewId !== this.props.currentOpenFileId.viewId\n\t\t) {\n\t\t\tthis.changeFile();\n\t\t}\n\t};\n\t\n\trender = () => {\n\t\tif (this.state.fileType === FILE_TYPE.EMPTY) {\n\t\t\treturn (\n\t\t\t\t<Container className=\"viewContainer\">\n\t\t\t\t\t<h5>Click/create a document!</h5>\n\t\t\t\t</Container>\n\t\t\t);\n\t\t}\n\t\tif (this.state.fileType === FILE_TYPE.SOURCE) {\n\t\t\treturn <SourceEditorWithTagFilters />;\n\t\t}\n\t\treturn <ViewEditor/>;\n\t};\n};\n\nexport default connect(state => ({ currentOpenFileId: state.currentOpenFileId }))(EditorManager);\n","import './App.css';\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport {checkSourceFileId} from './util/FileIdAndTypeUtils';\nimport {\n  BACKEND_MODE_SIGNED_IN_STATUS,\n  getUserSignedInStatus,\n  setBackendModeSignedInStatusAction,\n} from './reducers/BackendModeSignedInStatus';\nimport LandingPage from './components/LandingPage';\nimport Navigator from './components/Navigator';\nimport {handleSaveCurrentFileEditorContent} from './components/Editor';\nimport EditorManager from \"./components/EditorManager\";\nimport \"./components/LandingPage.css\"\n\nclass App extends React.Component {\n\n  state = { mounted: false };\n\n  keydownHandler = event => {\n    if ((window.navigator.platform.match(\"Mac\") ? event.metaKey : event.ctrlKey) && event.keyCode === 83) {\n      event.preventDefault();\n      if (this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT) {\n        if (checkSourceFileId(this.props.currentOpenFileId)) { handleSaveCurrentFileEditorContent(); }\n      }\n    }\n  }\n\n  componentWillUnmount = () => { document.removeEventListener('keydown', this.keydownHandler); };\n\n  componentDidMount = () => {\n    document.addEventListener('keydown',this.keydownHandler);\n    if (this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.LOCAL_STORAGE) {\n      getUserSignedInStatus().then(backendModeSignedInStatus => {\n        this.props.dispatchSetBackendModeSignedInStatusAction(backendModeSignedInStatus);\n        this.setState({ mounted: true });\n      });\n    } else { this.setState({ mounted: true }); }\n  };\n  \n  render = () =>\n    <React.Fragment>\n      {\n        this.state.mounted\n          ? (\n              this.props.backendModeSignedInStatus !== BACKEND_MODE_SIGNED_IN_STATUS.USER_SIGNED_OUT\n                ? <div className=\"App\">\n                    <div style={{ position: 'absolute', top: '9px', right: '16px', fontSize: '.75em' }}>\n                      <span role=\"img\" aria-label=\"Yet Another Docs App\">\n                         &nbsp; <b>Y</b>et <b>A</b>nother <b>D</b>ocs <b>A</b>pp\n                      </span>\n                    </div>\n                    <Navigator />\n                    <EditorManager/>\n                  </div>\n                : <LandingPage />\n            )\n          : null\n      }\n      {/* <div className=\"NoApp\">\n        This app doesn't support mobile screen widths.\n      </div> */}\n    </React.Fragment>\n};\n\nexport default connect(\n  state => ({\n    backendModeSignedInStatus: state.backendModeSignedInStatus,\n    currentOpenFileId: state.currentOpenFileId,\n  }),\n  dispatch => ({\n    dispatchSetBackendModeSignedInStatusAction: mode => dispatch(setBackendModeSignedInStatusAction(mode)),\n  }),\n)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: {'Service-Worker': 'script'},\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport {render} from 'react-dom';\nimport {Provider} from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport store from './store';\nimport * as serviceWorker from './serviceWorker';\n\nrender(\n  <React.StrictMode>\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap\" />\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" />\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" />\n    <link href=\"https://fonts.googleapis.com/css2?family=Bungee&display=swap\" rel=\"stylesheet\" /> \n    <link href=\"https://fonts.googleapis.com/css2?family=Signika:wght@300&display=swap\" rel=\"stylesheet\"></link>\n    <Provider store={store}>\n      <App/>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}